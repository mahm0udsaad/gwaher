"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@ai-sdk+google@3.0.10_zod@3.25.76";
exports.ids = ["vendor-chunks/@ai-sdk+google@3.0.10_zod@3.25.76"];
exports.modules = {

/***/ "(rsc)/./node_modules/.pnpm/@ai-sdk+google@3.0.10_zod@3.25.76/node_modules/@ai-sdk/google/dist/index.mjs":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@ai-sdk+google@3.0.10_zod@3.25.76/node_modules/@ai-sdk/google/dist/index.mjs ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VERSION: () => (/* binding */ VERSION),\n/* harmony export */   createGoogleGenerativeAI: () => (/* binding */ createGoogleGenerativeAI),\n/* harmony export */   google: () => (/* binding */ google)\n/* harmony export */ });\n/* harmony import */ var _ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @ai-sdk/provider-utils */ \"(rsc)/./node_modules/.pnpm/@ai-sdk+provider-utils@4.0.8_zod@3.25.76/node_modules/@ai-sdk/provider-utils/dist/index.mjs\");\n/* harmony import */ var _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ai-sdk/provider */ \"(rsc)/./node_modules/.pnpm/@ai-sdk+provider@3.0.4/node_modules/@ai-sdk/provider/dist/index.mjs\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/.pnpm/zod@3.25.76/node_modules/zod/v4/classic/schemas.js\");\n// src/google-provider.ts\n\n\n// src/version.ts\nvar VERSION =  true ? \"3.0.10\" : 0;\n\n// src/google-generative-ai-embedding-model.ts\n\n\n\n\n// src/google-error.ts\n\n\nvar googleErrorDataSchema = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(\n  () => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      error: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        code: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().nullable(),\n        message: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string(),\n        status: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string()\n      })\n    })\n  )\n);\nvar googleFailedResponseHandler = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createJsonErrorResponseHandler)({\n  errorSchema: googleErrorDataSchema,\n  errorToMessage: (data) => data.error.message\n});\n\n// src/google-generative-ai-embedding-options.ts\n\n\nvar googleGenerativeAIEmbeddingProviderOptions = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(\n  () => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      /**\n       * Optional. Optional reduced dimension for the output embedding.\n       * If set, excessive values in the output embedding are truncated from the end.\n       */\n      outputDimensionality: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().optional(),\n      /**\n       * Optional. Specifies the task type for generating embeddings.\n       * Supported task types:\n       * - SEMANTIC_SIMILARITY: Optimized for text similarity.\n       * - CLASSIFICATION: Optimized for text classification.\n       * - CLUSTERING: Optimized for clustering texts based on similarity.\n       * - RETRIEVAL_DOCUMENT: Optimized for document retrieval.\n       * - RETRIEVAL_QUERY: Optimized for query-based retrieval.\n       * - QUESTION_ANSWERING: Optimized for answering questions.\n       * - FACT_VERIFICATION: Optimized for verifying factual information.\n       * - CODE_RETRIEVAL_QUERY: Optimized for retrieving code blocks based on natural language queries.\n       */\n      taskType: zod_v4__WEBPACK_IMPORTED_MODULE_1__[\"enum\"]([\n        \"SEMANTIC_SIMILARITY\",\n        \"CLASSIFICATION\",\n        \"CLUSTERING\",\n        \"RETRIEVAL_DOCUMENT\",\n        \"RETRIEVAL_QUERY\",\n        \"QUESTION_ANSWERING\",\n        \"FACT_VERIFICATION\",\n        \"CODE_RETRIEVAL_QUERY\"\n      ]).optional()\n    })\n  )\n);\n\n// src/google-generative-ai-embedding-model.ts\nvar GoogleGenerativeAIEmbeddingModel = class {\n  constructor(modelId, config) {\n    this.specificationVersion = \"v3\";\n    this.maxEmbeddingsPerCall = 2048;\n    this.supportsParallelCalls = true;\n    this.modelId = modelId;\n    this.config = config;\n  }\n  get provider() {\n    return this.config.provider;\n  }\n  async doEmbed({\n    values,\n    headers,\n    abortSignal,\n    providerOptions\n  }) {\n    const googleOptions = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.parseProviderOptions)({\n      provider: \"google\",\n      providerOptions,\n      schema: googleGenerativeAIEmbeddingProviderOptions\n    });\n    if (values.length > this.maxEmbeddingsPerCall) {\n      throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.TooManyEmbeddingValuesForCallError({\n        provider: this.provider,\n        modelId: this.modelId,\n        maxEmbeddingsPerCall: this.maxEmbeddingsPerCall,\n        values\n      });\n    }\n    const mergedHeaders = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.combineHeaders)(\n      await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.resolve)(this.config.headers),\n      headers\n    );\n    if (values.length === 1) {\n      const {\n        responseHeaders: responseHeaders2,\n        value: response2,\n        rawValue: rawValue2\n      } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.postJsonToApi)({\n        url: `${this.config.baseURL}/models/${this.modelId}:embedContent`,\n        headers: mergedHeaders,\n        body: {\n          model: `models/${this.modelId}`,\n          content: {\n            parts: [{ text: values[0] }]\n          },\n          outputDimensionality: googleOptions == null ? void 0 : googleOptions.outputDimensionality,\n          taskType: googleOptions == null ? void 0 : googleOptions.taskType\n        },\n        failedResponseHandler: googleFailedResponseHandler,\n        successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createJsonResponseHandler)(\n          googleGenerativeAISingleEmbeddingResponseSchema\n        ),\n        abortSignal,\n        fetch: this.config.fetch\n      });\n      return {\n        warnings: [],\n        embeddings: [response2.embedding.values],\n        usage: void 0,\n        response: { headers: responseHeaders2, body: rawValue2 }\n      };\n    }\n    const {\n      responseHeaders,\n      value: response,\n      rawValue\n    } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.postJsonToApi)({\n      url: `${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,\n      headers: mergedHeaders,\n      body: {\n        requests: values.map((value) => ({\n          model: `models/${this.modelId}`,\n          content: { role: \"user\", parts: [{ text: value }] },\n          outputDimensionality: googleOptions == null ? void 0 : googleOptions.outputDimensionality,\n          taskType: googleOptions == null ? void 0 : googleOptions.taskType\n        }))\n      },\n      failedResponseHandler: googleFailedResponseHandler,\n      successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createJsonResponseHandler)(\n        googleGenerativeAITextEmbeddingResponseSchema\n      ),\n      abortSignal,\n      fetch: this.config.fetch\n    });\n    return {\n      warnings: [],\n      embeddings: response.embeddings.map((item) => item.values),\n      usage: void 0,\n      response: { headers: responseHeaders, body: rawValue }\n    };\n  }\n};\nvar googleGenerativeAITextEmbeddingResponseSchema = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(\n  () => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      embeddings: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({ values: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(zod_v4__WEBPACK_IMPORTED_MODULE_1__.number()) }))\n    })\n  )\n);\nvar googleGenerativeAISingleEmbeddingResponseSchema = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(\n  () => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      embedding: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({ values: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(zod_v4__WEBPACK_IMPORTED_MODULE_1__.number()) })\n    })\n  )\n);\n\n// src/google-generative-ai-language-model.ts\n\n\n\n// src/convert-google-generative-ai-usage.ts\nfunction convertGoogleGenerativeAIUsage(usage) {\n  var _a, _b, _c, _d;\n  if (usage == null) {\n    return {\n      inputTokens: {\n        total: void 0,\n        noCache: void 0,\n        cacheRead: void 0,\n        cacheWrite: void 0\n      },\n      outputTokens: {\n        total: void 0,\n        text: void 0,\n        reasoning: void 0\n      },\n      raw: void 0\n    };\n  }\n  const promptTokens = (_a = usage.promptTokenCount) != null ? _a : 0;\n  const candidatesTokens = (_b = usage.candidatesTokenCount) != null ? _b : 0;\n  const cachedContentTokens = (_c = usage.cachedContentTokenCount) != null ? _c : 0;\n  const thoughtsTokens = (_d = usage.thoughtsTokenCount) != null ? _d : 0;\n  return {\n    inputTokens: {\n      total: promptTokens,\n      noCache: promptTokens - cachedContentTokens,\n      cacheRead: cachedContentTokens,\n      cacheWrite: void 0\n    },\n    outputTokens: {\n      total: candidatesTokens + thoughtsTokens,\n      text: candidatesTokens,\n      reasoning: thoughtsTokens\n    },\n    raw: usage\n  };\n}\n\n// src/convert-json-schema-to-openapi-schema.ts\nfunction convertJSONSchemaToOpenAPISchema(jsonSchema, isRoot = true) {\n  if (jsonSchema == null) {\n    return void 0;\n  }\n  if (isEmptyObjectSchema(jsonSchema)) {\n    if (isRoot) {\n      return void 0;\n    }\n    if (typeof jsonSchema === \"object\" && jsonSchema.description) {\n      return { type: \"object\", description: jsonSchema.description };\n    }\n    return { type: \"object\" };\n  }\n  if (typeof jsonSchema === \"boolean\") {\n    return { type: \"boolean\", properties: {} };\n  }\n  const {\n    type,\n    description,\n    required,\n    properties,\n    items,\n    allOf,\n    anyOf,\n    oneOf,\n    format,\n    const: constValue,\n    minLength,\n    enum: enumValues\n  } = jsonSchema;\n  const result = {};\n  if (description) result.description = description;\n  if (required) result.required = required;\n  if (format) result.format = format;\n  if (constValue !== void 0) {\n    result.enum = [constValue];\n  }\n  if (type) {\n    if (Array.isArray(type)) {\n      const hasNull = type.includes(\"null\");\n      const nonNullTypes = type.filter((t) => t !== \"null\");\n      if (nonNullTypes.length === 0) {\n        result.type = \"null\";\n      } else {\n        result.anyOf = nonNullTypes.map((t) => ({ type: t }));\n        if (hasNull) {\n          result.nullable = true;\n        }\n      }\n    } else {\n      result.type = type;\n    }\n  }\n  if (enumValues !== void 0) {\n    result.enum = enumValues;\n  }\n  if (properties != null) {\n    result.properties = Object.entries(properties).reduce(\n      (acc, [key, value]) => {\n        acc[key] = convertJSONSchemaToOpenAPISchema(value, false);\n        return acc;\n      },\n      {}\n    );\n  }\n  if (items) {\n    result.items = Array.isArray(items) ? items.map((item) => convertJSONSchemaToOpenAPISchema(item, false)) : convertJSONSchemaToOpenAPISchema(items, false);\n  }\n  if (allOf) {\n    result.allOf = allOf.map(\n      (item) => convertJSONSchemaToOpenAPISchema(item, false)\n    );\n  }\n  if (anyOf) {\n    if (anyOf.some(\n      (schema) => typeof schema === \"object\" && (schema == null ? void 0 : schema.type) === \"null\"\n    )) {\n      const nonNullSchemas = anyOf.filter(\n        (schema) => !(typeof schema === \"object\" && (schema == null ? void 0 : schema.type) === \"null\")\n      );\n      if (nonNullSchemas.length === 1) {\n        const converted = convertJSONSchemaToOpenAPISchema(\n          nonNullSchemas[0],\n          false\n        );\n        if (typeof converted === \"object\") {\n          result.nullable = true;\n          Object.assign(result, converted);\n        }\n      } else {\n        result.anyOf = nonNullSchemas.map(\n          (item) => convertJSONSchemaToOpenAPISchema(item, false)\n        );\n        result.nullable = true;\n      }\n    } else {\n      result.anyOf = anyOf.map(\n        (item) => convertJSONSchemaToOpenAPISchema(item, false)\n      );\n    }\n  }\n  if (oneOf) {\n    result.oneOf = oneOf.map(\n      (item) => convertJSONSchemaToOpenAPISchema(item, false)\n    );\n  }\n  if (minLength !== void 0) {\n    result.minLength = minLength;\n  }\n  return result;\n}\nfunction isEmptyObjectSchema(jsonSchema) {\n  return jsonSchema != null && typeof jsonSchema === \"object\" && jsonSchema.type === \"object\" && (jsonSchema.properties == null || Object.keys(jsonSchema.properties).length === 0) && !jsonSchema.additionalProperties;\n}\n\n// src/convert-to-google-generative-ai-messages.ts\n\n\nfunction convertToGoogleGenerativeAIMessages(prompt, options) {\n  var _a, _b, _c;\n  const systemInstructionParts = [];\n  const contents = [];\n  let systemMessagesAllowed = true;\n  const isGemmaModel = (_a = options == null ? void 0 : options.isGemmaModel) != null ? _a : false;\n  const providerOptionsName = (_b = options == null ? void 0 : options.providerOptionsName) != null ? _b : \"google\";\n  for (const { role, content } of prompt) {\n    switch (role) {\n      case \"system\": {\n        if (!systemMessagesAllowed) {\n          throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.UnsupportedFunctionalityError({\n            functionality: \"system messages are only supported at the beginning of the conversation\"\n          });\n        }\n        systemInstructionParts.push({ text: content });\n        break;\n      }\n      case \"user\": {\n        systemMessagesAllowed = false;\n        const parts = [];\n        for (const part of content) {\n          switch (part.type) {\n            case \"text\": {\n              parts.push({ text: part.text });\n              break;\n            }\n            case \"file\": {\n              const mediaType = part.mediaType === \"image/*\" ? \"image/jpeg\" : part.mediaType;\n              parts.push(\n                part.data instanceof URL ? {\n                  fileData: {\n                    mimeType: mediaType,\n                    fileUri: part.data.toString()\n                  }\n                } : {\n                  inlineData: {\n                    mimeType: mediaType,\n                    data: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.convertToBase64)(part.data)\n                  }\n                }\n              );\n              break;\n            }\n          }\n        }\n        contents.push({ role: \"user\", parts });\n        break;\n      }\n      case \"assistant\": {\n        systemMessagesAllowed = false;\n        contents.push({\n          role: \"model\",\n          parts: content.map((part) => {\n            var _a2;\n            const providerOpts = (_a2 = part.providerOptions) == null ? void 0 : _a2[providerOptionsName];\n            const thoughtSignature = (providerOpts == null ? void 0 : providerOpts.thoughtSignature) != null ? String(providerOpts.thoughtSignature) : void 0;\n            switch (part.type) {\n              case \"text\": {\n                return part.text.length === 0 ? void 0 : {\n                  text: part.text,\n                  thoughtSignature\n                };\n              }\n              case \"reasoning\": {\n                return part.text.length === 0 ? void 0 : {\n                  text: part.text,\n                  thought: true,\n                  thoughtSignature\n                };\n              }\n              case \"file\": {\n                if (part.data instanceof URL) {\n                  throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.UnsupportedFunctionalityError({\n                    functionality: \"File data URLs in assistant messages are not supported\"\n                  });\n                }\n                return {\n                  inlineData: {\n                    mimeType: part.mediaType,\n                    data: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.convertToBase64)(part.data)\n                  },\n                  thoughtSignature\n                };\n              }\n              case \"tool-call\": {\n                return {\n                  functionCall: {\n                    name: part.toolName,\n                    args: part.input\n                  },\n                  thoughtSignature\n                };\n              }\n            }\n          }).filter((part) => part !== void 0)\n        });\n        break;\n      }\n      case \"tool\": {\n        systemMessagesAllowed = false;\n        const parts = [];\n        for (const part of content) {\n          if (part.type === \"tool-approval-response\") {\n            continue;\n          }\n          const output = part.output;\n          if (output.type === \"content\") {\n            for (const contentPart of output.value) {\n              switch (contentPart.type) {\n                case \"text\":\n                  parts.push({\n                    functionResponse: {\n                      name: part.toolName,\n                      response: {\n                        name: part.toolName,\n                        content: contentPart.text\n                      }\n                    }\n                  });\n                  break;\n                case \"image-data\":\n                  parts.push(\n                    {\n                      inlineData: {\n                        mimeType: contentPart.mediaType,\n                        data: contentPart.data\n                      }\n                    },\n                    {\n                      text: \"Tool executed successfully and returned this image as a response\"\n                    }\n                  );\n                  break;\n                default:\n                  parts.push({ text: JSON.stringify(contentPart) });\n                  break;\n              }\n            }\n          } else {\n            parts.push({\n              functionResponse: {\n                name: part.toolName,\n                response: {\n                  name: part.toolName,\n                  content: output.type === \"execution-denied\" ? (_c = output.reason) != null ? _c : \"Tool execution denied.\" : output.value\n                }\n              }\n            });\n          }\n        }\n        contents.push({\n          role: \"user\",\n          parts\n        });\n        break;\n      }\n    }\n  }\n  if (isGemmaModel && systemInstructionParts.length > 0 && contents.length > 0 && contents[0].role === \"user\") {\n    const systemText = systemInstructionParts.map((part) => part.text).join(\"\\n\\n\");\n    contents[0].parts.unshift({ text: systemText + \"\\n\\n\" });\n  }\n  return {\n    systemInstruction: systemInstructionParts.length > 0 && !isGemmaModel ? { parts: systemInstructionParts } : void 0,\n    contents\n  };\n}\n\n// src/get-model-path.ts\nfunction getModelPath(modelId) {\n  return modelId.includes(\"/\") ? modelId : `models/${modelId}`;\n}\n\n// src/google-generative-ai-options.ts\n\n\nvar googleGenerativeAIProviderOptions = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(\n  () => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      responseModalities: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(zod_v4__WEBPACK_IMPORTED_MODULE_1__[\"enum\"]([\"TEXT\", \"IMAGE\"])).optional(),\n      thinkingConfig: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        thinkingBudget: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().optional(),\n        includeThoughts: zod_v4__WEBPACK_IMPORTED_MODULE_1__.boolean().optional(),\n        // https://ai.google.dev/gemini-api/docs/gemini-3?thinking=high#thinking_level\n        thinkingLevel: zod_v4__WEBPACK_IMPORTED_MODULE_1__[\"enum\"]([\"minimal\", \"low\", \"medium\", \"high\"]).optional()\n      }).optional(),\n      /**\n       * Optional.\n       * The name of the cached content used as context to serve the prediction.\n       * Format: cachedContents/{cachedContent}\n       */\n      cachedContent: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().optional(),\n      /**\n       * Optional. Enable structured output. Default is true.\n       *\n       * This is useful when the JSON Schema contains elements that are\n       * not supported by the OpenAPI schema version that\n       * Google Generative AI uses. You can use this to disable\n       * structured outputs if you need to.\n       */\n      structuredOutputs: zod_v4__WEBPACK_IMPORTED_MODULE_1__.boolean().optional(),\n      /**\n       * Optional. A list of unique safety settings for blocking unsafe content.\n       */\n      safetySettings: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(\n        zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n          category: zod_v4__WEBPACK_IMPORTED_MODULE_1__[\"enum\"]([\n            \"HARM_CATEGORY_UNSPECIFIED\",\n            \"HARM_CATEGORY_HATE_SPEECH\",\n            \"HARM_CATEGORY_DANGEROUS_CONTENT\",\n            \"HARM_CATEGORY_HARASSMENT\",\n            \"HARM_CATEGORY_SEXUALLY_EXPLICIT\",\n            \"HARM_CATEGORY_CIVIC_INTEGRITY\"\n          ]),\n          threshold: zod_v4__WEBPACK_IMPORTED_MODULE_1__[\"enum\"]([\n            \"HARM_BLOCK_THRESHOLD_UNSPECIFIED\",\n            \"BLOCK_LOW_AND_ABOVE\",\n            \"BLOCK_MEDIUM_AND_ABOVE\",\n            \"BLOCK_ONLY_HIGH\",\n            \"BLOCK_NONE\",\n            \"OFF\"\n          ])\n        })\n      ).optional(),\n      threshold: zod_v4__WEBPACK_IMPORTED_MODULE_1__[\"enum\"]([\n        \"HARM_BLOCK_THRESHOLD_UNSPECIFIED\",\n        \"BLOCK_LOW_AND_ABOVE\",\n        \"BLOCK_MEDIUM_AND_ABOVE\",\n        \"BLOCK_ONLY_HIGH\",\n        \"BLOCK_NONE\",\n        \"OFF\"\n      ]).optional(),\n      /**\n       * Optional. Enables timestamp understanding for audio-only files.\n       *\n       * https://cloud.google.com/vertex-ai/generative-ai/docs/multimodal/audio-understanding\n       */\n      audioTimestamp: zod_v4__WEBPACK_IMPORTED_MODULE_1__.boolean().optional(),\n      /**\n       * Optional. Defines labels used in billing reports. Available on Vertex AI only.\n       *\n       * https://cloud.google.com/vertex-ai/generative-ai/docs/multimodal/add-labels-to-api-calls\n       */\n      labels: zod_v4__WEBPACK_IMPORTED_MODULE_1__.record(zod_v4__WEBPACK_IMPORTED_MODULE_1__.string(), zod_v4__WEBPACK_IMPORTED_MODULE_1__.string()).optional(),\n      /**\n       * Optional. If specified, the media resolution specified will be used.\n       *\n       * https://ai.google.dev/api/generate-content#MediaResolution\n       */\n      mediaResolution: zod_v4__WEBPACK_IMPORTED_MODULE_1__[\"enum\"]([\n        \"MEDIA_RESOLUTION_UNSPECIFIED\",\n        \"MEDIA_RESOLUTION_LOW\",\n        \"MEDIA_RESOLUTION_MEDIUM\",\n        \"MEDIA_RESOLUTION_HIGH\"\n      ]).optional(),\n      /**\n       * Optional. Configures the image generation aspect ratio for Gemini models.\n       *\n       * https://ai.google.dev/gemini-api/docs/image-generation#aspect_ratios\n       */\n      imageConfig: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        aspectRatio: zod_v4__WEBPACK_IMPORTED_MODULE_1__[\"enum\"]([\n          \"1:1\",\n          \"2:3\",\n          \"3:2\",\n          \"3:4\",\n          \"4:3\",\n          \"4:5\",\n          \"5:4\",\n          \"9:16\",\n          \"16:9\",\n          \"21:9\"\n        ]).optional(),\n        imageSize: zod_v4__WEBPACK_IMPORTED_MODULE_1__[\"enum\"]([\"1K\", \"2K\", \"4K\"]).optional()\n      }).optional(),\n      /**\n       * Optional. Configuration for grounding retrieval.\n       * Used to provide location context for Google Maps and Google Search grounding.\n       *\n       * https://cloud.google.com/vertex-ai/generative-ai/docs/grounding/grounding-with-google-maps\n       */\n      retrievalConfig: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        latLng: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n          latitude: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number(),\n          longitude: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number()\n        }).optional()\n      }).optional()\n    })\n  )\n);\n\n// src/google-prepare-tools.ts\n\nfunction prepareTools({\n  tools,\n  toolChoice,\n  modelId\n}) {\n  var _a;\n  tools = (tools == null ? void 0 : tools.length) ? tools : void 0;\n  const toolWarnings = [];\n  const isLatest = [\n    \"gemini-flash-latest\",\n    \"gemini-flash-lite-latest\",\n    \"gemini-pro-latest\"\n  ].some((id) => id === modelId);\n  const isGemini2orNewer = modelId.includes(\"gemini-2\") || modelId.includes(\"gemini-3\") || isLatest;\n  const supportsDynamicRetrieval = modelId.includes(\"gemini-1.5-flash\") && !modelId.includes(\"-8b\");\n  const supportsFileSearch = modelId.includes(\"gemini-2.5\") || modelId.includes(\"gemini-3\");\n  if (tools == null) {\n    return { tools: void 0, toolConfig: void 0, toolWarnings };\n  }\n  const hasFunctionTools = tools.some((tool) => tool.type === \"function\");\n  const hasProviderTools = tools.some((tool) => tool.type === \"provider\");\n  if (hasFunctionTools && hasProviderTools) {\n    toolWarnings.push({\n      type: \"unsupported\",\n      feature: `combination of function and provider-defined tools`\n    });\n  }\n  if (hasProviderTools) {\n    const googleTools2 = [];\n    const ProviderTools = tools.filter((tool) => tool.type === \"provider\");\n    ProviderTools.forEach((tool) => {\n      switch (tool.id) {\n        case \"google.google_search\":\n          if (isGemini2orNewer) {\n            googleTools2.push({ googleSearch: {} });\n          } else if (supportsDynamicRetrieval) {\n            googleTools2.push({\n              googleSearchRetrieval: {\n                dynamicRetrievalConfig: {\n                  mode: tool.args.mode,\n                  dynamicThreshold: tool.args.dynamicThreshold\n                }\n              }\n            });\n          } else {\n            googleTools2.push({ googleSearchRetrieval: {} });\n          }\n          break;\n        case \"google.enterprise_web_search\":\n          if (isGemini2orNewer) {\n            googleTools2.push({ enterpriseWebSearch: {} });\n          } else {\n            toolWarnings.push({\n              type: \"unsupported\",\n              feature: `provider-defined tool ${tool.id}`,\n              details: \"Enterprise Web Search requires Gemini 2.0 or newer.\"\n            });\n          }\n          break;\n        case \"google.url_context\":\n          if (isGemini2orNewer) {\n            googleTools2.push({ urlContext: {} });\n          } else {\n            toolWarnings.push({\n              type: \"unsupported\",\n              feature: `provider-defined tool ${tool.id}`,\n              details: \"The URL context tool is not supported with other Gemini models than Gemini 2.\"\n            });\n          }\n          break;\n        case \"google.code_execution\":\n          if (isGemini2orNewer) {\n            googleTools2.push({ codeExecution: {} });\n          } else {\n            toolWarnings.push({\n              type: \"unsupported\",\n              feature: `provider-defined tool ${tool.id}`,\n              details: \"The code execution tools is not supported with other Gemini models than Gemini 2.\"\n            });\n          }\n          break;\n        case \"google.file_search\":\n          if (supportsFileSearch) {\n            googleTools2.push({ fileSearch: { ...tool.args } });\n          } else {\n            toolWarnings.push({\n              type: \"unsupported\",\n              feature: `provider-defined tool ${tool.id}`,\n              details: \"The file search tool is only supported with Gemini 2.5 models and Gemini 3 models.\"\n            });\n          }\n          break;\n        case \"google.vertex_rag_store\":\n          if (isGemini2orNewer) {\n            googleTools2.push({\n              retrieval: {\n                vertex_rag_store: {\n                  rag_resources: {\n                    rag_corpus: tool.args.ragCorpus\n                  },\n                  similarity_top_k: tool.args.topK\n                }\n              }\n            });\n          } else {\n            toolWarnings.push({\n              type: \"unsupported\",\n              feature: `provider-defined tool ${tool.id}`,\n              details: \"The RAG store tool is not supported with other Gemini models than Gemini 2.\"\n            });\n          }\n          break;\n        case \"google.google_maps\":\n          if (isGemini2orNewer) {\n            googleTools2.push({ googleMaps: {} });\n          } else {\n            toolWarnings.push({\n              type: \"unsupported\",\n              feature: `provider-defined tool ${tool.id}`,\n              details: \"The Google Maps grounding tool is not supported with Gemini models other than Gemini 2 or newer.\"\n            });\n          }\n          break;\n        default:\n          toolWarnings.push({\n            type: \"unsupported\",\n            feature: `provider-defined tool ${tool.id}`\n          });\n          break;\n      }\n    });\n    return {\n      tools: googleTools2.length > 0 ? googleTools2 : void 0,\n      toolConfig: void 0,\n      toolWarnings\n    };\n  }\n  const functionDeclarations = [];\n  for (const tool of tools) {\n    switch (tool.type) {\n      case \"function\":\n        functionDeclarations.push({\n          name: tool.name,\n          description: (_a = tool.description) != null ? _a : \"\",\n          parameters: convertJSONSchemaToOpenAPISchema(tool.inputSchema)\n        });\n        break;\n      default:\n        toolWarnings.push({\n          type: \"unsupported\",\n          feature: `function tool ${tool.name}`\n        });\n        break;\n    }\n  }\n  if (toolChoice == null) {\n    return {\n      tools: [{ functionDeclarations }],\n      toolConfig: void 0,\n      toolWarnings\n    };\n  }\n  const type = toolChoice.type;\n  switch (type) {\n    case \"auto\":\n      return {\n        tools: [{ functionDeclarations }],\n        toolConfig: { functionCallingConfig: { mode: \"AUTO\" } },\n        toolWarnings\n      };\n    case \"none\":\n      return {\n        tools: [{ functionDeclarations }],\n        toolConfig: { functionCallingConfig: { mode: \"NONE\" } },\n        toolWarnings\n      };\n    case \"required\":\n      return {\n        tools: [{ functionDeclarations }],\n        toolConfig: { functionCallingConfig: { mode: \"ANY\" } },\n        toolWarnings\n      };\n    case \"tool\":\n      return {\n        tools: [{ functionDeclarations }],\n        toolConfig: {\n          functionCallingConfig: {\n            mode: \"ANY\",\n            allowedFunctionNames: [toolChoice.toolName]\n          }\n        },\n        toolWarnings\n      };\n    default: {\n      const _exhaustiveCheck = type;\n      throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.UnsupportedFunctionalityError({\n        functionality: `tool choice type: ${_exhaustiveCheck}`\n      });\n    }\n  }\n}\n\n// src/map-google-generative-ai-finish-reason.ts\nfunction mapGoogleGenerativeAIFinishReason({\n  finishReason,\n  hasToolCalls\n}) {\n  switch (finishReason) {\n    case \"STOP\":\n      return hasToolCalls ? \"tool-calls\" : \"stop\";\n    case \"MAX_TOKENS\":\n      return \"length\";\n    case \"IMAGE_SAFETY\":\n    case \"RECITATION\":\n    case \"SAFETY\":\n    case \"BLOCKLIST\":\n    case \"PROHIBITED_CONTENT\":\n    case \"SPII\":\n      return \"content-filter\";\n    case \"MALFORMED_FUNCTION_CALL\":\n      return \"error\";\n    case \"FINISH_REASON_UNSPECIFIED\":\n    case \"OTHER\":\n    default:\n      return \"other\";\n  }\n}\n\n// src/google-generative-ai-language-model.ts\nvar GoogleGenerativeAILanguageModel = class {\n  constructor(modelId, config) {\n    this.specificationVersion = \"v3\";\n    var _a;\n    this.modelId = modelId;\n    this.config = config;\n    this.generateId = (_a = config.generateId) != null ? _a : _ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.generateId;\n  }\n  get provider() {\n    return this.config.provider;\n  }\n  get supportedUrls() {\n    var _a, _b, _c;\n    return (_c = (_b = (_a = this.config).supportedUrls) == null ? void 0 : _b.call(_a)) != null ? _c : {};\n  }\n  async getArgs({\n    prompt,\n    maxOutputTokens,\n    temperature,\n    topP,\n    topK,\n    frequencyPenalty,\n    presencePenalty,\n    stopSequences,\n    responseFormat,\n    seed,\n    tools,\n    toolChoice,\n    providerOptions\n  }) {\n    var _a;\n    const warnings = [];\n    const providerOptionsName = this.config.provider.includes(\"vertex\") ? \"vertex\" : \"google\";\n    let googleOptions = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.parseProviderOptions)({\n      provider: providerOptionsName,\n      providerOptions,\n      schema: googleGenerativeAIProviderOptions\n    });\n    if (googleOptions == null && providerOptionsName !== \"google\") {\n      googleOptions = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.parseProviderOptions)({\n        provider: \"google\",\n        providerOptions,\n        schema: googleGenerativeAIProviderOptions\n      });\n    }\n    if ((tools == null ? void 0 : tools.some(\n      (tool) => tool.type === \"provider\" && tool.id === \"google.vertex_rag_store\"\n    )) && !this.config.provider.startsWith(\"google.vertex.\")) {\n      warnings.push({\n        type: \"other\",\n        message: `The 'vertex_rag_store' tool is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`\n      });\n    }\n    const isGemmaModel = this.modelId.toLowerCase().startsWith(\"gemma-\");\n    const { contents, systemInstruction } = convertToGoogleGenerativeAIMessages(\n      prompt,\n      { isGemmaModel, providerOptionsName }\n    );\n    const {\n      tools: googleTools2,\n      toolConfig: googleToolConfig,\n      toolWarnings\n    } = prepareTools({\n      tools,\n      toolChoice,\n      modelId: this.modelId\n    });\n    return {\n      args: {\n        generationConfig: {\n          // standardized settings:\n          maxOutputTokens,\n          temperature,\n          topK,\n          topP,\n          frequencyPenalty,\n          presencePenalty,\n          stopSequences,\n          seed,\n          // response format:\n          responseMimeType: (responseFormat == null ? void 0 : responseFormat.type) === \"json\" ? \"application/json\" : void 0,\n          responseSchema: (responseFormat == null ? void 0 : responseFormat.type) === \"json\" && responseFormat.schema != null && // Google GenAI does not support all OpenAPI Schema features,\n          // so this is needed as an escape hatch:\n          // TODO convert into provider option\n          ((_a = googleOptions == null ? void 0 : googleOptions.structuredOutputs) != null ? _a : true) ? convertJSONSchemaToOpenAPISchema(responseFormat.schema) : void 0,\n          ...(googleOptions == null ? void 0 : googleOptions.audioTimestamp) && {\n            audioTimestamp: googleOptions.audioTimestamp\n          },\n          // provider options:\n          responseModalities: googleOptions == null ? void 0 : googleOptions.responseModalities,\n          thinkingConfig: googleOptions == null ? void 0 : googleOptions.thinkingConfig,\n          ...(googleOptions == null ? void 0 : googleOptions.mediaResolution) && {\n            mediaResolution: googleOptions.mediaResolution\n          },\n          ...(googleOptions == null ? void 0 : googleOptions.imageConfig) && {\n            imageConfig: googleOptions.imageConfig\n          }\n        },\n        contents,\n        systemInstruction: isGemmaModel ? void 0 : systemInstruction,\n        safetySettings: googleOptions == null ? void 0 : googleOptions.safetySettings,\n        tools: googleTools2,\n        toolConfig: (googleOptions == null ? void 0 : googleOptions.retrievalConfig) ? {\n          ...googleToolConfig,\n          retrievalConfig: googleOptions.retrievalConfig\n        } : googleToolConfig,\n        cachedContent: googleOptions == null ? void 0 : googleOptions.cachedContent,\n        labels: googleOptions == null ? void 0 : googleOptions.labels\n      },\n      warnings: [...warnings, ...toolWarnings],\n      providerOptionsName\n    };\n  }\n  async doGenerate(options) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _i;\n    const { args, warnings, providerOptionsName } = await this.getArgs(options);\n    const mergedHeaders = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.combineHeaders)(\n      await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.resolve)(this.config.headers),\n      options.headers\n    );\n    const {\n      responseHeaders,\n      value: response,\n      rawValue: rawResponse\n    } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.postJsonToApi)({\n      url: `${this.config.baseURL}/${getModelPath(\n        this.modelId\n      )}:generateContent`,\n      headers: mergedHeaders,\n      body: args,\n      failedResponseHandler: googleFailedResponseHandler,\n      successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createJsonResponseHandler)(responseSchema),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch\n    });\n    const candidate = response.candidates[0];\n    const content = [];\n    const parts = (_b = (_a = candidate.content) == null ? void 0 : _a.parts) != null ? _b : [];\n    const usageMetadata = response.usageMetadata;\n    let lastCodeExecutionToolCallId;\n    for (const part of parts) {\n      if (\"executableCode\" in part && ((_c = part.executableCode) == null ? void 0 : _c.code)) {\n        const toolCallId = this.config.generateId();\n        lastCodeExecutionToolCallId = toolCallId;\n        content.push({\n          type: \"tool-call\",\n          toolCallId,\n          toolName: \"code_execution\",\n          input: JSON.stringify(part.executableCode),\n          providerExecuted: true\n        });\n      } else if (\"codeExecutionResult\" in part && part.codeExecutionResult) {\n        content.push({\n          type: \"tool-result\",\n          // Assumes a result directly follows its corresponding call part.\n          toolCallId: lastCodeExecutionToolCallId,\n          toolName: \"code_execution\",\n          result: {\n            outcome: part.codeExecutionResult.outcome,\n            output: part.codeExecutionResult.output\n          }\n        });\n        lastCodeExecutionToolCallId = void 0;\n      } else if (\"text\" in part && part.text != null && part.text.length > 0) {\n        content.push({\n          type: part.thought === true ? \"reasoning\" : \"text\",\n          text: part.text,\n          providerMetadata: part.thoughtSignature ? {\n            [providerOptionsName]: {\n              thoughtSignature: part.thoughtSignature\n            }\n          } : void 0\n        });\n      } else if (\"functionCall\" in part) {\n        content.push({\n          type: \"tool-call\",\n          toolCallId: this.config.generateId(),\n          toolName: part.functionCall.name,\n          input: JSON.stringify(part.functionCall.args),\n          providerMetadata: part.thoughtSignature ? {\n            [providerOptionsName]: {\n              thoughtSignature: part.thoughtSignature\n            }\n          } : void 0\n        });\n      } else if (\"inlineData\" in part) {\n        content.push({\n          type: \"file\",\n          data: part.inlineData.data,\n          mediaType: part.inlineData.mimeType,\n          providerMetadata: part.thoughtSignature ? {\n            [providerOptionsName]: {\n              thoughtSignature: part.thoughtSignature\n            }\n          } : void 0\n        });\n      }\n    }\n    const sources = (_d = extractSources({\n      groundingMetadata: candidate.groundingMetadata,\n      generateId: this.config.generateId\n    })) != null ? _d : [];\n    for (const source of sources) {\n      content.push(source);\n    }\n    return {\n      content,\n      finishReason: {\n        unified: mapGoogleGenerativeAIFinishReason({\n          finishReason: candidate.finishReason,\n          // Only count client-executed tool calls for finish reason determination.\n          hasToolCalls: content.some(\n            (part) => part.type === \"tool-call\" && !part.providerExecuted\n          )\n        }),\n        raw: (_e = candidate.finishReason) != null ? _e : void 0\n      },\n      usage: convertGoogleGenerativeAIUsage(usageMetadata),\n      warnings,\n      providerMetadata: {\n        [providerOptionsName]: {\n          promptFeedback: (_f = response.promptFeedback) != null ? _f : null,\n          groundingMetadata: (_g = candidate.groundingMetadata) != null ? _g : null,\n          urlContextMetadata: (_h = candidate.urlContextMetadata) != null ? _h : null,\n          safetyRatings: (_i = candidate.safetyRatings) != null ? _i : null,\n          usageMetadata: usageMetadata != null ? usageMetadata : null\n        }\n      },\n      request: { body: args },\n      response: {\n        // TODO timestamp, model id, id\n        headers: responseHeaders,\n        body: rawResponse\n      }\n    };\n  }\n  async doStream(options) {\n    const { args, warnings, providerOptionsName } = await this.getArgs(options);\n    const headers = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.combineHeaders)(\n      await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.resolve)(this.config.headers),\n      options.headers\n    );\n    const { responseHeaders, value: response } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.postJsonToApi)({\n      url: `${this.config.baseURL}/${getModelPath(\n        this.modelId\n      )}:streamGenerateContent?alt=sse`,\n      headers,\n      body: args,\n      failedResponseHandler: googleFailedResponseHandler,\n      successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createEventSourceResponseHandler)(chunkSchema),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch\n    });\n    let finishReason = {\n      unified: \"other\",\n      raw: void 0\n    };\n    let usage = void 0;\n    let providerMetadata = void 0;\n    const generateId3 = this.config.generateId;\n    let hasToolCalls = false;\n    let currentTextBlockId = null;\n    let currentReasoningBlockId = null;\n    let blockCounter = 0;\n    const emittedSourceUrls = /* @__PURE__ */ new Set();\n    let lastCodeExecutionToolCallId;\n    return {\n      stream: response.pipeThrough(\n        new TransformStream({\n          start(controller) {\n            controller.enqueue({ type: \"stream-start\", warnings });\n          },\n          transform(chunk, controller) {\n            var _a, _b, _c, _d, _e, _f, _g;\n            if (options.includeRawChunks) {\n              controller.enqueue({ type: \"raw\", rawValue: chunk.rawValue });\n            }\n            if (!chunk.success) {\n              controller.enqueue({ type: \"error\", error: chunk.error });\n              return;\n            }\n            const value = chunk.value;\n            const usageMetadata = value.usageMetadata;\n            if (usageMetadata != null) {\n              usage = usageMetadata;\n            }\n            const candidate = (_a = value.candidates) == null ? void 0 : _a[0];\n            if (candidate == null) {\n              return;\n            }\n            const content = candidate.content;\n            const sources = extractSources({\n              groundingMetadata: candidate.groundingMetadata,\n              generateId: generateId3\n            });\n            if (sources != null) {\n              for (const source of sources) {\n                if (source.sourceType === \"url\" && !emittedSourceUrls.has(source.url)) {\n                  emittedSourceUrls.add(source.url);\n                  controller.enqueue(source);\n                }\n              }\n            }\n            if (content != null) {\n              const parts = (_b = content.parts) != null ? _b : [];\n              for (const part of parts) {\n                if (\"executableCode\" in part && ((_c = part.executableCode) == null ? void 0 : _c.code)) {\n                  const toolCallId = generateId3();\n                  lastCodeExecutionToolCallId = toolCallId;\n                  controller.enqueue({\n                    type: \"tool-call\",\n                    toolCallId,\n                    toolName: \"code_execution\",\n                    input: JSON.stringify(part.executableCode),\n                    providerExecuted: true\n                  });\n                } else if (\"codeExecutionResult\" in part && part.codeExecutionResult) {\n                  const toolCallId = lastCodeExecutionToolCallId;\n                  if (toolCallId) {\n                    controller.enqueue({\n                      type: \"tool-result\",\n                      toolCallId,\n                      toolName: \"code_execution\",\n                      result: {\n                        outcome: part.codeExecutionResult.outcome,\n                        output: part.codeExecutionResult.output\n                      }\n                    });\n                    lastCodeExecutionToolCallId = void 0;\n                  }\n                } else if (\"text\" in part && part.text != null && part.text.length > 0) {\n                  if (part.thought === true) {\n                    if (currentTextBlockId !== null) {\n                      controller.enqueue({\n                        type: \"text-end\",\n                        id: currentTextBlockId\n                      });\n                      currentTextBlockId = null;\n                    }\n                    if (currentReasoningBlockId === null) {\n                      currentReasoningBlockId = String(blockCounter++);\n                      controller.enqueue({\n                        type: \"reasoning-start\",\n                        id: currentReasoningBlockId,\n                        providerMetadata: part.thoughtSignature ? {\n                          [providerOptionsName]: {\n                            thoughtSignature: part.thoughtSignature\n                          }\n                        } : void 0\n                      });\n                    }\n                    controller.enqueue({\n                      type: \"reasoning-delta\",\n                      id: currentReasoningBlockId,\n                      delta: part.text,\n                      providerMetadata: part.thoughtSignature ? {\n                        [providerOptionsName]: {\n                          thoughtSignature: part.thoughtSignature\n                        }\n                      } : void 0\n                    });\n                  } else {\n                    if (currentReasoningBlockId !== null) {\n                      controller.enqueue({\n                        type: \"reasoning-end\",\n                        id: currentReasoningBlockId\n                      });\n                      currentReasoningBlockId = null;\n                    }\n                    if (currentTextBlockId === null) {\n                      currentTextBlockId = String(blockCounter++);\n                      controller.enqueue({\n                        type: \"text-start\",\n                        id: currentTextBlockId,\n                        providerMetadata: part.thoughtSignature ? {\n                          [providerOptionsName]: {\n                            thoughtSignature: part.thoughtSignature\n                          }\n                        } : void 0\n                      });\n                    }\n                    controller.enqueue({\n                      type: \"text-delta\",\n                      id: currentTextBlockId,\n                      delta: part.text,\n                      providerMetadata: part.thoughtSignature ? {\n                        [providerOptionsName]: {\n                          thoughtSignature: part.thoughtSignature\n                        }\n                      } : void 0\n                    });\n                  }\n                } else if (\"inlineData\" in part) {\n                  controller.enqueue({\n                    type: \"file\",\n                    mediaType: part.inlineData.mimeType,\n                    data: part.inlineData.data\n                  });\n                }\n              }\n              const toolCallDeltas = getToolCallsFromParts({\n                parts: content.parts,\n                generateId: generateId3,\n                providerOptionsName\n              });\n              if (toolCallDeltas != null) {\n                for (const toolCall of toolCallDeltas) {\n                  controller.enqueue({\n                    type: \"tool-input-start\",\n                    id: toolCall.toolCallId,\n                    toolName: toolCall.toolName,\n                    providerMetadata: toolCall.providerMetadata\n                  });\n                  controller.enqueue({\n                    type: \"tool-input-delta\",\n                    id: toolCall.toolCallId,\n                    delta: toolCall.args,\n                    providerMetadata: toolCall.providerMetadata\n                  });\n                  controller.enqueue({\n                    type: \"tool-input-end\",\n                    id: toolCall.toolCallId,\n                    providerMetadata: toolCall.providerMetadata\n                  });\n                  controller.enqueue({\n                    type: \"tool-call\",\n                    toolCallId: toolCall.toolCallId,\n                    toolName: toolCall.toolName,\n                    input: toolCall.args,\n                    providerMetadata: toolCall.providerMetadata\n                  });\n                  hasToolCalls = true;\n                }\n              }\n            }\n            if (candidate.finishReason != null) {\n              finishReason = {\n                unified: mapGoogleGenerativeAIFinishReason({\n                  finishReason: candidate.finishReason,\n                  hasToolCalls\n                }),\n                raw: candidate.finishReason\n              };\n              providerMetadata = {\n                [providerOptionsName]: {\n                  promptFeedback: (_d = value.promptFeedback) != null ? _d : null,\n                  groundingMetadata: (_e = candidate.groundingMetadata) != null ? _e : null,\n                  urlContextMetadata: (_f = candidate.urlContextMetadata) != null ? _f : null,\n                  safetyRatings: (_g = candidate.safetyRatings) != null ? _g : null\n                }\n              };\n              if (usageMetadata != null) {\n                providerMetadata[providerOptionsName].usageMetadata = usageMetadata;\n              }\n            }\n          },\n          flush(controller) {\n            if (currentTextBlockId !== null) {\n              controller.enqueue({\n                type: \"text-end\",\n                id: currentTextBlockId\n              });\n            }\n            if (currentReasoningBlockId !== null) {\n              controller.enqueue({\n                type: \"reasoning-end\",\n                id: currentReasoningBlockId\n              });\n            }\n            controller.enqueue({\n              type: \"finish\",\n              finishReason,\n              usage: convertGoogleGenerativeAIUsage(usage),\n              providerMetadata\n            });\n          }\n        })\n      ),\n      response: { headers: responseHeaders },\n      request: { body: args }\n    };\n  }\n};\nfunction getToolCallsFromParts({\n  parts,\n  generateId: generateId3,\n  providerOptionsName\n}) {\n  const functionCallParts = parts == null ? void 0 : parts.filter(\n    (part) => \"functionCall\" in part\n  );\n  return functionCallParts == null || functionCallParts.length === 0 ? void 0 : functionCallParts.map((part) => ({\n    type: \"tool-call\",\n    toolCallId: generateId3(),\n    toolName: part.functionCall.name,\n    args: JSON.stringify(part.functionCall.args),\n    providerMetadata: part.thoughtSignature ? {\n      [providerOptionsName]: {\n        thoughtSignature: part.thoughtSignature\n      }\n    } : void 0\n  }));\n}\nfunction extractSources({\n  groundingMetadata,\n  generateId: generateId3\n}) {\n  var _a, _b, _c, _d, _e;\n  if (!(groundingMetadata == null ? void 0 : groundingMetadata.groundingChunks)) {\n    return void 0;\n  }\n  const sources = [];\n  for (const chunk of groundingMetadata.groundingChunks) {\n    if (chunk.web != null) {\n      sources.push({\n        type: \"source\",\n        sourceType: \"url\",\n        id: generateId3(),\n        url: chunk.web.uri,\n        title: (_a = chunk.web.title) != null ? _a : void 0\n      });\n    } else if (chunk.retrievedContext != null) {\n      const uri = chunk.retrievedContext.uri;\n      const fileSearchStore = chunk.retrievedContext.fileSearchStore;\n      if (uri && (uri.startsWith(\"http://\") || uri.startsWith(\"https://\"))) {\n        sources.push({\n          type: \"source\",\n          sourceType: \"url\",\n          id: generateId3(),\n          url: uri,\n          title: (_b = chunk.retrievedContext.title) != null ? _b : void 0\n        });\n      } else if (uri) {\n        const title = (_c = chunk.retrievedContext.title) != null ? _c : \"Unknown Document\";\n        let mediaType = \"application/octet-stream\";\n        let filename = void 0;\n        if (uri.endsWith(\".pdf\")) {\n          mediaType = \"application/pdf\";\n          filename = uri.split(\"/\").pop();\n        } else if (uri.endsWith(\".txt\")) {\n          mediaType = \"text/plain\";\n          filename = uri.split(\"/\").pop();\n        } else if (uri.endsWith(\".docx\")) {\n          mediaType = \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\";\n          filename = uri.split(\"/\").pop();\n        } else if (uri.endsWith(\".doc\")) {\n          mediaType = \"application/msword\";\n          filename = uri.split(\"/\").pop();\n        } else if (uri.match(/\\.(md|markdown)$/)) {\n          mediaType = \"text/markdown\";\n          filename = uri.split(\"/\").pop();\n        } else {\n          filename = uri.split(\"/\").pop();\n        }\n        sources.push({\n          type: \"source\",\n          sourceType: \"document\",\n          id: generateId3(),\n          mediaType,\n          title,\n          filename\n        });\n      } else if (fileSearchStore) {\n        const title = (_d = chunk.retrievedContext.title) != null ? _d : \"Unknown Document\";\n        sources.push({\n          type: \"source\",\n          sourceType: \"document\",\n          id: generateId3(),\n          mediaType: \"application/octet-stream\",\n          title,\n          filename: fileSearchStore.split(\"/\").pop()\n        });\n      }\n    } else if (chunk.maps != null) {\n      if (chunk.maps.uri) {\n        sources.push({\n          type: \"source\",\n          sourceType: \"url\",\n          id: generateId3(),\n          url: chunk.maps.uri,\n          title: (_e = chunk.maps.title) != null ? _e : void 0\n        });\n      }\n    }\n  }\n  return sources.length > 0 ? sources : void 0;\n}\nvar getGroundingMetadataSchema = () => zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n  webSearchQueries: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(zod_v4__WEBPACK_IMPORTED_MODULE_1__.string()).nullish(),\n  retrievalQueries: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(zod_v4__WEBPACK_IMPORTED_MODULE_1__.string()).nullish(),\n  searchEntryPoint: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({ renderedContent: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string() }).nullish(),\n  groundingChunks: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      web: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({ uri: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string(), title: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish() }).nullish(),\n      retrievedContext: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        uri: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n        title: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n        text: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n        fileSearchStore: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish()\n      }).nullish(),\n      maps: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        uri: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n        title: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n        text: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n        placeId: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish()\n      }).nullish()\n    })\n  ).nullish(),\n  groundingSupports: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      segment: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        startIndex: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().nullish(),\n        endIndex: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().nullish(),\n        text: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish()\n      }),\n      segment_text: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n      groundingChunkIndices: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(zod_v4__WEBPACK_IMPORTED_MODULE_1__.number()).nullish(),\n      supportChunkIndices: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(zod_v4__WEBPACK_IMPORTED_MODULE_1__.number()).nullish(),\n      confidenceScores: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(zod_v4__WEBPACK_IMPORTED_MODULE_1__.number()).nullish(),\n      confidenceScore: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(zod_v4__WEBPACK_IMPORTED_MODULE_1__.number()).nullish()\n    })\n  ).nullish(),\n  retrievalMetadata: zod_v4__WEBPACK_IMPORTED_MODULE_1__.union([\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      webDynamicRetrievalScore: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number()\n    }),\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({})\n  ]).nullish()\n});\nvar getContentSchema = () => zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n  parts: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.union([\n      // note: order matters since text can be fully empty\n      zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        functionCall: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n          name: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string(),\n          args: zod_v4__WEBPACK_IMPORTED_MODULE_1__.unknown()\n        }),\n        thoughtSignature: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish()\n      }),\n      zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        inlineData: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n          mimeType: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string(),\n          data: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string()\n        }),\n        thoughtSignature: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish()\n      }),\n      zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        executableCode: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n          language: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string(),\n          code: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string()\n        }).nullish(),\n        codeExecutionResult: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n          outcome: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string(),\n          output: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string()\n        }).nullish(),\n        text: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n        thought: zod_v4__WEBPACK_IMPORTED_MODULE_1__.boolean().nullish(),\n        thoughtSignature: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish()\n      })\n    ])\n  ).nullish()\n});\nvar getSafetyRatingSchema = () => zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n  category: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n  probability: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n  probabilityScore: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().nullish(),\n  severity: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n  severityScore: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().nullish(),\n  blocked: zod_v4__WEBPACK_IMPORTED_MODULE_1__.boolean().nullish()\n});\nvar usageSchema = zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n  cachedContentTokenCount: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().nullish(),\n  thoughtsTokenCount: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().nullish(),\n  promptTokenCount: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().nullish(),\n  candidatesTokenCount: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().nullish(),\n  totalTokenCount: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().nullish(),\n  // https://cloud.google.com/vertex-ai/generative-ai/docs/reference/rest/v1/GenerateContentResponse#TrafficType\n  trafficType: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish()\n});\nvar getUrlContextMetadataSchema = () => zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n  urlMetadata: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      retrievedUrl: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string(),\n      urlRetrievalStatus: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string()\n    })\n  )\n});\nvar responseSchema = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(\n  () => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      candidates: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(\n        zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n          content: getContentSchema().nullish().or(zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({}).strict()),\n          finishReason: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n          safetyRatings: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(getSafetyRatingSchema()).nullish(),\n          groundingMetadata: getGroundingMetadataSchema().nullish(),\n          urlContextMetadata: getUrlContextMetadataSchema().nullish()\n        })\n      ),\n      usageMetadata: usageSchema.nullish(),\n      promptFeedback: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        blockReason: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n        safetyRatings: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(getSafetyRatingSchema()).nullish()\n      }).nullish()\n    })\n  )\n);\nvar chunkSchema = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(\n  () => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      candidates: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(\n        zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n          content: getContentSchema().nullish(),\n          finishReason: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n          safetyRatings: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(getSafetyRatingSchema()).nullish(),\n          groundingMetadata: getGroundingMetadataSchema().nullish(),\n          urlContextMetadata: getUrlContextMetadataSchema().nullish()\n        })\n      ).nullish(),\n      usageMetadata: usageSchema.nullish(),\n      promptFeedback: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        blockReason: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().nullish(),\n        safetyRatings: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(getSafetyRatingSchema()).nullish()\n      }).nullish()\n    })\n  )\n);\n\n// src/tool/code-execution.ts\n\n\nvar codeExecution = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createProviderToolFactoryWithOutputSchema)({\n  id: \"google.code_execution\",\n  inputSchema: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n    language: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().describe(\"The programming language of the code.\"),\n    code: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().describe(\"The code to be executed.\")\n  }),\n  outputSchema: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n    outcome: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().describe('The outcome of the execution (e.g., \"OUTCOME_OK\").'),\n    output: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().describe(\"The output from the code execution.\")\n  })\n});\n\n// src/tool/enterprise-web-search.ts\n\n\nvar enterpriseWebSearch = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createProviderToolFactory)({\n  id: \"google.enterprise_web_search\",\n  inputSchema: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(() => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({})))\n});\n\n// src/tool/file-search.ts\n\n\nvar fileSearchArgsBaseSchema = zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n  /** The names of the file_search_stores to retrieve from.\n   *  Example: `fileSearchStores/my-file-search-store-123`\n   */\n  fileSearchStoreNames: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(zod_v4__WEBPACK_IMPORTED_MODULE_1__.string()).describe(\n    \"The names of the file_search_stores to retrieve from. Example: `fileSearchStores/my-file-search-store-123`\"\n  ),\n  /** The number of file search retrieval chunks to retrieve. */\n  topK: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().int().positive().describe(\"The number of file search retrieval chunks to retrieve.\").optional(),\n  /** Metadata filter to apply to the file search retrieval documents.\n   *  See https://google.aip.dev/160 for the syntax of the filter expression.\n   */\n  metadataFilter: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string().describe(\n    \"Metadata filter to apply to the file search retrieval documents. See https://google.aip.dev/160 for the syntax of the filter expression.\"\n  ).optional()\n}).passthrough();\nvar fileSearchArgsSchema = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(\n  () => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(fileSearchArgsBaseSchema)\n);\nvar fileSearch = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createProviderToolFactory)({\n  id: \"google.file_search\",\n  inputSchema: fileSearchArgsSchema\n});\n\n// src/tool/google-maps.ts\n\n\nvar googleMaps = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createProviderToolFactory)({\n  id: \"google.google_maps\",\n  inputSchema: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(() => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({})))\n});\n\n// src/tool/google-search.ts\n\n\nvar googleSearch = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createProviderToolFactory)({\n  id: \"google.google_search\",\n  inputSchema: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(\n    () => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(\n      zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n        mode: zod_v4__WEBPACK_IMPORTED_MODULE_1__[\"enum\"]([\"MODE_DYNAMIC\", \"MODE_UNSPECIFIED\"]).default(\"MODE_UNSPECIFIED\"),\n        dynamicThreshold: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().default(1)\n      })\n    )\n  )\n});\n\n// src/tool/url-context.ts\n\n\nvar urlContext = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createProviderToolFactory)({\n  id: \"google.url_context\",\n  inputSchema: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(() => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({})))\n});\n\n// src/tool/vertex-rag-store.ts\n\n\nvar vertexRagStore = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createProviderToolFactory)({\n  id: \"google.vertex_rag_store\",\n  inputSchema: zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n    ragCorpus: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string(),\n    topK: zod_v4__WEBPACK_IMPORTED_MODULE_1__.number().optional()\n  })\n});\n\n// src/google-tools.ts\nvar googleTools = {\n  /**\n   * Creates a Google search tool that gives Google direct access to real-time web content.\n   * Must have name \"google_search\".\n   */\n  googleSearch,\n  /**\n   * Creates an Enterprise Web Search tool for grounding responses using a compliance-focused web index.\n   * Designed for highly-regulated industries (finance, healthcare, public sector).\n   * Does not log customer data and supports VPC service controls.\n   * Must have name \"enterprise_web_search\".\n   *\n   * @note Only available on Vertex AI. Requires Gemini 2.0 or newer.\n   *\n   * @see https://cloud.google.com/vertex-ai/generative-ai/docs/grounding/web-grounding-enterprise\n   */\n  enterpriseWebSearch,\n  /**\n   * Creates a Google Maps grounding tool that gives the model access to Google Maps data.\n   * Must have name \"google_maps\".\n   *\n   * @see https://ai.google.dev/gemini-api/docs/maps-grounding\n   * @see https://cloud.google.com/vertex-ai/generative-ai/docs/grounding/grounding-with-google-maps\n   */\n  googleMaps,\n  /**\n   * Creates a URL context tool that gives Google direct access to real-time web content.\n   * Must have name \"url_context\".\n   */\n  urlContext,\n  /**\n   * Enables Retrieval Augmented Generation (RAG) via the Gemini File Search tool.\n   * Must have name \"file_search\".\n   *\n   * @param fileSearchStoreNames - Fully-qualified File Search store resource names.\n   * @param metadataFilter - Optional filter expression to restrict the files that can be retrieved.\n   * @param topK - Optional result limit for the number of chunks returned from File Search.\n   *\n   * @see https://ai.google.dev/gemini-api/docs/file-search\n   */\n  fileSearch,\n  /**\n   * A tool that enables the model to generate and run Python code.\n   * Must have name \"code_execution\".\n   *\n   * @note Ensure the selected model supports Code Execution.\n   * Multi-tool usage with the code execution tool is typically compatible with Gemini >=2 models.\n   *\n   * @see https://ai.google.dev/gemini-api/docs/code-execution (Google AI)\n   * @see https://cloud.google.com/vertex-ai/generative-ai/docs/model-reference/code-execution-api (Vertex AI)\n   */\n  codeExecution,\n  /**\n   * Creates a Vertex RAG Store tool that enables the model to perform RAG searches against a Vertex RAG Store.\n   * Must have name \"vertex_rag_store\".\n   */\n  vertexRagStore\n};\n\n// src/google-generative-ai-image-model.ts\n\n\nvar GoogleGenerativeAIImageModel = class {\n  constructor(modelId, settings, config) {\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n    this.specificationVersion = \"v3\";\n  }\n  get maxImagesPerCall() {\n    var _a;\n    return (_a = this.settings.maxImagesPerCall) != null ? _a : 4;\n  }\n  get provider() {\n    return this.config.provider;\n  }\n  async doGenerate(options) {\n    var _a, _b, _c;\n    const {\n      prompt,\n      n = 1,\n      size,\n      aspectRatio = \"1:1\",\n      seed,\n      providerOptions,\n      headers,\n      abortSignal,\n      files,\n      mask\n    } = options;\n    const warnings = [];\n    if (files != null && files.length > 0) {\n      throw new Error(\n        \"Google Generative AI does not support image editing. Use Google Vertex AI (@ai-sdk/google-vertex) for image editing capabilities.\"\n      );\n    }\n    if (mask != null) {\n      throw new Error(\n        \"Google Generative AI does not support image editing with masks. Use Google Vertex AI (@ai-sdk/google-vertex) for image editing capabilities.\"\n      );\n    }\n    if (size != null) {\n      warnings.push({\n        type: \"unsupported\",\n        feature: \"size\",\n        details: \"This model does not support the `size` option. Use `aspectRatio` instead.\"\n      });\n    }\n    if (seed != null) {\n      warnings.push({\n        type: \"unsupported\",\n        feature: \"seed\",\n        details: \"This model does not support the `seed` option through this provider.\"\n      });\n    }\n    const googleOptions = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.parseProviderOptions)({\n      provider: \"google\",\n      providerOptions,\n      schema: googleImageProviderOptionsSchema\n    });\n    const currentDate = (_c = (_b = (_a = this.config._internal) == null ? void 0 : _a.currentDate) == null ? void 0 : _b.call(_a)) != null ? _c : /* @__PURE__ */ new Date();\n    const parameters = {\n      sampleCount: n\n    };\n    if (aspectRatio != null) {\n      parameters.aspectRatio = aspectRatio;\n    }\n    if (googleOptions) {\n      Object.assign(parameters, googleOptions);\n    }\n    const body = {\n      instances: [{ prompt }],\n      parameters\n    };\n    const { responseHeaders, value: response } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.postJsonToApi)({\n      url: `${this.config.baseURL}/models/${this.modelId}:predict`,\n      headers: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.combineHeaders)(await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.resolve)(this.config.headers), headers),\n      body,\n      failedResponseHandler: googleFailedResponseHandler,\n      successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.createJsonResponseHandler)(\n        googleImageResponseSchema\n      ),\n      abortSignal,\n      fetch: this.config.fetch\n    });\n    return {\n      images: response.predictions.map(\n        (p) => p.bytesBase64Encoded\n      ),\n      warnings: warnings != null ? warnings : [],\n      providerMetadata: {\n        google: {\n          images: response.predictions.map((prediction) => ({\n            // Add any prediction-specific metadata here\n          }))\n        }\n      },\n      response: {\n        timestamp: currentDate,\n        modelId: this.modelId,\n        headers: responseHeaders\n      }\n    };\n  }\n};\nvar googleImageResponseSchema = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(\n  () => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      predictions: zod_v4__WEBPACK_IMPORTED_MODULE_1__.array(zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({ bytesBase64Encoded: zod_v4__WEBPACK_IMPORTED_MODULE_1__.string() })).default([])\n    })\n  )\n);\nvar googleImageProviderOptionsSchema = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.lazySchema)(\n  () => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.zodSchema)(\n    zod_v4__WEBPACK_IMPORTED_MODULE_1__.object({\n      personGeneration: zod_v4__WEBPACK_IMPORTED_MODULE_1__[\"enum\"]([\"dont_allow\", \"allow_adult\", \"allow_all\"]).nullish(),\n      aspectRatio: zod_v4__WEBPACK_IMPORTED_MODULE_1__[\"enum\"]([\"1:1\", \"3:4\", \"4:3\", \"9:16\", \"16:9\"]).nullish()\n    })\n  )\n);\n\n// src/google-provider.ts\nfunction createGoogleGenerativeAI(options = {}) {\n  var _a, _b;\n  const baseURL = (_a = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.withoutTrailingSlash)(options.baseURL)) != null ? _a : \"https://generativelanguage.googleapis.com/v1beta\";\n  const providerName = (_b = options.name) != null ? _b : \"google.generative-ai\";\n  const getHeaders = () => (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.withUserAgentSuffix)(\n    {\n      \"x-goog-api-key\": (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.loadApiKey)({\n        apiKey: options.apiKey,\n        environmentVariableName: \"GOOGLE_GENERATIVE_AI_API_KEY\",\n        description: \"Google Generative AI\"\n      }),\n      ...options.headers\n    },\n    `ai-sdk/google/${VERSION}`\n  );\n  const createChatModel = (modelId) => {\n    var _a2;\n    return new GoogleGenerativeAILanguageModel(modelId, {\n      provider: providerName,\n      baseURL,\n      headers: getHeaders,\n      generateId: (_a2 = options.generateId) != null ? _a2 : _ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_0__.generateId,\n      supportedUrls: () => ({\n        \"*\": [\n          // Google Generative Language \"files\" endpoint\n          // e.g. https://generativelanguage.googleapis.com/v1beta/files/...\n          new RegExp(`^${baseURL}/files/.*$`),\n          // YouTube URLs (public or unlisted videos)\n          new RegExp(\n            `^https://(?:www\\\\.)?youtube\\\\.com/watch\\\\?v=[\\\\w-]+(?:&[\\\\w=&.-]*)?$`\n          ),\n          new RegExp(`^https://youtu\\\\.be/[\\\\w-]+(?:\\\\?[\\\\w=&.-]*)?$`)\n        ]\n      }),\n      fetch: options.fetch\n    });\n  };\n  const createEmbeddingModel = (modelId) => new GoogleGenerativeAIEmbeddingModel(modelId, {\n    provider: providerName,\n    baseURL,\n    headers: getHeaders,\n    fetch: options.fetch\n  });\n  const createImageModel = (modelId, settings = {}) => new GoogleGenerativeAIImageModel(modelId, settings, {\n    provider: providerName,\n    baseURL,\n    headers: getHeaders,\n    fetch: options.fetch\n  });\n  const provider = function(modelId) {\n    if (new.target) {\n      throw new Error(\n        \"The Google Generative AI model function cannot be called with the new keyword.\"\n      );\n    }\n    return createChatModel(modelId);\n  };\n  provider.specificationVersion = \"v3\";\n  provider.languageModel = createChatModel;\n  provider.chat = createChatModel;\n  provider.generativeAI = createChatModel;\n  provider.embedding = createEmbeddingModel;\n  provider.embeddingModel = createEmbeddingModel;\n  provider.textEmbedding = createEmbeddingModel;\n  provider.textEmbeddingModel = createEmbeddingModel;\n  provider.image = createImageModel;\n  provider.imageModel = createImageModel;\n  provider.tools = googleTools;\n  return provider;\n}\nvar google = createGoogleGenerativeAI();\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vQGFpLXNkaytnb29nbGVAMy4wLjEwX3pvZEAzLjI1Ljc2L25vZGVfbW9kdWxlcy9AYWktc2RrL2dvb2dsZS9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQU1nQzs7QUFFaEM7QUFDQSxjQUFjLEtBQUksY0FBYyxDQUFZOztBQUU1QztBQUcwQjtBQVNNO0FBQ0M7O0FBRWpDO0FBS2dDO0FBQ0w7QUFDM0IsNEJBQTRCLGtFQUFVO0FBQ3RDLFFBQVEsaUVBQVM7QUFDakIsSUFBSSwwQ0FBUTtBQUNaLGFBQWEsMENBQVE7QUFDckIsY0FBYywwQ0FBUTtBQUN0QixpQkFBaUIsMENBQVE7QUFDekIsZ0JBQWdCLDBDQUFRO0FBQ3hCLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLGtDQUFrQyxzRkFBOEI7QUFDaEU7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFJZ0M7QUFDQztBQUNqQyxpREFBaUQsa0VBQVc7QUFDNUQsUUFBUSxpRUFBVTtBQUNsQixJQUFJLDBDQUFTO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsMENBQVM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDJDQUFPO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsZ0NBQWdDLDRFQUFvQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxnQkFBZ0IsZ0ZBQWtDO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsMEJBQTBCLHNFQUFjO0FB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QUFDNUUsS0FBSztBQUNMO0FBQ0E7QUFDQSx1Q0FBdUMsa0VBQVk7QUFDbkQsUUFBUSxpRUFBVztBQUNuQixJQUFJLDBDQUFVO0FBQ2Qsd0JBQXdCLDJDQUFRO0FBQ2hDLG1CQUFtQiwyQ0FBUTtBQUMzQixLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBLDhDQUE4QztBQUM5QztBQUNBLHdCQUF3Qiw0RUFBb0I7QUFDNUM7QUFDQSwyQkFBMkIsMkVBQW1CO0FBQzlDO0FBQ0Esd0JBQXdCLGtFQUFVO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTCxxQkFBcUIsUUFBUTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCw4REFBVztBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixRQUFRO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsa0RBQWtEO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0U7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL21haG1vdWRtYWMvUHJvamVjdHMvYXV0b3NoaWVsZC1icmlsbGlhbmNlL25vZGVfbW9kdWxlcy8ucG5wbS9AYWktc2RrK2dvb2dsZUAzLjAuMTBfem9kQDMuMjUuNzYvbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ29vZ2xlL2Rpc3QvaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9nb29nbGUtcHJvdmlkZXIudHNcbmltcG9ydCB7XG4gIGdlbmVyYXRlSWQgYXMgZ2VuZXJhdGVJZDIsXG4gIGxvYWRBcGlLZXksXG4gIHdpdGhvdXRUcmFpbGluZ1NsYXNoLFxuICB3aXRoVXNlckFnZW50U3VmZml4XG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG5cbi8vIHNyYy92ZXJzaW9uLnRzXG52YXIgVkVSU0lPTiA9IHRydWUgPyBcIjMuMC4xMFwiIDogXCIwLjAuMC10ZXN0XCI7XG5cbi8vIHNyYy9nb29nbGUtZ2VuZXJhdGl2ZS1haS1lbWJlZGRpbmctbW9kZWwudHNcbmltcG9ydCB7XG4gIFRvb01hbnlFbWJlZGRpbmdWYWx1ZXNGb3JDYWxsRXJyb3Jcbn0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXJcIjtcbmltcG9ydCB7XG4gIGNvbWJpbmVIZWFkZXJzLFxuICBjcmVhdGVKc29uUmVzcG9uc2VIYW5kbGVyLFxuICBsYXp5U2NoZW1hIGFzIGxhenlTY2hlbWEzLFxuICBwYXJzZVByb3ZpZGVyT3B0aW9ucyxcbiAgcG9zdEpzb25Ub0FwaSxcbiAgcmVzb2x2ZSxcbiAgem9kU2NoZW1hIGFzIHpvZFNjaGVtYTNcbn0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXItdXRpbHNcIjtcbmltcG9ydCB7IHogYXMgejMgfSBmcm9tIFwiem9kL3Y0XCI7XG5cbi8vIHNyYy9nb29nbGUtZXJyb3IudHNcbmltcG9ydCB7XG4gIGNyZWF0ZUpzb25FcnJvclJlc3BvbnNlSGFuZGxlcixcbiAgbGF6eVNjaGVtYSxcbiAgem9kU2NoZW1hXG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG5pbXBvcnQgeyB6IH0gZnJvbSBcInpvZC92NFwiO1xudmFyIGdvb2dsZUVycm9yRGF0YVNjaGVtYSA9IGxhenlTY2hlbWEoXG4gICgpID0+IHpvZFNjaGVtYShcbiAgICB6Lm9iamVjdCh7XG4gICAgICBlcnJvcjogei5vYmplY3Qoe1xuICAgICAgICBjb2RlOiB6Lm51bWJlcigpLm51bGxhYmxlKCksXG4gICAgICAgIG1lc3NhZ2U6IHouc3RyaW5nKCksXG4gICAgICAgIHN0YXR1czogei5zdHJpbmcoKVxuICAgICAgfSlcbiAgICB9KVxuICApXG4pO1xudmFyIGdvb2dsZUZhaWxlZFJlc3BvbnNlSGFuZGxlciA9IGNyZWF0ZUpzb25FcnJvclJlc3BvbnNlSGFuZGxlcih7XG4gIGVycm9yU2NoZW1hOiBnb29nbGVFcnJvckRhdGFTY2hlbWEsXG4gIGVycm9yVG9NZXNzYWdlOiAoZGF0YSkgPT4gZGF0YS5lcnJvci5tZXNzYWdlXG59KTtcblxuLy8gc3JjL2dvb2dsZS1nZW5lcmF0aXZlLWFpLWVtYmVkZGluZy1vcHRpb25zLnRzXG5pbXBvcnQge1xuICBsYXp5U2NoZW1hIGFzIGxhenlTY2hlbWEyLFxuICB6b2RTY2hlbWEgYXMgem9kU2NoZW1hMlxufSBmcm9tIFwiQGFpLXNkay9wcm92aWRlci11dGlsc1wiO1xuaW1wb3J0IHsgeiBhcyB6MiB9IGZyb20gXCJ6b2QvdjRcIjtcbnZhciBnb29nbGVHZW5lcmF0aXZlQUlFbWJlZGRpbmdQcm92aWRlck9wdGlvbnMgPSBsYXp5U2NoZW1hMihcbiAgKCkgPT4gem9kU2NoZW1hMihcbiAgICB6Mi5vYmplY3Qoe1xuICAgICAgLyoqXG4gICAgICAgKiBPcHRpb25hbC4gT3B0aW9uYWwgcmVkdWNlZCBkaW1lbnNpb24gZm9yIHRoZSBvdXRwdXQgZW1iZWRkaW5nLlxuICAgICAgICogSWYgc2V0LCBleGNlc3NpdmUgdmFsdWVzIGluIHRoZSBvdXRwdXQgZW1iZWRkaW5nIGFyZSB0cnVuY2F0ZWQgZnJvbSB0aGUgZW5kLlxuICAgICAgICovXG4gICAgICBvdXRwdXREaW1lbnNpb25hbGl0eTogejIubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogT3B0aW9uYWwuIFNwZWNpZmllcyB0aGUgdGFzayB0eXBlIGZvciBnZW5lcmF0aW5nIGVtYmVkZGluZ3MuXG4gICAgICAgKiBTdXBwb3J0ZWQgdGFzayB0eXBlczpcbiAgICAgICAqIC0gU0VNQU5USUNfU0lNSUxBUklUWTogT3B0aW1pemVkIGZvciB0ZXh0IHNpbWlsYXJpdHkuXG4gICAgICAgKiAtIENMQVNTSUZJQ0FUSU9OOiBPcHRpbWl6ZWQgZm9yIHRleHQgY2xhc3NpZmljYXRpb24uXG4gICAgICAgKiAtIENMVVNURVJJTkc6IE9wdGltaXplZCBmb3IgY2x1c3RlcmluZyB0ZXh0cyBiYXNlZCBvbiBzaW1pbGFyaXR5LlxuICAgICAgICogLSBSRVRSSUVWQUxfRE9DVU1FTlQ6IE9wdGltaXplZCBmb3IgZG9jdW1lbnQgcmV0cmlldmFsLlxuICAgICAgICogLSBSRVRSSUVWQUxfUVVFUlk6IE9wdGltaXplZCBmb3IgcXVlcnktYmFzZWQgcmV0cmlldmFsLlxuICAgICAgICogLSBRVUVTVElPTl9BTlNXRVJJTkc6IE9wdGltaXplZCBmb3IgYW5zd2VyaW5nIHF1ZXN0aW9ucy5cbiAgICAgICAqIC0gRkFDVF9WRVJJRklDQVRJT046IE9wdGltaXplZCBmb3IgdmVyaWZ5aW5nIGZhY3R1YWwgaW5mb3JtYXRpb24uXG4gICAgICAgKiAtIENPREVfUkVUUklFVkFMX1FVRVJZOiBPcHRpbWl6ZWQgZm9yIHJldHJpZXZpbmcgY29kZSBibG9ja3MgYmFzZWQgb24gbmF0dXJhbCBsYW5ndWFnZSBxdWVyaWVzLlxuICAgICAgICovXG4gICAgICB0YXNrVHlwZTogejIuZW51bShbXG4gICAgICAgIFwiU0VNQU5USUNfU0lNSUxBUklUWVwiLFxuICAgICAgICBcIkNMQVNTSUZJQ0FUSU9OXCIsXG4gICAgICAgIFwiQ0xVU1RFUklOR1wiLFxuICAgICAgICBcIlJFVFJJRVZBTF9ET0NVTUVOVFwiLFxuICAgICAgICBcIlJFVFJJRVZBTF9RVUVSWVwiLFxuICAgICAgICBcIlFVRVNUSU9OX0FOU1dFUklOR1wiLFxuICAgICAgICBcIkZBQ1RfVkVSSUZJQ0FUSU9OXCIsXG4gICAgICAgIFwiQ09ERV9SRVRSSUVWQUxfUVVFUllcIlxuICAgICAgXSkub3B0aW9uYWwoKVxuICAgIH0pXG4gIClcbik7XG5cbi8vIHNyYy9nb29nbGUtZ2VuZXJhdGl2ZS1haS1lbWJlZGRpbmctbW9kZWwudHNcbnZhciBHb29nbGVHZW5lcmF0aXZlQUlFbWJlZGRpbmdNb2RlbCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IobW9kZWxJZCwgY29uZmlnKSB7XG4gICAgdGhpcy5zcGVjaWZpY2F0aW9uVmVyc2lvbiA9IFwidjNcIjtcbiAgICB0aGlzLm1heEVtYmVkZGluZ3NQZXJDYWxsID0gMjA0ODtcbiAgICB0aGlzLnN1cHBvcnRzUGFyYWxsZWxDYWxscyA9IHRydWU7XG4gICAgdGhpcy5tb2RlbElkID0gbW9kZWxJZDtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgfVxuICBnZXQgcHJvdmlkZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnLnByb3ZpZGVyO1xuICB9XG4gIGFzeW5jIGRvRW1iZWQoe1xuICAgIHZhbHVlcyxcbiAgICBoZWFkZXJzLFxuICAgIGFib3J0U2lnbmFsLFxuICAgIHByb3ZpZGVyT3B0aW9uc1xuICB9KSB7XG4gICAgY29uc3QgZ29vZ2xlT3B0aW9ucyA9IGF3YWl0IHBhcnNlUHJvdmlkZXJPcHRpb25zKHtcbiAgICAgIHByb3ZpZGVyOiBcImdvb2dsZVwiLFxuICAgICAgcHJvdmlkZXJPcHRpb25zLFxuICAgICAgc2NoZW1hOiBnb29nbGVHZW5lcmF0aXZlQUlFbWJlZGRpbmdQcm92aWRlck9wdGlvbnNcbiAgICB9KTtcbiAgICBpZiAodmFsdWVzLmxlbmd0aCA+IHRoaXMubWF4RW1iZWRkaW5nc1BlckNhbGwpIHtcbiAgICAgIHRocm93IG5ldyBUb29NYW55RW1iZWRkaW5nVmFsdWVzRm9yQ2FsbEVycm9yKHtcbiAgICAgICAgcHJvdmlkZXI6IHRoaXMucHJvdmlkZXIsXG4gICAgICAgIG1vZGVsSWQ6IHRoaXMubW9kZWxJZCxcbiAgICAgICAgbWF4RW1iZWRkaW5nc1BlckNhbGw6IHRoaXMubWF4RW1iZWRkaW5nc1BlckNhbGwsXG4gICAgICAgIHZhbHVlc1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IG1lcmdlZEhlYWRlcnMgPSBjb21iaW5lSGVhZGVycyhcbiAgICAgIGF3YWl0IHJlc29sdmUodGhpcy5jb25maWcuaGVhZGVycyksXG4gICAgICBoZWFkZXJzXG4gICAgKTtcbiAgICBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgY29uc3Qge1xuICAgICAgICByZXNwb25zZUhlYWRlcnM6IHJlc3BvbnNlSGVhZGVyczIsXG4gICAgICAgIHZhbHVlOiByZXNwb25zZTIsXG4gICAgICAgIHJhd1ZhbHVlOiByYXdWYWx1ZTJcbiAgICAgIH0gPSBhd2FpdCBwb3N0SnNvblRvQXBpKHtcbiAgICAgICAgdXJsOiBgJHt0aGlzLmNvbmZpZy5iYXNlVVJMfS9tb2RlbHMvJHt0aGlzLm1vZGVsSWR9OmVtYmVkQ29udGVudGAsXG4gICAgICAgIGhlYWRlcnM6IG1lcmdlZEhlYWRlcnMsXG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBtb2RlbDogYG1vZGVscy8ke3RoaXMubW9kZWxJZH1gLFxuICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgIHBhcnRzOiBbeyB0ZXh0OiB2YWx1ZXNbMF0gfV1cbiAgICAgICAgICB9LFxuICAgICAgICAgIG91dHB1dERpbWVuc2lvbmFsaXR5OiBnb29nbGVPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBnb29nbGVPcHRpb25zLm91dHB1dERpbWVuc2lvbmFsaXR5LFxuICAgICAgICAgIHRhc2tUeXBlOiBnb29nbGVPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBnb29nbGVPcHRpb25zLnRhc2tUeXBlXG4gICAgICAgIH0sXG4gICAgICAgIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogZ29vZ2xlRmFpbGVkUmVzcG9uc2VIYW5kbGVyLFxuICAgICAgICBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyOiBjcmVhdGVKc29uUmVzcG9uc2VIYW5kbGVyKFxuICAgICAgICAgIGdvb2dsZUdlbmVyYXRpdmVBSVNpbmdsZUVtYmVkZGluZ1Jlc3BvbnNlU2NoZW1hXG4gICAgICAgICksXG4gICAgICAgIGFib3J0U2lnbmFsLFxuICAgICAgICBmZXRjaDogdGhpcy5jb25maWcuZmV0Y2hcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgd2FybmluZ3M6IFtdLFxuICAgICAgICBlbWJlZGRpbmdzOiBbcmVzcG9uc2UyLmVtYmVkZGluZy52YWx1ZXNdLFxuICAgICAgICB1c2FnZTogdm9pZCAwLFxuICAgICAgICByZXNwb25zZTogeyBoZWFkZXJzOiByZXNwb25zZUhlYWRlcnMyLCBib2R5OiByYXdWYWx1ZTIgfVxuICAgICAgfTtcbiAgICB9XG4gICAgY29uc3Qge1xuICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgdmFsdWU6IHJlc3BvbnNlLFxuICAgICAgcmF3VmFsdWVcbiAgICB9ID0gYXdhaXQgcG9zdEpzb25Ub0FwaSh7XG4gICAgICB1cmw6IGAke3RoaXMuY29uZmlnLmJhc2VVUkx9L21vZGVscy8ke3RoaXMubW9kZWxJZH06YmF0Y2hFbWJlZENvbnRlbnRzYCxcbiAgICAgIGhlYWRlcnM6IG1lcmdlZEhlYWRlcnMsXG4gICAgICBib2R5OiB7XG4gICAgICAgIHJlcXVlc3RzOiB2YWx1ZXMubWFwKCh2YWx1ZSkgPT4gKHtcbiAgICAgICAgICBtb2RlbDogYG1vZGVscy8ke3RoaXMubW9kZWxJZH1gLFxuICAgICAgICAgIGNvbnRlbnQ6IHsgcm9sZTogXCJ1c2VyXCIsIHBhcnRzOiBbeyB0ZXh0OiB2YWx1ZSB9XSB9LFxuICAgICAgICAgIG91dHB1dERpbWVuc2lvbmFsaXR5OiBnb29nbGVPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBnb29nbGVPcHRpb25zLm91dHB1dERpbWVuc2lvbmFsaXR5LFxuICAgICAgICAgIHRhc2tUeXBlOiBnb29nbGVPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBnb29nbGVPcHRpb25zLnRhc2tUeXBlXG4gICAgICAgIH0pKVxuICAgICAgfSxcbiAgICAgIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogZ29vZ2xlRmFpbGVkUmVzcG9uc2VIYW5kbGVyLFxuICAgICAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlcihcbiAgICAgICAgZ29vZ2xlR2VuZXJhdGl2ZUFJVGV4dEVtYmVkZGluZ1Jlc3BvbnNlU2NoZW1hXG4gICAgICApLFxuICAgICAgYWJvcnRTaWduYWwsXG4gICAgICBmZXRjaDogdGhpcy5jb25maWcuZmV0Y2hcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgd2FybmluZ3M6IFtdLFxuICAgICAgZW1iZWRkaW5nczogcmVzcG9uc2UuZW1iZWRkaW5ncy5tYXAoKGl0ZW0pID0+IGl0ZW0udmFsdWVzKSxcbiAgICAgIHVzYWdlOiB2b2lkIDAsXG4gICAgICByZXNwb25zZTogeyBoZWFkZXJzOiByZXNwb25zZUhlYWRlcnMsIGJvZHk6IHJhd1ZhbHVlIH1cbiAgICB9O1xuICB9XG59O1xudmFyIGdvb2dsZUdlbmVyYXRpdmVBSVRleHRFbWJlZGRpbmdSZXNwb25zZVNjaGVtYSA9IGxhenlTY2hlbWEzKFxuICAoKSA9PiB6b2RTY2hlbWEzKFxuICAgIHozLm9iamVjdCh7XG4gICAgICBlbWJlZGRpbmdzOiB6My5hcnJheSh6My5vYmplY3QoeyB2YWx1ZXM6IHozLmFycmF5KHozLm51bWJlcigpKSB9KSlcbiAgICB9KVxuICApXG4pO1xudmFyIGdvb2dsZUdlbmVyYXRpdmVBSVNpbmdsZUVtYmVkZGluZ1Jlc3BvbnNlU2NoZW1hID0gbGF6eVNjaGVtYTMoXG4gICgpID0+IHpvZFNjaGVtYTMoXG4gICAgejMub2JqZWN0KHtcbiAgICAgIGVtYmVkZGluZzogejMub2JqZWN0KHsgdmFsdWVzOiB6My5hcnJheSh6My5udW1iZXIoKSkgfSlcbiAgICB9KVxuICApXG4pO1xuXG4vLyBzcmMvZ29vZ2xlLWdlbmVyYXRpdmUtYWktbGFuZ3VhZ2UtbW9kZWwudHNcbmltcG9ydCB7XG4gIGNvbWJpbmVIZWFkZXJzIGFzIGNvbWJpbmVIZWFkZXJzMixcbiAgY3JlYXRlRXZlbnRTb3VyY2VSZXNwb25zZUhhbmRsZXIsXG4gIGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIgYXMgY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlcjIsXG4gIGdlbmVyYXRlSWQsXG4gIGxhenlTY2hlbWEgYXMgbGF6eVNjaGVtYTUsXG4gIHBhcnNlUHJvdmlkZXJPcHRpb25zIGFzIHBhcnNlUHJvdmlkZXJPcHRpb25zMixcbiAgcG9zdEpzb25Ub0FwaSBhcyBwb3N0SnNvblRvQXBpMixcbiAgcmVzb2x2ZSBhcyByZXNvbHZlMixcbiAgem9kU2NoZW1hIGFzIHpvZFNjaGVtYTVcbn0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXItdXRpbHNcIjtcbmltcG9ydCB7IHogYXMgejUgfSBmcm9tIFwiem9kL3Y0XCI7XG5cbi8vIHNyYy9jb252ZXJ0LWdvb2dsZS1nZW5lcmF0aXZlLWFpLXVzYWdlLnRzXG5mdW5jdGlvbiBjb252ZXJ0R29vZ2xlR2VuZXJhdGl2ZUFJVXNhZ2UodXNhZ2UpIHtcbiAgdmFyIF9hLCBfYiwgX2MsIF9kO1xuICBpZiAodXNhZ2UgPT0gbnVsbCkge1xuICAgIHJldHVybiB7XG4gICAgICBpbnB1dFRva2Vuczoge1xuICAgICAgICB0b3RhbDogdm9pZCAwLFxuICAgICAgICBub0NhY2hlOiB2b2lkIDAsXG4gICAgICAgIGNhY2hlUmVhZDogdm9pZCAwLFxuICAgICAgICBjYWNoZVdyaXRlOiB2b2lkIDBcbiAgICAgIH0sXG4gICAgICBvdXRwdXRUb2tlbnM6IHtcbiAgICAgICAgdG90YWw6IHZvaWQgMCxcbiAgICAgICAgdGV4dDogdm9pZCAwLFxuICAgICAgICByZWFzb25pbmc6IHZvaWQgMFxuICAgICAgfSxcbiAgICAgIHJhdzogdm9pZCAwXG4gICAgfTtcbiAgfVxuICBjb25zdCBwcm9tcHRUb2tlbnMgPSAoX2EgPSB1c2FnZS5wcm9tcHRUb2tlbkNvdW50KSAhPSBudWxsID8gX2EgOiAwO1xuICBjb25zdCBjYW5kaWRhdGVzVG9rZW5zID0gKF9iID0gdXNhZ2UuY2FuZGlkYXRlc1Rva2VuQ291bnQpICE9IG51bGwgPyBfYiA6IDA7XG4gIGNvbnN0IGNhY2hlZENvbnRlbnRUb2tlbnMgPSAoX2MgPSB1c2FnZS5jYWNoZWRDb250ZW50VG9rZW5Db3VudCkgIT0gbnVsbCA/IF9jIDogMDtcbiAgY29uc3QgdGhvdWdodHNUb2tlbnMgPSAoX2QgPSB1c2FnZS50aG91Z2h0c1Rva2VuQ291bnQpICE9IG51bGwgPyBfZCA6IDA7XG4gIHJldHVybiB7XG4gICAgaW5wdXRUb2tlbnM6IHtcbiAgICAgIHRvdGFsOiBwcm9tcHRUb2tlbnMsXG4gICAgICBub0NhY2hlOiBwcm9tcHRUb2tlbnMgLSBjYWNoZWRDb250ZW50VG9rZW5zLFxuICAgICAgY2FjaGVSZWFkOiBjYWNoZWRDb250ZW50VG9rZW5zLFxuICAgICAgY2FjaGVXcml0ZTogdm9pZCAwXG4gICAgfSxcbiAgICBvdXRwdXRUb2tlbnM6IHtcbiAgICAgIHRvdGFsOiBjYW5kaWRhdGVzVG9rZW5zICsgdGhvdWdodHNUb2tlbnMsXG4gICAgICB0ZXh0OiBjYW5kaWRhdGVzVG9rZW5zLFxuICAgICAgcmVhc29uaW5nOiB0aG91Z2h0c1Rva2Vuc1xuICAgIH0sXG4gICAgcmF3OiB1c2FnZVxuICB9O1xufVxuXG4vLyBzcmMvY29udmVydC1qc29uLXNjaGVtYS10by1vcGVuYXBpLXNjaGVtYS50c1xuZnVuY3Rpb24gY29udmVydEpTT05TY2hlbWFUb09wZW5BUElTY2hlbWEoanNvblNjaGVtYSwgaXNSb290ID0gdHJ1ZSkge1xuICBpZiAoanNvblNjaGVtYSA9PSBudWxsKSB7XG4gICAgcmV0dXJuIHZvaWQgMDtcbiAgfVxuICBpZiAoaXNFbXB0eU9iamVjdFNjaGVtYShqc29uU2NoZW1hKSkge1xuICAgIGlmIChpc1Jvb3QpIHtcbiAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfVxuICAgIGlmICh0eXBlb2YganNvblNjaGVtYSA9PT0gXCJvYmplY3RcIiAmJiBqc29uU2NoZW1hLmRlc2NyaXB0aW9uKSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBcIm9iamVjdFwiLCBkZXNjcmlwdGlvbjoganNvblNjaGVtYS5kZXNjcmlwdGlvbiB9O1xuICAgIH1cbiAgICByZXR1cm4geyB0eXBlOiBcIm9iamVjdFwiIH07XG4gIH1cbiAgaWYgKHR5cGVvZiBqc29uU2NoZW1hID09PSBcImJvb2xlYW5cIikge1xuICAgIHJldHVybiB7IHR5cGU6IFwiYm9vbGVhblwiLCBwcm9wZXJ0aWVzOiB7fSB9O1xuICB9XG4gIGNvbnN0IHtcbiAgICB0eXBlLFxuICAgIGRlc2NyaXB0aW9uLFxuICAgIHJlcXVpcmVkLFxuICAgIHByb3BlcnRpZXMsXG4gICAgaXRlbXMsXG4gICAgYWxsT2YsXG4gICAgYW55T2YsXG4gICAgb25lT2YsXG4gICAgZm9ybWF0LFxuICAgIGNvbnN0OiBjb25zdFZhbHVlLFxuICAgIG1pbkxlbmd0aCxcbiAgICBlbnVtOiBlbnVtVmFsdWVzXG4gIH0gPSBqc29uU2NoZW1hO1xuICBjb25zdCByZXN1bHQgPSB7fTtcbiAgaWYgKGRlc2NyaXB0aW9uKSByZXN1bHQuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgaWYgKHJlcXVpcmVkKSByZXN1bHQucmVxdWlyZWQgPSByZXF1aXJlZDtcbiAgaWYgKGZvcm1hdCkgcmVzdWx0LmZvcm1hdCA9IGZvcm1hdDtcbiAgaWYgKGNvbnN0VmFsdWUgIT09IHZvaWQgMCkge1xuICAgIHJlc3VsdC5lbnVtID0gW2NvbnN0VmFsdWVdO1xuICB9XG4gIGlmICh0eXBlKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodHlwZSkpIHtcbiAgICAgIGNvbnN0IGhhc051bGwgPSB0eXBlLmluY2x1ZGVzKFwibnVsbFwiKTtcbiAgICAgIGNvbnN0IG5vbk51bGxUeXBlcyA9IHR5cGUuZmlsdGVyKCh0KSA9PiB0ICE9PSBcIm51bGxcIik7XG4gICAgICBpZiAobm9uTnVsbFR5cGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXN1bHQudHlwZSA9IFwibnVsbFwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0LmFueU9mID0gbm9uTnVsbFR5cGVzLm1hcCgodCkgPT4gKHsgdHlwZTogdCB9KSk7XG4gICAgICAgIGlmIChoYXNOdWxsKSB7XG4gICAgICAgICAgcmVzdWx0Lm51bGxhYmxlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQudHlwZSA9IHR5cGU7XG4gICAgfVxuICB9XG4gIGlmIChlbnVtVmFsdWVzICE9PSB2b2lkIDApIHtcbiAgICByZXN1bHQuZW51bSA9IGVudW1WYWx1ZXM7XG4gIH1cbiAgaWYgKHByb3BlcnRpZXMgIT0gbnVsbCkge1xuICAgIHJlc3VsdC5wcm9wZXJ0aWVzID0gT2JqZWN0LmVudHJpZXMocHJvcGVydGllcykucmVkdWNlKFxuICAgICAgKGFjYywgW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgIGFjY1trZXldID0gY29udmVydEpTT05TY2hlbWFUb09wZW5BUElTY2hlbWEodmFsdWUsIGZhbHNlKTtcbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sXG4gICAgICB7fVxuICAgICk7XG4gIH1cbiAgaWYgKGl0ZW1zKSB7XG4gICAgcmVzdWx0Lml0ZW1zID0gQXJyYXkuaXNBcnJheShpdGVtcykgPyBpdGVtcy5tYXAoKGl0ZW0pID0+IGNvbnZlcnRKU09OU2NoZW1hVG9PcGVuQVBJU2NoZW1hKGl0ZW0sIGZhbHNlKSkgOiBjb252ZXJ0SlNPTlNjaGVtYVRvT3BlbkFQSVNjaGVtYShpdGVtcywgZmFsc2UpO1xuICB9XG4gIGlmIChhbGxPZikge1xuICAgIHJlc3VsdC5hbGxPZiA9IGFsbE9mLm1hcChcbiAgICAgIChpdGVtKSA9PiBjb252ZXJ0SlNPTlNjaGVtYVRvT3BlbkFQSVNjaGVtYShpdGVtLCBmYWxzZSlcbiAgICApO1xuICB9XG4gIGlmIChhbnlPZikge1xuICAgIGlmIChhbnlPZi5zb21lKFxuICAgICAgKHNjaGVtYSkgPT4gdHlwZW9mIHNjaGVtYSA9PT0gXCJvYmplY3RcIiAmJiAoc2NoZW1hID09IG51bGwgPyB2b2lkIDAgOiBzY2hlbWEudHlwZSkgPT09IFwibnVsbFwiXG4gICAgKSkge1xuICAgICAgY29uc3Qgbm9uTnVsbFNjaGVtYXMgPSBhbnlPZi5maWx0ZXIoXG4gICAgICAgIChzY2hlbWEpID0+ICEodHlwZW9mIHNjaGVtYSA9PT0gXCJvYmplY3RcIiAmJiAoc2NoZW1hID09IG51bGwgPyB2b2lkIDAgOiBzY2hlbWEudHlwZSkgPT09IFwibnVsbFwiKVxuICAgICAgKTtcbiAgICAgIGlmIChub25OdWxsU2NoZW1hcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgY29uc3QgY29udmVydGVkID0gY29udmVydEpTT05TY2hlbWFUb09wZW5BUElTY2hlbWEoXG4gICAgICAgICAgbm9uTnVsbFNjaGVtYXNbMF0sXG4gICAgICAgICAgZmFsc2VcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKHR5cGVvZiBjb252ZXJ0ZWQgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICByZXN1bHQubnVsbGFibGUgPSB0cnVlO1xuICAgICAgICAgIE9iamVjdC5hc3NpZ24ocmVzdWx0LCBjb252ZXJ0ZWQpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQuYW55T2YgPSBub25OdWxsU2NoZW1hcy5tYXAoXG4gICAgICAgICAgKGl0ZW0pID0+IGNvbnZlcnRKU09OU2NoZW1hVG9PcGVuQVBJU2NoZW1hKGl0ZW0sIGZhbHNlKVxuICAgICAgICApO1xuICAgICAgICByZXN1bHQubnVsbGFibGUgPSB0cnVlO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQuYW55T2YgPSBhbnlPZi5tYXAoXG4gICAgICAgIChpdGVtKSA9PiBjb252ZXJ0SlNPTlNjaGVtYVRvT3BlbkFQSVNjaGVtYShpdGVtLCBmYWxzZSlcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIGlmIChvbmVPZikge1xuICAgIHJlc3VsdC5vbmVPZiA9IG9uZU9mLm1hcChcbiAgICAgIChpdGVtKSA9PiBjb252ZXJ0SlNPTlNjaGVtYVRvT3BlbkFQSVNjaGVtYShpdGVtLCBmYWxzZSlcbiAgICApO1xuICB9XG4gIGlmIChtaW5MZW5ndGggIT09IHZvaWQgMCkge1xuICAgIHJlc3VsdC5taW5MZW5ndGggPSBtaW5MZW5ndGg7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGlzRW1wdHlPYmplY3RTY2hlbWEoanNvblNjaGVtYSkge1xuICByZXR1cm4ganNvblNjaGVtYSAhPSBudWxsICYmIHR5cGVvZiBqc29uU2NoZW1hID09PSBcIm9iamVjdFwiICYmIGpzb25TY2hlbWEudHlwZSA9PT0gXCJvYmplY3RcIiAmJiAoanNvblNjaGVtYS5wcm9wZXJ0aWVzID09IG51bGwgfHwgT2JqZWN0LmtleXMoanNvblNjaGVtYS5wcm9wZXJ0aWVzKS5sZW5ndGggPT09IDApICYmICFqc29uU2NoZW1hLmFkZGl0aW9uYWxQcm9wZXJ0aWVzO1xufVxuXG4vLyBzcmMvY29udmVydC10by1nb29nbGUtZ2VuZXJhdGl2ZS1haS1tZXNzYWdlcy50c1xuaW1wb3J0IHtcbiAgVW5zdXBwb3J0ZWRGdW5jdGlvbmFsaXR5RXJyb3Jcbn0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXJcIjtcbmltcG9ydCB7IGNvbnZlcnRUb0Jhc2U2NCB9IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG5mdW5jdGlvbiBjb252ZXJ0VG9Hb29nbGVHZW5lcmF0aXZlQUlNZXNzYWdlcyhwcm9tcHQsIG9wdGlvbnMpIHtcbiAgdmFyIF9hLCBfYiwgX2M7XG4gIGNvbnN0IHN5c3RlbUluc3RydWN0aW9uUGFydHMgPSBbXTtcbiAgY29uc3QgY29udGVudHMgPSBbXTtcbiAgbGV0IHN5c3RlbU1lc3NhZ2VzQWxsb3dlZCA9IHRydWU7XG4gIGNvbnN0IGlzR2VtbWFNb2RlbCA9IChfYSA9IG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMuaXNHZW1tYU1vZGVsKSAhPSBudWxsID8gX2EgOiBmYWxzZTtcbiAgY29uc3QgcHJvdmlkZXJPcHRpb25zTmFtZSA9IChfYiA9IG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMucHJvdmlkZXJPcHRpb25zTmFtZSkgIT0gbnVsbCA/IF9iIDogXCJnb29nbGVcIjtcbiAgZm9yIChjb25zdCB7IHJvbGUsIGNvbnRlbnQgfSBvZiBwcm9tcHQpIHtcbiAgICBzd2l0Y2ggKHJvbGUpIHtcbiAgICAgIGNhc2UgXCJzeXN0ZW1cIjoge1xuICAgICAgICBpZiAoIXN5c3RlbU1lc3NhZ2VzQWxsb3dlZCkge1xuICAgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvcih7XG4gICAgICAgICAgICBmdW5jdGlvbmFsaXR5OiBcInN5c3RlbSBtZXNzYWdlcyBhcmUgb25seSBzdXBwb3J0ZWQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgY29udmVyc2F0aW9uXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBzeXN0ZW1JbnN0cnVjdGlvblBhcnRzLnB1c2goeyB0ZXh0OiBjb250ZW50IH0pO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJ1c2VyXCI6IHtcbiAgICAgICAgc3lzdGVtTWVzc2FnZXNBbGxvd2VkID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHBhcnRzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBjb250ZW50KSB7XG4gICAgICAgICAgc3dpdGNoIChwYXJ0LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJ0ZXh0XCI6IHtcbiAgICAgICAgICAgICAgcGFydHMucHVzaCh7IHRleHQ6IHBhcnQudGV4dCB9KTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFwiZmlsZVwiOiB7XG4gICAgICAgICAgICAgIGNvbnN0IG1lZGlhVHlwZSA9IHBhcnQubWVkaWFUeXBlID09PSBcImltYWdlLypcIiA/IFwiaW1hZ2UvanBlZ1wiIDogcGFydC5tZWRpYVR5cGU7XG4gICAgICAgICAgICAgIHBhcnRzLnB1c2goXG4gICAgICAgICAgICAgICAgcGFydC5kYXRhIGluc3RhbmNlb2YgVVJMID8ge1xuICAgICAgICAgICAgICAgICAgZmlsZURhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgbWltZVR5cGU6IG1lZGlhVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZmlsZVVyaTogcGFydC5kYXRhLnRvU3RyaW5nKClcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IDoge1xuICAgICAgICAgICAgICAgICAgaW5saW5lRGF0YToge1xuICAgICAgICAgICAgICAgICAgICBtaW1lVHlwZTogbWVkaWFUeXBlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBjb252ZXJ0VG9CYXNlNjQocGFydC5kYXRhKVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnRlbnRzLnB1c2goeyByb2xlOiBcInVzZXJcIiwgcGFydHMgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSBcImFzc2lzdGFudFwiOiB7XG4gICAgICAgIHN5c3RlbU1lc3NhZ2VzQWxsb3dlZCA9IGZhbHNlO1xuICAgICAgICBjb250ZW50cy5wdXNoKHtcbiAgICAgICAgICByb2xlOiBcIm1vZGVsXCIsXG4gICAgICAgICAgcGFydHM6IGNvbnRlbnQubWFwKChwYXJ0KSA9PiB7XG4gICAgICAgICAgICB2YXIgX2EyO1xuICAgICAgICAgICAgY29uc3QgcHJvdmlkZXJPcHRzID0gKF9hMiA9IHBhcnQucHJvdmlkZXJPcHRpb25zKSA9PSBudWxsID8gdm9pZCAwIDogX2EyW3Byb3ZpZGVyT3B0aW9uc05hbWVdO1xuICAgICAgICAgICAgY29uc3QgdGhvdWdodFNpZ25hdHVyZSA9IChwcm92aWRlck9wdHMgPT0gbnVsbCA/IHZvaWQgMCA6IHByb3ZpZGVyT3B0cy50aG91Z2h0U2lnbmF0dXJlKSAhPSBudWxsID8gU3RyaW5nKHByb3ZpZGVyT3B0cy50aG91Z2h0U2lnbmF0dXJlKSA6IHZvaWQgMDtcbiAgICAgICAgICAgIHN3aXRjaCAocGFydC50eXBlKSB7XG4gICAgICAgICAgICAgIGNhc2UgXCJ0ZXh0XCI6IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFydC50ZXh0Lmxlbmd0aCA9PT0gMCA/IHZvaWQgMCA6IHtcbiAgICAgICAgICAgICAgICAgIHRleHQ6IHBhcnQudGV4dCxcbiAgICAgICAgICAgICAgICAgIHRob3VnaHRTaWduYXR1cmVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNhc2UgXCJyZWFzb25pbmdcIjoge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJ0LnRleHQubGVuZ3RoID09PSAwID8gdm9pZCAwIDoge1xuICAgICAgICAgICAgICAgICAgdGV4dDogcGFydC50ZXh0LFxuICAgICAgICAgICAgICAgICAgdGhvdWdodDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIHRob3VnaHRTaWduYXR1cmVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNhc2UgXCJmaWxlXCI6IHtcbiAgICAgICAgICAgICAgICBpZiAocGFydC5kYXRhIGluc3RhbmNlb2YgVVJMKSB7XG4gICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRGdW5jdGlvbmFsaXR5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbmFsaXR5OiBcIkZpbGUgZGF0YSBVUkxzIGluIGFzc2lzdGFudCBtZXNzYWdlcyBhcmUgbm90IHN1cHBvcnRlZFwiXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIGlubGluZURhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgbWltZVR5cGU6IHBhcnQubWVkaWFUeXBlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBjb252ZXJ0VG9CYXNlNjQocGFydC5kYXRhKVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHRob3VnaHRTaWduYXR1cmVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNhc2UgXCJ0b29sLWNhbGxcIjoge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICBmdW5jdGlvbkNhbGw6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogcGFydC50b29sTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgYXJnczogcGFydC5pbnB1dFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHRob3VnaHRTaWduYXR1cmVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkuZmlsdGVyKChwYXJ0KSA9PiBwYXJ0ICE9PSB2b2lkIDApXG4gICAgICAgIH0pO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJ0b29sXCI6IHtcbiAgICAgICAgc3lzdGVtTWVzc2FnZXNBbGxvd2VkID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHBhcnRzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBjb250ZW50KSB7XG4gICAgICAgICAgaWYgKHBhcnQudHlwZSA9PT0gXCJ0b29sLWFwcHJvdmFsLXJlc3BvbnNlXCIpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBvdXRwdXQgPSBwYXJ0Lm91dHB1dDtcbiAgICAgICAgICBpZiAob3V0cHV0LnR5cGUgPT09IFwiY29udGVudFwiKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNvbnRlbnRQYXJ0IG9mIG91dHB1dC52YWx1ZSkge1xuICAgICAgICAgICAgICBzd2l0Y2ggKGNvbnRlbnRQYXJ0LnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwidGV4dFwiOlxuICAgICAgICAgICAgICAgICAgcGFydHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uUmVzcG9uc2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBwYXJ0LnRvb2xOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBwYXJ0LnRvb2xOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogY29udGVudFBhcnQudGV4dFxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiaW1hZ2UtZGF0YVwiOlxuICAgICAgICAgICAgICAgICAgcGFydHMucHVzaChcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgIGlubGluZURhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbWVUeXBlOiBjb250ZW50UGFydC5tZWRpYVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBjb250ZW50UGFydC5kYXRhXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJUb29sIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseSBhbmQgcmV0dXJuZWQgdGhpcyBpbWFnZSBhcyBhIHJlc3BvbnNlXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICBwYXJ0cy5wdXNoKHsgdGV4dDogSlNPTi5zdHJpbmdpZnkoY29udGVudFBhcnQpIH0pO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGFydHMucHVzaCh7XG4gICAgICAgICAgICAgIGZ1bmN0aW9uUmVzcG9uc2U6IHtcbiAgICAgICAgICAgICAgICBuYW1lOiBwYXJ0LnRvb2xOYW1lLFxuICAgICAgICAgICAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgICAgICAgICAgICBuYW1lOiBwYXJ0LnRvb2xOYW1lLFxuICAgICAgICAgICAgICAgICAgY29udGVudDogb3V0cHV0LnR5cGUgPT09IFwiZXhlY3V0aW9uLWRlbmllZFwiID8gKF9jID0gb3V0cHV0LnJlYXNvbikgIT0gbnVsbCA/IF9jIDogXCJUb29sIGV4ZWN1dGlvbiBkZW5pZWQuXCIgOiBvdXRwdXQudmFsdWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb250ZW50cy5wdXNoKHtcbiAgICAgICAgICByb2xlOiBcInVzZXJcIixcbiAgICAgICAgICBwYXJ0c1xuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChpc0dlbW1hTW9kZWwgJiYgc3lzdGVtSW5zdHJ1Y3Rpb25QYXJ0cy5sZW5ndGggPiAwICYmIGNvbnRlbnRzLmxlbmd0aCA+IDAgJiYgY29udGVudHNbMF0ucm9sZSA9PT0gXCJ1c2VyXCIpIHtcbiAgICBjb25zdCBzeXN0ZW1UZXh0ID0gc3lzdGVtSW5zdHJ1Y3Rpb25QYXJ0cy5tYXAoKHBhcnQpID0+IHBhcnQudGV4dCkuam9pbihcIlxcblxcblwiKTtcbiAgICBjb250ZW50c1swXS5wYXJ0cy51bnNoaWZ0KHsgdGV4dDogc3lzdGVtVGV4dCArIFwiXFxuXFxuXCIgfSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBzeXN0ZW1JbnN0cnVjdGlvbjogc3lzdGVtSW5zdHJ1Y3Rpb25QYXJ0cy5sZW5ndGggPiAwICYmICFpc0dlbW1hTW9kZWwgPyB7IHBhcnRzOiBzeXN0ZW1JbnN0cnVjdGlvblBhcnRzIH0gOiB2b2lkIDAsXG4gICAgY29udGVudHNcbiAgfTtcbn1cblxuLy8gc3JjL2dldC1tb2RlbC1wYXRoLnRzXG5mdW5jdGlvbiBnZXRNb2RlbFBhdGgobW9kZWxJZCkge1xuICByZXR1cm4gbW9kZWxJZC5pbmNsdWRlcyhcIi9cIikgPyBtb2RlbElkIDogYG1vZGVscy8ke21vZGVsSWR9YDtcbn1cblxuLy8gc3JjL2dvb2dsZS1nZW5lcmF0aXZlLWFpLW9wdGlvbnMudHNcbmltcG9ydCB7IGxhenlTY2hlbWEgYXMgbGF6eVNjaGVtYTQsIHpvZFNjaGVtYSBhcyB6b2RTY2hlbWE0IH0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXItdXRpbHNcIjtcbmltcG9ydCB7IHogYXMgejQgfSBmcm9tIFwiem9kL3Y0XCI7XG52YXIgZ29vZ2xlR2VuZXJhdGl2ZUFJUHJvdmlkZXJPcHRpb25zID0gbGF6eVNjaGVtYTQoXG4gICgpID0+IHpvZFNjaGVtYTQoXG4gICAgejQub2JqZWN0KHtcbiAgICAgIHJlc3BvbnNlTW9kYWxpdGllczogejQuYXJyYXkoejQuZW51bShbXCJURVhUXCIsIFwiSU1BR0VcIl0pKS5vcHRpb25hbCgpLFxuICAgICAgdGhpbmtpbmdDb25maWc6IHo0Lm9iamVjdCh7XG4gICAgICAgIHRoaW5raW5nQnVkZ2V0OiB6NC5udW1iZXIoKS5vcHRpb25hbCgpLFxuICAgICAgICBpbmNsdWRlVGhvdWdodHM6IHo0LmJvb2xlYW4oKS5vcHRpb25hbCgpLFxuICAgICAgICAvLyBodHRwczovL2FpLmdvb2dsZS5kZXYvZ2VtaW5pLWFwaS9kb2NzL2dlbWluaS0zP3RoaW5raW5nPWhpZ2gjdGhpbmtpbmdfbGV2ZWxcbiAgICAgICAgdGhpbmtpbmdMZXZlbDogejQuZW51bShbXCJtaW5pbWFsXCIsIFwibG93XCIsIFwibWVkaXVtXCIsIFwiaGlnaFwiXSkub3B0aW9uYWwoKVxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogT3B0aW9uYWwuXG4gICAgICAgKiBUaGUgbmFtZSBvZiB0aGUgY2FjaGVkIGNvbnRlbnQgdXNlZCBhcyBjb250ZXh0IHRvIHNlcnZlIHRoZSBwcmVkaWN0aW9uLlxuICAgICAgICogRm9ybWF0OiBjYWNoZWRDb250ZW50cy97Y2FjaGVkQ29udGVudH1cbiAgICAgICAqL1xuICAgICAgY2FjaGVkQ29udGVudDogejQuc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogT3B0aW9uYWwuIEVuYWJsZSBzdHJ1Y3R1cmVkIG91dHB1dC4gRGVmYXVsdCBpcyB0cnVlLlxuICAgICAgICpcbiAgICAgICAqIFRoaXMgaXMgdXNlZnVsIHdoZW4gdGhlIEpTT04gU2NoZW1hIGNvbnRhaW5zIGVsZW1lbnRzIHRoYXQgYXJlXG4gICAgICAgKiBub3Qgc3VwcG9ydGVkIGJ5IHRoZSBPcGVuQVBJIHNjaGVtYSB2ZXJzaW9uIHRoYXRcbiAgICAgICAqIEdvb2dsZSBHZW5lcmF0aXZlIEFJIHVzZXMuIFlvdSBjYW4gdXNlIHRoaXMgdG8gZGlzYWJsZVxuICAgICAgICogc3RydWN0dXJlZCBvdXRwdXRzIGlmIHlvdSBuZWVkIHRvLlxuICAgICAgICovXG4gICAgICBzdHJ1Y3R1cmVkT3V0cHV0czogejQuYm9vbGVhbigpLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIE9wdGlvbmFsLiBBIGxpc3Qgb2YgdW5pcXVlIHNhZmV0eSBzZXR0aW5ncyBmb3IgYmxvY2tpbmcgdW5zYWZlIGNvbnRlbnQuXG4gICAgICAgKi9cbiAgICAgIHNhZmV0eVNldHRpbmdzOiB6NC5hcnJheShcbiAgICAgICAgejQub2JqZWN0KHtcbiAgICAgICAgICBjYXRlZ29yeTogejQuZW51bShbXG4gICAgICAgICAgICBcIkhBUk1fQ0FURUdPUllfVU5TUEVDSUZJRURcIixcbiAgICAgICAgICAgIFwiSEFSTV9DQVRFR09SWV9IQVRFX1NQRUVDSFwiLFxuICAgICAgICAgICAgXCJIQVJNX0NBVEVHT1JZX0RBTkdFUk9VU19DT05URU5UXCIsXG4gICAgICAgICAgICBcIkhBUk1fQ0FURUdPUllfSEFSQVNTTUVOVFwiLFxuICAgICAgICAgICAgXCJIQVJNX0NBVEVHT1JZX1NFWFVBTExZX0VYUExJQ0lUXCIsXG4gICAgICAgICAgICBcIkhBUk1fQ0FURUdPUllfQ0lWSUNfSU5URUdSSVRZXCJcbiAgICAgICAgICBdKSxcbiAgICAgICAgICB0aHJlc2hvbGQ6IHo0LmVudW0oW1xuICAgICAgICAgICAgXCJIQVJNX0JMT0NLX1RIUkVTSE9MRF9VTlNQRUNJRklFRFwiLFxuICAgICAgICAgICAgXCJCTE9DS19MT1dfQU5EX0FCT1ZFXCIsXG4gICAgICAgICAgICBcIkJMT0NLX01FRElVTV9BTkRfQUJPVkVcIixcbiAgICAgICAgICAgIFwiQkxPQ0tfT05MWV9ISUdIXCIsXG4gICAgICAgICAgICBcIkJMT0NLX05PTkVcIixcbiAgICAgICAgICAgIFwiT0ZGXCJcbiAgICAgICAgICBdKVxuICAgICAgICB9KVxuICAgICAgKS5vcHRpb25hbCgpLFxuICAgICAgdGhyZXNob2xkOiB6NC5lbnVtKFtcbiAgICAgICAgXCJIQVJNX0JMT0NLX1RIUkVTSE9MRF9VTlNQRUNJRklFRFwiLFxuICAgICAgICBcIkJMT0NLX0xPV19BTkRfQUJPVkVcIixcbiAgICAgICAgXCJCTE9DS19NRURJVU1fQU5EX0FCT1ZFXCIsXG4gICAgICAgIFwiQkxPQ0tfT05MWV9ISUdIXCIsXG4gICAgICAgIFwiQkxPQ0tfTk9ORVwiLFxuICAgICAgICBcIk9GRlwiXG4gICAgICBdKS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBPcHRpb25hbC4gRW5hYmxlcyB0aW1lc3RhbXAgdW5kZXJzdGFuZGluZyBmb3IgYXVkaW8tb25seSBmaWxlcy5cbiAgICAgICAqXG4gICAgICAgKiBodHRwczovL2Nsb3VkLmdvb2dsZS5jb20vdmVydGV4LWFpL2dlbmVyYXRpdmUtYWkvZG9jcy9tdWx0aW1vZGFsL2F1ZGlvLXVuZGVyc3RhbmRpbmdcbiAgICAgICAqL1xuICAgICAgYXVkaW9UaW1lc3RhbXA6IHo0LmJvb2xlYW4oKS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBPcHRpb25hbC4gRGVmaW5lcyBsYWJlbHMgdXNlZCBpbiBiaWxsaW5nIHJlcG9ydHMuIEF2YWlsYWJsZSBvbiBWZXJ0ZXggQUkgb25seS5cbiAgICAgICAqXG4gICAgICAgKiBodHRwczovL2Nsb3VkLmdvb2dsZS5jb20vdmVydGV4LWFpL2dlbmVyYXRpdmUtYWkvZG9jcy9tdWx0aW1vZGFsL2FkZC1sYWJlbHMtdG8tYXBpLWNhbGxzXG4gICAgICAgKi9cbiAgICAgIGxhYmVsczogejQucmVjb3JkKHo0LnN0cmluZygpLCB6NC5zdHJpbmcoKSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogT3B0aW9uYWwuIElmIHNwZWNpZmllZCwgdGhlIG1lZGlhIHJlc29sdXRpb24gc3BlY2lmaWVkIHdpbGwgYmUgdXNlZC5cbiAgICAgICAqXG4gICAgICAgKiBodHRwczovL2FpLmdvb2dsZS5kZXYvYXBpL2dlbmVyYXRlLWNvbnRlbnQjTWVkaWFSZXNvbHV0aW9uXG4gICAgICAgKi9cbiAgICAgIG1lZGlhUmVzb2x1dGlvbjogejQuZW51bShbXG4gICAgICAgIFwiTUVESUFfUkVTT0xVVElPTl9VTlNQRUNJRklFRFwiLFxuICAgICAgICBcIk1FRElBX1JFU09MVVRJT05fTE9XXCIsXG4gICAgICAgIFwiTUVESUFfUkVTT0xVVElPTl9NRURJVU1cIixcbiAgICAgICAgXCJNRURJQV9SRVNPTFVUSU9OX0hJR0hcIlxuICAgICAgXSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogT3B0aW9uYWwuIENvbmZpZ3VyZXMgdGhlIGltYWdlIGdlbmVyYXRpb24gYXNwZWN0IHJhdGlvIGZvciBHZW1pbmkgbW9kZWxzLlxuICAgICAgICpcbiAgICAgICAqIGh0dHBzOi8vYWkuZ29vZ2xlLmRldi9nZW1pbmktYXBpL2RvY3MvaW1hZ2UtZ2VuZXJhdGlvbiNhc3BlY3RfcmF0aW9zXG4gICAgICAgKi9cbiAgICAgIGltYWdlQ29uZmlnOiB6NC5vYmplY3Qoe1xuICAgICAgICBhc3BlY3RSYXRpbzogejQuZW51bShbXG4gICAgICAgICAgXCIxOjFcIixcbiAgICAgICAgICBcIjI6M1wiLFxuICAgICAgICAgIFwiMzoyXCIsXG4gICAgICAgICAgXCIzOjRcIixcbiAgICAgICAgICBcIjQ6M1wiLFxuICAgICAgICAgIFwiNDo1XCIsXG4gICAgICAgICAgXCI1OjRcIixcbiAgICAgICAgICBcIjk6MTZcIixcbiAgICAgICAgICBcIjE2OjlcIixcbiAgICAgICAgICBcIjIxOjlcIlxuICAgICAgICBdKS5vcHRpb25hbCgpLFxuICAgICAgICBpbWFnZVNpemU6IHo0LmVudW0oW1wiMUtcIiwgXCIyS1wiLCBcIjRLXCJdKS5vcHRpb25hbCgpXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBPcHRpb25hbC4gQ29uZmlndXJhdGlvbiBmb3IgZ3JvdW5kaW5nIHJldHJpZXZhbC5cbiAgICAgICAqIFVzZWQgdG8gcHJvdmlkZSBsb2NhdGlvbiBjb250ZXh0IGZvciBHb29nbGUgTWFwcyBhbmQgR29vZ2xlIFNlYXJjaCBncm91bmRpbmcuXG4gICAgICAgKlxuICAgICAgICogaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL3ZlcnRleC1haS9nZW5lcmF0aXZlLWFpL2RvY3MvZ3JvdW5kaW5nL2dyb3VuZGluZy13aXRoLWdvb2dsZS1tYXBzXG4gICAgICAgKi9cbiAgICAgIHJldHJpZXZhbENvbmZpZzogejQub2JqZWN0KHtcbiAgICAgICAgbGF0TG5nOiB6NC5vYmplY3Qoe1xuICAgICAgICAgIGxhdGl0dWRlOiB6NC5udW1iZXIoKSxcbiAgICAgICAgICBsb25naXR1ZGU6IHo0Lm51bWJlcigpXG4gICAgICAgIH0pLm9wdGlvbmFsKClcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KVxuICApXG4pO1xuXG4vLyBzcmMvZ29vZ2xlLXByZXBhcmUtdG9vbHMudHNcbmltcG9ydCB7XG4gIFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yIGFzIFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yMlxufSBmcm9tIFwiQGFpLXNkay9wcm92aWRlclwiO1xuZnVuY3Rpb24gcHJlcGFyZVRvb2xzKHtcbiAgdG9vbHMsXG4gIHRvb2xDaG9pY2UsXG4gIG1vZGVsSWRcbn0pIHtcbiAgdmFyIF9hO1xuICB0b29scyA9ICh0b29scyA9PSBudWxsID8gdm9pZCAwIDogdG9vbHMubGVuZ3RoKSA/IHRvb2xzIDogdm9pZCAwO1xuICBjb25zdCB0b29sV2FybmluZ3MgPSBbXTtcbiAgY29uc3QgaXNMYXRlc3QgPSBbXG4gICAgXCJnZW1pbmktZmxhc2gtbGF0ZXN0XCIsXG4gICAgXCJnZW1pbmktZmxhc2gtbGl0ZS1sYXRlc3RcIixcbiAgICBcImdlbWluaS1wcm8tbGF0ZXN0XCJcbiAgXS5zb21lKChpZCkgPT4gaWQgPT09IG1vZGVsSWQpO1xuICBjb25zdCBpc0dlbWluaTJvck5ld2VyID0gbW9kZWxJZC5pbmNsdWRlcyhcImdlbWluaS0yXCIpIHx8IG1vZGVsSWQuaW5jbHVkZXMoXCJnZW1pbmktM1wiKSB8fCBpc0xhdGVzdDtcbiAgY29uc3Qgc3VwcG9ydHNEeW5hbWljUmV0cmlldmFsID0gbW9kZWxJZC5pbmNsdWRlcyhcImdlbWluaS0xLjUtZmxhc2hcIikgJiYgIW1vZGVsSWQuaW5jbHVkZXMoXCItOGJcIik7XG4gIGNvbnN0IHN1cHBvcnRzRmlsZVNlYXJjaCA9IG1vZGVsSWQuaW5jbHVkZXMoXCJnZW1pbmktMi41XCIpIHx8IG1vZGVsSWQuaW5jbHVkZXMoXCJnZW1pbmktM1wiKTtcbiAgaWYgKHRvb2xzID09IG51bGwpIHtcbiAgICByZXR1cm4geyB0b29sczogdm9pZCAwLCB0b29sQ29uZmlnOiB2b2lkIDAsIHRvb2xXYXJuaW5ncyB9O1xuICB9XG4gIGNvbnN0IGhhc0Z1bmN0aW9uVG9vbHMgPSB0b29scy5zb21lKCh0b29sKSA9PiB0b29sLnR5cGUgPT09IFwiZnVuY3Rpb25cIik7XG4gIGNvbnN0IGhhc1Byb3ZpZGVyVG9vbHMgPSB0b29scy5zb21lKCh0b29sKSA9PiB0b29sLnR5cGUgPT09IFwicHJvdmlkZXJcIik7XG4gIGlmIChoYXNGdW5jdGlvblRvb2xzICYmIGhhc1Byb3ZpZGVyVG9vbHMpIHtcbiAgICB0b29sV2FybmluZ3MucHVzaCh7XG4gICAgICB0eXBlOiBcInVuc3VwcG9ydGVkXCIsXG4gICAgICBmZWF0dXJlOiBgY29tYmluYXRpb24gb2YgZnVuY3Rpb24gYW5kIHByb3ZpZGVyLWRlZmluZWQgdG9vbHNgXG4gICAgfSk7XG4gIH1cbiAgaWYgKGhhc1Byb3ZpZGVyVG9vbHMpIHtcbiAgICBjb25zdCBnb29nbGVUb29sczIgPSBbXTtcbiAgICBjb25zdCBQcm92aWRlclRvb2xzID0gdG9vbHMuZmlsdGVyKCh0b29sKSA9PiB0b29sLnR5cGUgPT09IFwicHJvdmlkZXJcIik7XG4gICAgUHJvdmlkZXJUb29scy5mb3JFYWNoKCh0b29sKSA9PiB7XG4gICAgICBzd2l0Y2ggKHRvb2wuaWQpIHtcbiAgICAgICAgY2FzZSBcImdvb2dsZS5nb29nbGVfc2VhcmNoXCI6XG4gICAgICAgICAgaWYgKGlzR2VtaW5pMm9yTmV3ZXIpIHtcbiAgICAgICAgICAgIGdvb2dsZVRvb2xzMi5wdXNoKHsgZ29vZ2xlU2VhcmNoOiB7fSB9KTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHN1cHBvcnRzRHluYW1pY1JldHJpZXZhbCkge1xuICAgICAgICAgICAgZ29vZ2xlVG9vbHMyLnB1c2goe1xuICAgICAgICAgICAgICBnb29nbGVTZWFyY2hSZXRyaWV2YWw6IHtcbiAgICAgICAgICAgICAgICBkeW5hbWljUmV0cmlldmFsQ29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICBtb2RlOiB0b29sLmFyZ3MubW9kZSxcbiAgICAgICAgICAgICAgICAgIGR5bmFtaWNUaHJlc2hvbGQ6IHRvb2wuYXJncy5keW5hbWljVGhyZXNob2xkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ29vZ2xlVG9vbHMyLnB1c2goeyBnb29nbGVTZWFyY2hSZXRyaWV2YWw6IHt9IH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImdvb2dsZS5lbnRlcnByaXNlX3dlYl9zZWFyY2hcIjpcbiAgICAgICAgICBpZiAoaXNHZW1pbmkyb3JOZXdlcikge1xuICAgICAgICAgICAgZ29vZ2xlVG9vbHMyLnB1c2goeyBlbnRlcnByaXNlV2ViU2VhcmNoOiB7fSB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdG9vbFdhcm5pbmdzLnB1c2goe1xuICAgICAgICAgICAgICB0eXBlOiBcInVuc3VwcG9ydGVkXCIsXG4gICAgICAgICAgICAgIGZlYXR1cmU6IGBwcm92aWRlci1kZWZpbmVkIHRvb2wgJHt0b29sLmlkfWAsXG4gICAgICAgICAgICAgIGRldGFpbHM6IFwiRW50ZXJwcmlzZSBXZWIgU2VhcmNoIHJlcXVpcmVzIEdlbWluaSAyLjAgb3IgbmV3ZXIuXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImdvb2dsZS51cmxfY29udGV4dFwiOlxuICAgICAgICAgIGlmIChpc0dlbWluaTJvck5ld2VyKSB7XG4gICAgICAgICAgICBnb29nbGVUb29sczIucHVzaCh7IHVybENvbnRleHQ6IHt9IH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0b29sV2FybmluZ3MucHVzaCh7XG4gICAgICAgICAgICAgIHR5cGU6IFwidW5zdXBwb3J0ZWRcIixcbiAgICAgICAgICAgICAgZmVhdHVyZTogYHByb3ZpZGVyLWRlZmluZWQgdG9vbCAke3Rvb2wuaWR9YCxcbiAgICAgICAgICAgICAgZGV0YWlsczogXCJUaGUgVVJMIGNvbnRleHQgdG9vbCBpcyBub3Qgc3VwcG9ydGVkIHdpdGggb3RoZXIgR2VtaW5pIG1vZGVscyB0aGFuIEdlbWluaSAyLlwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJnb29nbGUuY29kZV9leGVjdXRpb25cIjpcbiAgICAgICAgICBpZiAoaXNHZW1pbmkyb3JOZXdlcikge1xuICAgICAgICAgICAgZ29vZ2xlVG9vbHMyLnB1c2goeyBjb2RlRXhlY3V0aW9uOiB7fSB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdG9vbFdhcm5pbmdzLnB1c2goe1xuICAgICAgICAgICAgICB0eXBlOiBcInVuc3VwcG9ydGVkXCIsXG4gICAgICAgICAgICAgIGZlYXR1cmU6IGBwcm92aWRlci1kZWZpbmVkIHRvb2wgJHt0b29sLmlkfWAsXG4gICAgICAgICAgICAgIGRldGFpbHM6IFwiVGhlIGNvZGUgZXhlY3V0aW9uIHRvb2xzIGlzIG5vdCBzdXBwb3J0ZWQgd2l0aCBvdGhlciBHZW1pbmkgbW9kZWxzIHRoYW4gR2VtaW5pIDIuXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImdvb2dsZS5maWxlX3NlYXJjaFwiOlxuICAgICAgICAgIGlmIChzdXBwb3J0c0ZpbGVTZWFyY2gpIHtcbiAgICAgICAgICAgIGdvb2dsZVRvb2xzMi5wdXNoKHsgZmlsZVNlYXJjaDogeyAuLi50b29sLmFyZ3MgfSB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdG9vbFdhcm5pbmdzLnB1c2goe1xuICAgICAgICAgICAgICB0eXBlOiBcInVuc3VwcG9ydGVkXCIsXG4gICAgICAgICAgICAgIGZlYXR1cmU6IGBwcm92aWRlci1kZWZpbmVkIHRvb2wgJHt0b29sLmlkfWAsXG4gICAgICAgICAgICAgIGRldGFpbHM6IFwiVGhlIGZpbGUgc2VhcmNoIHRvb2wgaXMgb25seSBzdXBwb3J0ZWQgd2l0aCBHZW1pbmkgMi41IG1vZGVscyBhbmQgR2VtaW5pIDMgbW9kZWxzLlwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJnb29nbGUudmVydGV4X3JhZ19zdG9yZVwiOlxuICAgICAgICAgIGlmIChpc0dlbWluaTJvck5ld2VyKSB7XG4gICAgICAgICAgICBnb29nbGVUb29sczIucHVzaCh7XG4gICAgICAgICAgICAgIHJldHJpZXZhbDoge1xuICAgICAgICAgICAgICAgIHZlcnRleF9yYWdfc3RvcmU6IHtcbiAgICAgICAgICAgICAgICAgIHJhZ19yZXNvdXJjZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgcmFnX2NvcnB1czogdG9vbC5hcmdzLnJhZ0NvcnB1c1xuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHNpbWlsYXJpdHlfdG9wX2s6IHRvb2wuYXJncy50b3BLXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdG9vbFdhcm5pbmdzLnB1c2goe1xuICAgICAgICAgICAgICB0eXBlOiBcInVuc3VwcG9ydGVkXCIsXG4gICAgICAgICAgICAgIGZlYXR1cmU6IGBwcm92aWRlci1kZWZpbmVkIHRvb2wgJHt0b29sLmlkfWAsXG4gICAgICAgICAgICAgIGRldGFpbHM6IFwiVGhlIFJBRyBzdG9yZSB0b29sIGlzIG5vdCBzdXBwb3J0ZWQgd2l0aCBvdGhlciBHZW1pbmkgbW9kZWxzIHRoYW4gR2VtaW5pIDIuXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImdvb2dsZS5nb29nbGVfbWFwc1wiOlxuICAgICAgICAgIGlmIChpc0dlbWluaTJvck5ld2VyKSB7XG4gICAgICAgICAgICBnb29nbGVUb29sczIucHVzaCh7IGdvb2dsZU1hcHM6IHt9IH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0b29sV2FybmluZ3MucHVzaCh7XG4gICAgICAgICAgICAgIHR5cGU6IFwidW5zdXBwb3J0ZWRcIixcbiAgICAgICAgICAgICAgZmVhdHVyZTogYHByb3ZpZGVyLWRlZmluZWQgdG9vbCAke3Rvb2wuaWR9YCxcbiAgICAgICAgICAgICAgZGV0YWlsczogXCJUaGUgR29vZ2xlIE1hcHMgZ3JvdW5kaW5nIHRvb2wgaXMgbm90IHN1cHBvcnRlZCB3aXRoIEdlbWluaSBtb2RlbHMgb3RoZXIgdGhhbiBHZW1pbmkgMiBvciBuZXdlci5cIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRvb2xXYXJuaW5ncy5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6IFwidW5zdXBwb3J0ZWRcIixcbiAgICAgICAgICAgIGZlYXR1cmU6IGBwcm92aWRlci1kZWZpbmVkIHRvb2wgJHt0b29sLmlkfWBcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgdG9vbHM6IGdvb2dsZVRvb2xzMi5sZW5ndGggPiAwID8gZ29vZ2xlVG9vbHMyIDogdm9pZCAwLFxuICAgICAgdG9vbENvbmZpZzogdm9pZCAwLFxuICAgICAgdG9vbFdhcm5pbmdzXG4gICAgfTtcbiAgfVxuICBjb25zdCBmdW5jdGlvbkRlY2xhcmF0aW9ucyA9IFtdO1xuICBmb3IgKGNvbnN0IHRvb2wgb2YgdG9vbHMpIHtcbiAgICBzd2l0Y2ggKHRvb2wudHlwZSkge1xuICAgICAgY2FzZSBcImZ1bmN0aW9uXCI6XG4gICAgICAgIGZ1bmN0aW9uRGVjbGFyYXRpb25zLnB1c2goe1xuICAgICAgICAgIG5hbWU6IHRvb2wubmFtZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogKF9hID0gdG9vbC5kZXNjcmlwdGlvbikgIT0gbnVsbCA/IF9hIDogXCJcIixcbiAgICAgICAgICBwYXJhbWV0ZXJzOiBjb252ZXJ0SlNPTlNjaGVtYVRvT3BlbkFQSVNjaGVtYSh0b29sLmlucHV0U2NoZW1hKVxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0b29sV2FybmluZ3MucHVzaCh7XG4gICAgICAgICAgdHlwZTogXCJ1bnN1cHBvcnRlZFwiLFxuICAgICAgICAgIGZlYXR1cmU6IGBmdW5jdGlvbiB0b29sICR7dG9vbC5uYW1lfWBcbiAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICBpZiAodG9vbENob2ljZSA9PSBudWxsKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRvb2xzOiBbeyBmdW5jdGlvbkRlY2xhcmF0aW9ucyB9XSxcbiAgICAgIHRvb2xDb25maWc6IHZvaWQgMCxcbiAgICAgIHRvb2xXYXJuaW5nc1xuICAgIH07XG4gIH1cbiAgY29uc3QgdHlwZSA9IHRvb2xDaG9pY2UudHlwZTtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSBcImF1dG9cIjpcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvb2xzOiBbeyBmdW5jdGlvbkRlY2xhcmF0aW9ucyB9XSxcbiAgICAgICAgdG9vbENvbmZpZzogeyBmdW5jdGlvbkNhbGxpbmdDb25maWc6IHsgbW9kZTogXCJBVVRPXCIgfSB9LFxuICAgICAgICB0b29sV2FybmluZ3NcbiAgICAgIH07XG4gICAgY2FzZSBcIm5vbmVcIjpcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvb2xzOiBbeyBmdW5jdGlvbkRlY2xhcmF0aW9ucyB9XSxcbiAgICAgICAgdG9vbENvbmZpZzogeyBmdW5jdGlvbkNhbGxpbmdDb25maWc6IHsgbW9kZTogXCJOT05FXCIgfSB9LFxuICAgICAgICB0b29sV2FybmluZ3NcbiAgICAgIH07XG4gICAgY2FzZSBcInJlcXVpcmVkXCI6XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b29sczogW3sgZnVuY3Rpb25EZWNsYXJhdGlvbnMgfV0sXG4gICAgICAgIHRvb2xDb25maWc6IHsgZnVuY3Rpb25DYWxsaW5nQ29uZmlnOiB7IG1vZGU6IFwiQU5ZXCIgfSB9LFxuICAgICAgICB0b29sV2FybmluZ3NcbiAgICAgIH07XG4gICAgY2FzZSBcInRvb2xcIjpcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvb2xzOiBbeyBmdW5jdGlvbkRlY2xhcmF0aW9ucyB9XSxcbiAgICAgICAgdG9vbENvbmZpZzoge1xuICAgICAgICAgIGZ1bmN0aW9uQ2FsbGluZ0NvbmZpZzoge1xuICAgICAgICAgICAgbW9kZTogXCJBTllcIixcbiAgICAgICAgICAgIGFsbG93ZWRGdW5jdGlvbk5hbWVzOiBbdG9vbENob2ljZS50b29sTmFtZV1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRvb2xXYXJuaW5nc1xuICAgICAgfTtcbiAgICBkZWZhdWx0OiB7XG4gICAgICBjb25zdCBfZXhoYXVzdGl2ZUNoZWNrID0gdHlwZTtcbiAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvcjIoe1xuICAgICAgICBmdW5jdGlvbmFsaXR5OiBgdG9vbCBjaG9pY2UgdHlwZTogJHtfZXhoYXVzdGl2ZUNoZWNrfWBcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuXG4vLyBzcmMvbWFwLWdvb2dsZS1nZW5lcmF0aXZlLWFpLWZpbmlzaC1yZWFzb24udHNcbmZ1bmN0aW9uIG1hcEdvb2dsZUdlbmVyYXRpdmVBSUZpbmlzaFJlYXNvbih7XG4gIGZpbmlzaFJlYXNvbixcbiAgaGFzVG9vbENhbGxzXG59KSB7XG4gIHN3aXRjaCAoZmluaXNoUmVhc29uKSB7XG4gICAgY2FzZSBcIlNUT1BcIjpcbiAgICAgIHJldHVybiBoYXNUb29sQ2FsbHMgPyBcInRvb2wtY2FsbHNcIiA6IFwic3RvcFwiO1xuICAgIGNhc2UgXCJNQVhfVE9LRU5TXCI6XG4gICAgICByZXR1cm4gXCJsZW5ndGhcIjtcbiAgICBjYXNlIFwiSU1BR0VfU0FGRVRZXCI6XG4gICAgY2FzZSBcIlJFQ0lUQVRJT05cIjpcbiAgICBjYXNlIFwiU0FGRVRZXCI6XG4gICAgY2FzZSBcIkJMT0NLTElTVFwiOlxuICAgIGNhc2UgXCJQUk9ISUJJVEVEX0NPTlRFTlRcIjpcbiAgICBjYXNlIFwiU1BJSVwiOlxuICAgICAgcmV0dXJuIFwiY29udGVudC1maWx0ZXJcIjtcbiAgICBjYXNlIFwiTUFMRk9STUVEX0ZVTkNUSU9OX0NBTExcIjpcbiAgICAgIHJldHVybiBcImVycm9yXCI7XG4gICAgY2FzZSBcIkZJTklTSF9SRUFTT05fVU5TUEVDSUZJRURcIjpcbiAgICBjYXNlIFwiT1RIRVJcIjpcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIFwib3RoZXJcIjtcbiAgfVxufVxuXG4vLyBzcmMvZ29vZ2xlLWdlbmVyYXRpdmUtYWktbGFuZ3VhZ2UtbW9kZWwudHNcbnZhciBHb29nbGVHZW5lcmF0aXZlQUlMYW5ndWFnZU1vZGVsID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihtb2RlbElkLCBjb25maWcpIHtcbiAgICB0aGlzLnNwZWNpZmljYXRpb25WZXJzaW9uID0gXCJ2M1wiO1xuICAgIHZhciBfYTtcbiAgICB0aGlzLm1vZGVsSWQgPSBtb2RlbElkO1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMuZ2VuZXJhdGVJZCA9IChfYSA9IGNvbmZpZy5nZW5lcmF0ZUlkKSAhPSBudWxsID8gX2EgOiBnZW5lcmF0ZUlkO1xuICB9XG4gIGdldCBwcm92aWRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWcucHJvdmlkZXI7XG4gIH1cbiAgZ2V0IHN1cHBvcnRlZFVybHMoKSB7XG4gICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgcmV0dXJuIChfYyA9IChfYiA9IChfYSA9IHRoaXMuY29uZmlnKS5zdXBwb3J0ZWRVcmxzKSA9PSBudWxsID8gdm9pZCAwIDogX2IuY2FsbChfYSkpICE9IG51bGwgPyBfYyA6IHt9O1xuICB9XG4gIGFzeW5jIGdldEFyZ3Moe1xuICAgIHByb21wdCxcbiAgICBtYXhPdXRwdXRUb2tlbnMsXG4gICAgdGVtcGVyYXR1cmUsXG4gICAgdG9wUCxcbiAgICB0b3BLLFxuICAgIGZyZXF1ZW5jeVBlbmFsdHksXG4gICAgcHJlc2VuY2VQZW5hbHR5LFxuICAgIHN0b3BTZXF1ZW5jZXMsXG4gICAgcmVzcG9uc2VGb3JtYXQsXG4gICAgc2VlZCxcbiAgICB0b29scyxcbiAgICB0b29sQ2hvaWNlLFxuICAgIHByb3ZpZGVyT3B0aW9uc1xuICB9KSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IHdhcm5pbmdzID0gW107XG4gICAgY29uc3QgcHJvdmlkZXJPcHRpb25zTmFtZSA9IHRoaXMuY29uZmlnLnByb3ZpZGVyLmluY2x1ZGVzKFwidmVydGV4XCIpID8gXCJ2ZXJ0ZXhcIiA6IFwiZ29vZ2xlXCI7XG4gICAgbGV0IGdvb2dsZU9wdGlvbnMgPSBhd2FpdCBwYXJzZVByb3ZpZGVyT3B0aW9uczIoe1xuICAgICAgcHJvdmlkZXI6IHByb3ZpZGVyT3B0aW9uc05hbWUsXG4gICAgICBwcm92aWRlck9wdGlvbnMsXG4gICAgICBzY2hlbWE6IGdvb2dsZUdlbmVyYXRpdmVBSVByb3ZpZGVyT3B0aW9uc1xuICAgIH0pO1xuICAgIGlmIChnb29nbGVPcHRpb25zID09IG51bGwgJiYgcHJvdmlkZXJPcHRpb25zTmFtZSAhPT0gXCJnb29nbGVcIikge1xuICAgICAgZ29vZ2xlT3B0aW9ucyA9IGF3YWl0IHBhcnNlUHJvdmlkZXJPcHRpb25zMih7XG4gICAgICAgIHByb3ZpZGVyOiBcImdvb2dsZVwiLFxuICAgICAgICBwcm92aWRlck9wdGlvbnMsXG4gICAgICAgIHNjaGVtYTogZ29vZ2xlR2VuZXJhdGl2ZUFJUHJvdmlkZXJPcHRpb25zXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCh0b29scyA9PSBudWxsID8gdm9pZCAwIDogdG9vbHMuc29tZShcbiAgICAgICh0b29sKSA9PiB0b29sLnR5cGUgPT09IFwicHJvdmlkZXJcIiAmJiB0b29sLmlkID09PSBcImdvb2dsZS52ZXJ0ZXhfcmFnX3N0b3JlXCJcbiAgICApKSAmJiAhdGhpcy5jb25maWcucHJvdmlkZXIuc3RhcnRzV2l0aChcImdvb2dsZS52ZXJ0ZXguXCIpKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKHtcbiAgICAgICAgdHlwZTogXCJvdGhlclwiLFxuICAgICAgICBtZXNzYWdlOiBgVGhlICd2ZXJ0ZXhfcmFnX3N0b3JlJyB0b29sIGlzIG9ubHkgc3VwcG9ydGVkIHdpdGggdGhlIEdvb2dsZSBWZXJ0ZXggcHJvdmlkZXIgYW5kIG1pZ2h0IG5vdCBiZSBzdXBwb3J0ZWQgb3IgY291bGQgYmVoYXZlIHVuZXhwZWN0ZWRseSB3aXRoIHRoZSBjdXJyZW50IEdvb2dsZSBwcm92aWRlciAoJHt0aGlzLmNvbmZpZy5wcm92aWRlcn0pLmBcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBpc0dlbW1hTW9kZWwgPSB0aGlzLm1vZGVsSWQudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKFwiZ2VtbWEtXCIpO1xuICAgIGNvbnN0IHsgY29udGVudHMsIHN5c3RlbUluc3RydWN0aW9uIH0gPSBjb252ZXJ0VG9Hb29nbGVHZW5lcmF0aXZlQUlNZXNzYWdlcyhcbiAgICAgIHByb21wdCxcbiAgICAgIHsgaXNHZW1tYU1vZGVsLCBwcm92aWRlck9wdGlvbnNOYW1lIH1cbiAgICApO1xuICAgIGNvbnN0IHtcbiAgICAgIHRvb2xzOiBnb29nbGVUb29sczIsXG4gICAgICB0b29sQ29uZmlnOiBnb29nbGVUb29sQ29uZmlnLFxuICAgICAgdG9vbFdhcm5pbmdzXG4gICAgfSA9IHByZXBhcmVUb29scyh7XG4gICAgICB0b29scyxcbiAgICAgIHRvb2xDaG9pY2UsXG4gICAgICBtb2RlbElkOiB0aGlzLm1vZGVsSWRcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgYXJnczoge1xuICAgICAgICBnZW5lcmF0aW9uQ29uZmlnOiB7XG4gICAgICAgICAgLy8gc3RhbmRhcmRpemVkIHNldHRpbmdzOlxuICAgICAgICAgIG1heE91dHB1dFRva2VucyxcbiAgICAgICAgICB0ZW1wZXJhdHVyZSxcbiAgICAgICAgICB0b3BLLFxuICAgICAgICAgIHRvcFAsXG4gICAgICAgICAgZnJlcXVlbmN5UGVuYWx0eSxcbiAgICAgICAgICBwcmVzZW5jZVBlbmFsdHksXG4gICAgICAgICAgc3RvcFNlcXVlbmNlcyxcbiAgICAgICAgICBzZWVkLFxuICAgICAgICAgIC8vIHJlc3BvbnNlIGZvcm1hdDpcbiAgICAgICAgICByZXNwb25zZU1pbWVUeXBlOiAocmVzcG9uc2VGb3JtYXQgPT0gbnVsbCA/IHZvaWQgMCA6IHJlc3BvbnNlRm9ybWF0LnR5cGUpID09PSBcImpzb25cIiA/IFwiYXBwbGljYXRpb24vanNvblwiIDogdm9pZCAwLFxuICAgICAgICAgIHJlc3BvbnNlU2NoZW1hOiAocmVzcG9uc2VGb3JtYXQgPT0gbnVsbCA/IHZvaWQgMCA6IHJlc3BvbnNlRm9ybWF0LnR5cGUpID09PSBcImpzb25cIiAmJiByZXNwb25zZUZvcm1hdC5zY2hlbWEgIT0gbnVsbCAmJiAvLyBHb29nbGUgR2VuQUkgZG9lcyBub3Qgc3VwcG9ydCBhbGwgT3BlbkFQSSBTY2hlbWEgZmVhdHVyZXMsXG4gICAgICAgICAgLy8gc28gdGhpcyBpcyBuZWVkZWQgYXMgYW4gZXNjYXBlIGhhdGNoOlxuICAgICAgICAgIC8vIFRPRE8gY29udmVydCBpbnRvIHByb3ZpZGVyIG9wdGlvblxuICAgICAgICAgICgoX2EgPSBnb29nbGVPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBnb29nbGVPcHRpb25zLnN0cnVjdHVyZWRPdXRwdXRzKSAhPSBudWxsID8gX2EgOiB0cnVlKSA/IGNvbnZlcnRKU09OU2NoZW1hVG9PcGVuQVBJU2NoZW1hKHJlc3BvbnNlRm9ybWF0LnNjaGVtYSkgOiB2b2lkIDAsXG4gICAgICAgICAgLi4uKGdvb2dsZU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGdvb2dsZU9wdGlvbnMuYXVkaW9UaW1lc3RhbXApICYmIHtcbiAgICAgICAgICAgIGF1ZGlvVGltZXN0YW1wOiBnb29nbGVPcHRpb25zLmF1ZGlvVGltZXN0YW1wXG4gICAgICAgICAgfSxcbiAgICAgICAgICAvLyBwcm92aWRlciBvcHRpb25zOlxuICAgICAgICAgIHJlc3BvbnNlTW9kYWxpdGllczogZ29vZ2xlT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZ29vZ2xlT3B0aW9ucy5yZXNwb25zZU1vZGFsaXRpZXMsXG4gICAgICAgICAgdGhpbmtpbmdDb25maWc6IGdvb2dsZU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGdvb2dsZU9wdGlvbnMudGhpbmtpbmdDb25maWcsXG4gICAgICAgICAgLi4uKGdvb2dsZU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGdvb2dsZU9wdGlvbnMubWVkaWFSZXNvbHV0aW9uKSAmJiB7XG4gICAgICAgICAgICBtZWRpYVJlc29sdXRpb246IGdvb2dsZU9wdGlvbnMubWVkaWFSZXNvbHV0aW9uXG4gICAgICAgICAgfSxcbiAgICAgICAgICAuLi4oZ29vZ2xlT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZ29vZ2xlT3B0aW9ucy5pbWFnZUNvbmZpZykgJiYge1xuICAgICAgICAgICAgaW1hZ2VDb25maWc6IGdvb2dsZU9wdGlvbnMuaW1hZ2VDb25maWdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNvbnRlbnRzLFxuICAgICAgICBzeXN0ZW1JbnN0cnVjdGlvbjogaXNHZW1tYU1vZGVsID8gdm9pZCAwIDogc3lzdGVtSW5zdHJ1Y3Rpb24sXG4gICAgICAgIHNhZmV0eVNldHRpbmdzOiBnb29nbGVPcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBnb29nbGVPcHRpb25zLnNhZmV0eVNldHRpbmdzLFxuICAgICAgICB0b29sczogZ29vZ2xlVG9vbHMyLFxuICAgICAgICB0b29sQ29uZmlnOiAoZ29vZ2xlT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZ29vZ2xlT3B0aW9ucy5yZXRyaWV2YWxDb25maWcpID8ge1xuICAgICAgICAgIC4uLmdvb2dsZVRvb2xDb25maWcsXG4gICAgICAgICAgcmV0cmlldmFsQ29uZmlnOiBnb29nbGVPcHRpb25zLnJldHJpZXZhbENvbmZpZ1xuICAgICAgICB9IDogZ29vZ2xlVG9vbENvbmZpZyxcbiAgICAgICAgY2FjaGVkQ29udGVudDogZ29vZ2xlT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogZ29vZ2xlT3B0aW9ucy5jYWNoZWRDb250ZW50LFxuICAgICAgICBsYWJlbHM6IGdvb2dsZU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IGdvb2dsZU9wdGlvbnMubGFiZWxzXG4gICAgICB9LFxuICAgICAgd2FybmluZ3M6IFsuLi53YXJuaW5ncywgLi4udG9vbFdhcm5pbmdzXSxcbiAgICAgIHByb3ZpZGVyT3B0aW9uc05hbWVcbiAgICB9O1xuICB9XG4gIGFzeW5jIGRvR2VuZXJhdGUob3B0aW9ucykge1xuICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2UsIF9mLCBfZywgX2gsIF9pO1xuICAgIGNvbnN0IHsgYXJncywgd2FybmluZ3MsIHByb3ZpZGVyT3B0aW9uc05hbWUgfSA9IGF3YWl0IHRoaXMuZ2V0QXJncyhvcHRpb25zKTtcbiAgICBjb25zdCBtZXJnZWRIZWFkZXJzID0gY29tYmluZUhlYWRlcnMyKFxuICAgICAgYXdhaXQgcmVzb2x2ZTIodGhpcy5jb25maWcuaGVhZGVycyksXG4gICAgICBvcHRpb25zLmhlYWRlcnNcbiAgICApO1xuICAgIGNvbnN0IHtcbiAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgIHZhbHVlOiByZXNwb25zZSxcbiAgICAgIHJhd1ZhbHVlOiByYXdSZXNwb25zZVxuICAgIH0gPSBhd2FpdCBwb3N0SnNvblRvQXBpMih7XG4gICAgICB1cmw6IGAke3RoaXMuY29uZmlnLmJhc2VVUkx9LyR7Z2V0TW9kZWxQYXRoKFxuICAgICAgICB0aGlzLm1vZGVsSWRcbiAgICAgICl9OmdlbmVyYXRlQ29udGVudGAsXG4gICAgICBoZWFkZXJzOiBtZXJnZWRIZWFkZXJzLFxuICAgICAgYm9keTogYXJncyxcbiAgICAgIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogZ29vZ2xlRmFpbGVkUmVzcG9uc2VIYW5kbGVyLFxuICAgICAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlcjIocmVzcG9uc2VTY2hlbWEpLFxuICAgICAgYWJvcnRTaWduYWw6IG9wdGlvbnMuYWJvcnRTaWduYWwsXG4gICAgICBmZXRjaDogdGhpcy5jb25maWcuZmV0Y2hcbiAgICB9KTtcbiAgICBjb25zdCBjYW5kaWRhdGUgPSByZXNwb25zZS5jYW5kaWRhdGVzWzBdO1xuICAgIGNvbnN0IGNvbnRlbnQgPSBbXTtcbiAgICBjb25zdCBwYXJ0cyA9IChfYiA9IChfYSA9IGNhbmRpZGF0ZS5jb250ZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2EucGFydHMpICE9IG51bGwgPyBfYiA6IFtdO1xuICAgIGNvbnN0IHVzYWdlTWV0YWRhdGEgPSByZXNwb25zZS51c2FnZU1ldGFkYXRhO1xuICAgIGxldCBsYXN0Q29kZUV4ZWN1dGlvblRvb2xDYWxsSWQ7XG4gICAgZm9yIChjb25zdCBwYXJ0IG9mIHBhcnRzKSB7XG4gICAgICBpZiAoXCJleGVjdXRhYmxlQ29kZVwiIGluIHBhcnQgJiYgKChfYyA9IHBhcnQuZXhlY3V0YWJsZUNvZGUpID09IG51bGwgPyB2b2lkIDAgOiBfYy5jb2RlKSkge1xuICAgICAgICBjb25zdCB0b29sQ2FsbElkID0gdGhpcy5jb25maWcuZ2VuZXJhdGVJZCgpO1xuICAgICAgICBsYXN0Q29kZUV4ZWN1dGlvblRvb2xDYWxsSWQgPSB0b29sQ2FsbElkO1xuICAgICAgICBjb250ZW50LnB1c2goe1xuICAgICAgICAgIHR5cGU6IFwidG9vbC1jYWxsXCIsXG4gICAgICAgICAgdG9vbENhbGxJZCxcbiAgICAgICAgICB0b29sTmFtZTogXCJjb2RlX2V4ZWN1dGlvblwiLFxuICAgICAgICAgIGlucHV0OiBKU09OLnN0cmluZ2lmeShwYXJ0LmV4ZWN1dGFibGVDb2RlKSxcbiAgICAgICAgICBwcm92aWRlckV4ZWN1dGVkOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChcImNvZGVFeGVjdXRpb25SZXN1bHRcIiBpbiBwYXJ0ICYmIHBhcnQuY29kZUV4ZWN1dGlvblJlc3VsdCkge1xuICAgICAgICBjb250ZW50LnB1c2goe1xuICAgICAgICAgIHR5cGU6IFwidG9vbC1yZXN1bHRcIixcbiAgICAgICAgICAvLyBBc3N1bWVzIGEgcmVzdWx0IGRpcmVjdGx5IGZvbGxvd3MgaXRzIGNvcnJlc3BvbmRpbmcgY2FsbCBwYXJ0LlxuICAgICAgICAgIHRvb2xDYWxsSWQ6IGxhc3RDb2RlRXhlY3V0aW9uVG9vbENhbGxJZCxcbiAgICAgICAgICB0b29sTmFtZTogXCJjb2RlX2V4ZWN1dGlvblwiLFxuICAgICAgICAgIHJlc3VsdDoge1xuICAgICAgICAgICAgb3V0Y29tZTogcGFydC5jb2RlRXhlY3V0aW9uUmVzdWx0Lm91dGNvbWUsXG4gICAgICAgICAgICBvdXRwdXQ6IHBhcnQuY29kZUV4ZWN1dGlvblJlc3VsdC5vdXRwdXRcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBsYXN0Q29kZUV4ZWN1dGlvblRvb2xDYWxsSWQgPSB2b2lkIDA7XG4gICAgICB9IGVsc2UgaWYgKFwidGV4dFwiIGluIHBhcnQgJiYgcGFydC50ZXh0ICE9IG51bGwgJiYgcGFydC50ZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29udGVudC5wdXNoKHtcbiAgICAgICAgICB0eXBlOiBwYXJ0LnRob3VnaHQgPT09IHRydWUgPyBcInJlYXNvbmluZ1wiIDogXCJ0ZXh0XCIsXG4gICAgICAgICAgdGV4dDogcGFydC50ZXh0LFxuICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IHBhcnQudGhvdWdodFNpZ25hdHVyZSA/IHtcbiAgICAgICAgICAgIFtwcm92aWRlck9wdGlvbnNOYW1lXToge1xuICAgICAgICAgICAgICB0aG91Z2h0U2lnbmF0dXJlOiBwYXJ0LnRob3VnaHRTaWduYXR1cmVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IDogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChcImZ1bmN0aW9uQ2FsbFwiIGluIHBhcnQpIHtcbiAgICAgICAgY29udGVudC5wdXNoKHtcbiAgICAgICAgICB0eXBlOiBcInRvb2wtY2FsbFwiLFxuICAgICAgICAgIHRvb2xDYWxsSWQ6IHRoaXMuY29uZmlnLmdlbmVyYXRlSWQoKSxcbiAgICAgICAgICB0b29sTmFtZTogcGFydC5mdW5jdGlvbkNhbGwubmFtZSxcbiAgICAgICAgICBpbnB1dDogSlNPTi5zdHJpbmdpZnkocGFydC5mdW5jdGlvbkNhbGwuYXJncyksXG4gICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogcGFydC50aG91Z2h0U2lnbmF0dXJlID8ge1xuICAgICAgICAgICAgW3Byb3ZpZGVyT3B0aW9uc05hbWVdOiB7XG4gICAgICAgICAgICAgIHRob3VnaHRTaWduYXR1cmU6IHBhcnQudGhvdWdodFNpZ25hdHVyZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKFwiaW5saW5lRGF0YVwiIGluIHBhcnQpIHtcbiAgICAgICAgY29udGVudC5wdXNoKHtcbiAgICAgICAgICB0eXBlOiBcImZpbGVcIixcbiAgICAgICAgICBkYXRhOiBwYXJ0LmlubGluZURhdGEuZGF0YSxcbiAgICAgICAgICBtZWRpYVR5cGU6IHBhcnQuaW5saW5lRGF0YS5taW1lVHlwZSxcbiAgICAgICAgICBwcm92aWRlck1ldGFkYXRhOiBwYXJ0LnRob3VnaHRTaWduYXR1cmUgPyB7XG4gICAgICAgICAgICBbcHJvdmlkZXJPcHRpb25zTmFtZV06IHtcbiAgICAgICAgICAgICAgdGhvdWdodFNpZ25hdHVyZTogcGFydC50aG91Z2h0U2lnbmF0dXJlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSA6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3Qgc291cmNlcyA9IChfZCA9IGV4dHJhY3RTb3VyY2VzKHtcbiAgICAgIGdyb3VuZGluZ01ldGFkYXRhOiBjYW5kaWRhdGUuZ3JvdW5kaW5nTWV0YWRhdGEsXG4gICAgICBnZW5lcmF0ZUlkOiB0aGlzLmNvbmZpZy5nZW5lcmF0ZUlkXG4gICAgfSkpICE9IG51bGwgPyBfZCA6IFtdO1xuICAgIGZvciAoY29uc3Qgc291cmNlIG9mIHNvdXJjZXMpIHtcbiAgICAgIGNvbnRlbnQucHVzaChzb3VyY2UpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgY29udGVudCxcbiAgICAgIGZpbmlzaFJlYXNvbjoge1xuICAgICAgICB1bmlmaWVkOiBtYXBHb29nbGVHZW5lcmF0aXZlQUlGaW5pc2hSZWFzb24oe1xuICAgICAgICAgIGZpbmlzaFJlYXNvbjogY2FuZGlkYXRlLmZpbmlzaFJlYXNvbixcbiAgICAgICAgICAvLyBPbmx5IGNvdW50IGNsaWVudC1leGVjdXRlZCB0b29sIGNhbGxzIGZvciBmaW5pc2ggcmVhc29uIGRldGVybWluYXRpb24uXG4gICAgICAgICAgaGFzVG9vbENhbGxzOiBjb250ZW50LnNvbWUoXG4gICAgICAgICAgICAocGFydCkgPT4gcGFydC50eXBlID09PSBcInRvb2wtY2FsbFwiICYmICFwYXJ0LnByb3ZpZGVyRXhlY3V0ZWRcbiAgICAgICAgICApXG4gICAgICAgIH0pLFxuICAgICAgICByYXc6IChfZSA9IGNhbmRpZGF0ZS5maW5pc2hSZWFzb24pICE9IG51bGwgPyBfZSA6IHZvaWQgMFxuICAgICAgfSxcbiAgICAgIHVzYWdlOiBjb252ZXJ0R29vZ2xlR2VuZXJhdGl2ZUFJVXNhZ2UodXNhZ2VNZXRhZGF0YSksXG4gICAgICB3YXJuaW5ncyxcbiAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IHtcbiAgICAgICAgW3Byb3ZpZGVyT3B0aW9uc05hbWVdOiB7XG4gICAgICAgICAgcHJvbXB0RmVlZGJhY2s6IChfZiA9IHJlc3BvbnNlLnByb21wdEZlZWRiYWNrKSAhPSBudWxsID8gX2YgOiBudWxsLFxuICAgICAgICAgIGdyb3VuZGluZ01ldGFkYXRhOiAoX2cgPSBjYW5kaWRhdGUuZ3JvdW5kaW5nTWV0YWRhdGEpICE9IG51bGwgPyBfZyA6IG51bGwsXG4gICAgICAgICAgdXJsQ29udGV4dE1ldGFkYXRhOiAoX2ggPSBjYW5kaWRhdGUudXJsQ29udGV4dE1ldGFkYXRhKSAhPSBudWxsID8gX2ggOiBudWxsLFxuICAgICAgICAgIHNhZmV0eVJhdGluZ3M6IChfaSA9IGNhbmRpZGF0ZS5zYWZldHlSYXRpbmdzKSAhPSBudWxsID8gX2kgOiBudWxsLFxuICAgICAgICAgIHVzYWdlTWV0YWRhdGE6IHVzYWdlTWV0YWRhdGEgIT0gbnVsbCA/IHVzYWdlTWV0YWRhdGEgOiBudWxsXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICByZXF1ZXN0OiB7IGJvZHk6IGFyZ3MgfSxcbiAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgIC8vIFRPRE8gdGltZXN0YW1wLCBtb2RlbCBpZCwgaWRcbiAgICAgICAgaGVhZGVyczogcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICBib2R5OiByYXdSZXNwb25zZVxuICAgICAgfVxuICAgIH07XG4gIH1cbiAgYXN5bmMgZG9TdHJlYW0ob3B0aW9ucykge1xuICAgIGNvbnN0IHsgYXJncywgd2FybmluZ3MsIHByb3ZpZGVyT3B0aW9uc05hbWUgfSA9IGF3YWl0IHRoaXMuZ2V0QXJncyhvcHRpb25zKTtcbiAgICBjb25zdCBoZWFkZXJzID0gY29tYmluZUhlYWRlcnMyKFxuICAgICAgYXdhaXQgcmVzb2x2ZTIodGhpcy5jb25maWcuaGVhZGVycyksXG4gICAgICBvcHRpb25zLmhlYWRlcnNcbiAgICApO1xuICAgIGNvbnN0IHsgcmVzcG9uc2VIZWFkZXJzLCB2YWx1ZTogcmVzcG9uc2UgfSA9IGF3YWl0IHBvc3RKc29uVG9BcGkyKHtcbiAgICAgIHVybDogYCR7dGhpcy5jb25maWcuYmFzZVVSTH0vJHtnZXRNb2RlbFBhdGgoXG4gICAgICAgIHRoaXMubW9kZWxJZFxuICAgICAgKX06c3RyZWFtR2VuZXJhdGVDb250ZW50P2FsdD1zc2VgLFxuICAgICAgaGVhZGVycyxcbiAgICAgIGJvZHk6IGFyZ3MsXG4gICAgICBmYWlsZWRSZXNwb25zZUhhbmRsZXI6IGdvb2dsZUZhaWxlZFJlc3BvbnNlSGFuZGxlcixcbiAgICAgIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXI6IGNyZWF0ZUV2ZW50U291cmNlUmVzcG9uc2VIYW5kbGVyKGNodW5rU2NoZW1hKSxcbiAgICAgIGFib3J0U2lnbmFsOiBvcHRpb25zLmFib3J0U2lnbmFsLFxuICAgICAgZmV0Y2g6IHRoaXMuY29uZmlnLmZldGNoXG4gICAgfSk7XG4gICAgbGV0IGZpbmlzaFJlYXNvbiA9IHtcbiAgICAgIHVuaWZpZWQ6IFwib3RoZXJcIixcbiAgICAgIHJhdzogdm9pZCAwXG4gICAgfTtcbiAgICBsZXQgdXNhZ2UgPSB2b2lkIDA7XG4gICAgbGV0IHByb3ZpZGVyTWV0YWRhdGEgPSB2b2lkIDA7XG4gICAgY29uc3QgZ2VuZXJhdGVJZDMgPSB0aGlzLmNvbmZpZy5nZW5lcmF0ZUlkO1xuICAgIGxldCBoYXNUb29sQ2FsbHMgPSBmYWxzZTtcbiAgICBsZXQgY3VycmVudFRleHRCbG9ja0lkID0gbnVsbDtcbiAgICBsZXQgY3VycmVudFJlYXNvbmluZ0Jsb2NrSWQgPSBudWxsO1xuICAgIGxldCBibG9ja0NvdW50ZXIgPSAwO1xuICAgIGNvbnN0IGVtaXR0ZWRTb3VyY2VVcmxzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgICBsZXQgbGFzdENvZGVFeGVjdXRpb25Ub29sQ2FsbElkO1xuICAgIHJldHVybiB7XG4gICAgICBzdHJlYW06IHJlc3BvbnNlLnBpcGVUaHJvdWdoKFxuICAgICAgICBuZXcgVHJhbnNmb3JtU3RyZWFtKHtcbiAgICAgICAgICBzdGFydChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiBcInN0cmVhbS1zdGFydFwiLCB3YXJuaW5ncyB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRyYW5zZm9ybShjaHVuaywgY29udHJvbGxlcikge1xuICAgICAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2YsIF9nO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuaW5jbHVkZVJhd0NodW5rcykge1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiBcInJhd1wiLCByYXdWYWx1ZTogY2h1bmsucmF3VmFsdWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWNodW5rLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogXCJlcnJvclwiLCBlcnJvcjogY2h1bmsuZXJyb3IgfSk7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gY2h1bmsudmFsdWU7XG4gICAgICAgICAgICBjb25zdCB1c2FnZU1ldGFkYXRhID0gdmFsdWUudXNhZ2VNZXRhZGF0YTtcbiAgICAgICAgICAgIGlmICh1c2FnZU1ldGFkYXRhICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgdXNhZ2UgPSB1c2FnZU1ldGFkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY2FuZGlkYXRlID0gKF9hID0gdmFsdWUuY2FuZGlkYXRlcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hWzBdO1xuICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBjYW5kaWRhdGUuY29udGVudDtcbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZXMgPSBleHRyYWN0U291cmNlcyh7XG4gICAgICAgICAgICAgIGdyb3VuZGluZ01ldGFkYXRhOiBjYW5kaWRhdGUuZ3JvdW5kaW5nTWV0YWRhdGEsXG4gICAgICAgICAgICAgIGdlbmVyYXRlSWQ6IGdlbmVyYXRlSWQzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChzb3VyY2VzICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgZm9yIChjb25zdCBzb3VyY2Ugb2Ygc291cmNlcykge1xuICAgICAgICAgICAgICAgIGlmIChzb3VyY2Uuc291cmNlVHlwZSA9PT0gXCJ1cmxcIiAmJiAhZW1pdHRlZFNvdXJjZVVybHMuaGFzKHNvdXJjZS51cmwpKSB7XG4gICAgICAgICAgICAgICAgICBlbWl0dGVkU291cmNlVXJscy5hZGQoc291cmNlLnVybCk7XG4gICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoc291cmNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb250ZW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSAoX2IgPSBjb250ZW50LnBhcnRzKSAhPSBudWxsID8gX2IgOiBbXTtcbiAgICAgICAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIHBhcnRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKFwiZXhlY3V0YWJsZUNvZGVcIiBpbiBwYXJ0ICYmICgoX2MgPSBwYXJ0LmV4ZWN1dGFibGVDb2RlKSA9PSBudWxsID8gdm9pZCAwIDogX2MuY29kZSkpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHRvb2xDYWxsSWQgPSBnZW5lcmF0ZUlkMygpO1xuICAgICAgICAgICAgICAgICAgbGFzdENvZGVFeGVjdXRpb25Ub29sQ2FsbElkID0gdG9vbENhbGxJZDtcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidG9vbC1jYWxsXCIsXG4gICAgICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICAgIHRvb2xOYW1lOiBcImNvZGVfZXhlY3V0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgIGlucHV0OiBKU09OLnN0cmluZ2lmeShwYXJ0LmV4ZWN1dGFibGVDb2RlKSxcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJFeGVjdXRlZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcImNvZGVFeGVjdXRpb25SZXN1bHRcIiBpbiBwYXJ0ICYmIHBhcnQuY29kZUV4ZWN1dGlvblJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgY29uc3QgdG9vbENhbGxJZCA9IGxhc3RDb2RlRXhlY3V0aW9uVG9vbENhbGxJZDtcbiAgICAgICAgICAgICAgICAgIGlmICh0b29sQ2FsbElkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0b29sLXJlc3VsdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICAgICAgdG9vbE5hbWU6IFwiY29kZV9leGVjdXRpb25cIixcbiAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dGNvbWU6IHBhcnQuY29kZUV4ZWN1dGlvblJlc3VsdC5vdXRjb21lLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0OiBwYXJ0LmNvZGVFeGVjdXRpb25SZXN1bHQub3V0cHV0XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgbGFzdENvZGVFeGVjdXRpb25Ub29sQ2FsbElkID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXCJ0ZXh0XCIgaW4gcGFydCAmJiBwYXJ0LnRleHQgIT0gbnVsbCAmJiBwYXJ0LnRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgaWYgKHBhcnQudGhvdWdodCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFRleHRCbG9ja0lkICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidGV4dC1lbmRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjdXJyZW50VGV4dEJsb2NrSWRcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGV4dEJsb2NrSWQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50UmVhc29uaW5nQmxvY2tJZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSZWFzb25pbmdCbG9ja0lkID0gU3RyaW5nKGJsb2NrQ291bnRlcisrKTtcbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJyZWFzb25pbmctc3RhcnRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjdXJyZW50UmVhc29uaW5nQmxvY2tJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IHBhcnQudGhvdWdodFNpZ25hdHVyZSA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgW3Byb3ZpZGVyT3B0aW9uc05hbWVdOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhvdWdodFNpZ25hdHVyZTogcGFydC50aG91Z2h0U2lnbmF0dXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gOiB2b2lkIDBcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwicmVhc29uaW5nLWRlbHRhXCIsXG4gICAgICAgICAgICAgICAgICAgICAgaWQ6IGN1cnJlbnRSZWFzb25pbmdCbG9ja0lkLFxuICAgICAgICAgICAgICAgICAgICAgIGRlbHRhOiBwYXJ0LnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogcGFydC50aG91Z2h0U2lnbmF0dXJlID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgW3Byb3ZpZGVyT3B0aW9uc05hbWVdOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRob3VnaHRTaWduYXR1cmU6IHBhcnQudGhvdWdodFNpZ25hdHVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0gOiB2b2lkIDBcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFJlYXNvbmluZ0Jsb2NrSWQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJyZWFzb25pbmctZW5kXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogY3VycmVudFJlYXNvbmluZ0Jsb2NrSWRcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UmVhc29uaW5nQmxvY2tJZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRUZXh0QmxvY2tJZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUZXh0QmxvY2tJZCA9IFN0cmluZyhibG9ja0NvdW50ZXIrKyk7XG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidGV4dC1zdGFydFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGN1cnJlbnRUZXh0QmxvY2tJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IHBhcnQudGhvdWdodFNpZ25hdHVyZSA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgW3Byb3ZpZGVyT3B0aW9uc05hbWVdOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhvdWdodFNpZ25hdHVyZTogcGFydC50aG91Z2h0U2lnbmF0dXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gOiB2b2lkIDBcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidGV4dC1kZWx0YVwiLFxuICAgICAgICAgICAgICAgICAgICAgIGlkOiBjdXJyZW50VGV4dEJsb2NrSWQsXG4gICAgICAgICAgICAgICAgICAgICAgZGVsdGE6IHBhcnQudGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhOiBwYXJ0LnRob3VnaHRTaWduYXR1cmUgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgICBbcHJvdmlkZXJPcHRpb25zTmFtZV06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhvdWdodFNpZ25hdHVyZTogcGFydC50aG91Z2h0U2lnbmF0dXJlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSA6IHZvaWQgMFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwiaW5saW5lRGF0YVwiIGluIHBhcnQpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiZmlsZVwiLFxuICAgICAgICAgICAgICAgICAgICBtZWRpYVR5cGU6IHBhcnQuaW5saW5lRGF0YS5taW1lVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogcGFydC5pbmxpbmVEYXRhLmRhdGFcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjb25zdCB0b29sQ2FsbERlbHRhcyA9IGdldFRvb2xDYWxsc0Zyb21QYXJ0cyh7XG4gICAgICAgICAgICAgICAgcGFydHM6IGNvbnRlbnQucGFydHMsXG4gICAgICAgICAgICAgICAgZ2VuZXJhdGVJZDogZ2VuZXJhdGVJZDMsXG4gICAgICAgICAgICAgICAgcHJvdmlkZXJPcHRpb25zTmFtZVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgaWYgKHRvb2xDYWxsRGVsdGFzICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHRvb2xDYWxsIG9mIHRvb2xDYWxsRGVsdGFzKSB7XG4gICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInRvb2wtaW5wdXQtc3RhcnRcIixcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHRvb2xDYWxsLnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICAgIHRvb2xOYW1lOiB0b29sQ2FsbC50b29sTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogdG9vbENhbGwucHJvdmlkZXJNZXRhZGF0YVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInRvb2wtaW5wdXQtZGVsdGFcIixcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHRvb2xDYWxsLnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICAgIGRlbHRhOiB0b29sQ2FsbC5hcmdzLFxuICAgICAgICAgICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhOiB0b29sQ2FsbC5wcm92aWRlck1ldGFkYXRhXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidG9vbC1pbnB1dC1lbmRcIixcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHRvb2xDYWxsLnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IHRvb2xDYWxsLnByb3ZpZGVyTWV0YWRhdGFcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0b29sLWNhbGxcIixcbiAgICAgICAgICAgICAgICAgICAgdG9vbENhbGxJZDogdG9vbENhbGwudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgICAgICAgdG9vbE5hbWU6IHRvb2xDYWxsLnRvb2xOYW1lLFxuICAgICAgICAgICAgICAgICAgICBpbnB1dDogdG9vbENhbGwuYXJncyxcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogdG9vbENhbGwucHJvdmlkZXJNZXRhZGF0YVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICBoYXNUb29sQ2FsbHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZS5maW5pc2hSZWFzb24gIT0gbnVsbCkge1xuICAgICAgICAgICAgICBmaW5pc2hSZWFzb24gPSB7XG4gICAgICAgICAgICAgICAgdW5pZmllZDogbWFwR29vZ2xlR2VuZXJhdGl2ZUFJRmluaXNoUmVhc29uKHtcbiAgICAgICAgICAgICAgICAgIGZpbmlzaFJlYXNvbjogY2FuZGlkYXRlLmZpbmlzaFJlYXNvbixcbiAgICAgICAgICAgICAgICAgIGhhc1Rvb2xDYWxsc1xuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIHJhdzogY2FuZGlkYXRlLmZpbmlzaFJlYXNvblxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhID0ge1xuICAgICAgICAgICAgICAgIFtwcm92aWRlck9wdGlvbnNOYW1lXToge1xuICAgICAgICAgICAgICAgICAgcHJvbXB0RmVlZGJhY2s6IChfZCA9IHZhbHVlLnByb21wdEZlZWRiYWNrKSAhPSBudWxsID8gX2QgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgZ3JvdW5kaW5nTWV0YWRhdGE6IChfZSA9IGNhbmRpZGF0ZS5ncm91bmRpbmdNZXRhZGF0YSkgIT0gbnVsbCA/IF9lIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgIHVybENvbnRleHRNZXRhZGF0YTogKF9mID0gY2FuZGlkYXRlLnVybENvbnRleHRNZXRhZGF0YSkgIT0gbnVsbCA/IF9mIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgIHNhZmV0eVJhdGluZ3M6IChfZyA9IGNhbmRpZGF0ZS5zYWZldHlSYXRpbmdzKSAhPSBudWxsID8gX2cgOiBudWxsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICBpZiAodXNhZ2VNZXRhZGF0YSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YVtwcm92aWRlck9wdGlvbnNOYW1lXS51c2FnZU1ldGFkYXRhID0gdXNhZ2VNZXRhZGF0YTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZmx1c2goY29udHJvbGxlcikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRUZXh0QmxvY2tJZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgIHR5cGU6IFwidGV4dC1lbmRcIixcbiAgICAgICAgICAgICAgICBpZDogY3VycmVudFRleHRCbG9ja0lkXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGN1cnJlbnRSZWFzb25pbmdCbG9ja0lkICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJyZWFzb25pbmctZW5kXCIsXG4gICAgICAgICAgICAgICAgaWQ6IGN1cnJlbnRSZWFzb25pbmdCbG9ja0lkXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgdHlwZTogXCJmaW5pc2hcIixcbiAgICAgICAgICAgICAgZmluaXNoUmVhc29uLFxuICAgICAgICAgICAgICB1c2FnZTogY29udmVydEdvb2dsZUdlbmVyYXRpdmVBSVVzYWdlKHVzYWdlKSxcbiAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgKSxcbiAgICAgIHJlc3BvbnNlOiB7IGhlYWRlcnM6IHJlc3BvbnNlSGVhZGVycyB9LFxuICAgICAgcmVxdWVzdDogeyBib2R5OiBhcmdzIH1cbiAgICB9O1xuICB9XG59O1xuZnVuY3Rpb24gZ2V0VG9vbENhbGxzRnJvbVBhcnRzKHtcbiAgcGFydHMsXG4gIGdlbmVyYXRlSWQ6IGdlbmVyYXRlSWQzLFxuICBwcm92aWRlck9wdGlvbnNOYW1lXG59KSB7XG4gIGNvbnN0IGZ1bmN0aW9uQ2FsbFBhcnRzID0gcGFydHMgPT0gbnVsbCA/IHZvaWQgMCA6IHBhcnRzLmZpbHRlcihcbiAgICAocGFydCkgPT4gXCJmdW5jdGlvbkNhbGxcIiBpbiBwYXJ0XG4gICk7XG4gIHJldHVybiBmdW5jdGlvbkNhbGxQYXJ0cyA9PSBudWxsIHx8IGZ1bmN0aW9uQ2FsbFBhcnRzLmxlbmd0aCA9PT0gMCA/IHZvaWQgMCA6IGZ1bmN0aW9uQ2FsbFBhcnRzLm1hcCgocGFydCkgPT4gKHtcbiAgICB0eXBlOiBcInRvb2wtY2FsbFwiLFxuICAgIHRvb2xDYWxsSWQ6IGdlbmVyYXRlSWQzKCksXG4gICAgdG9vbE5hbWU6IHBhcnQuZnVuY3Rpb25DYWxsLm5hbWUsXG4gICAgYXJnczogSlNPTi5zdHJpbmdpZnkocGFydC5mdW5jdGlvbkNhbGwuYXJncyksXG4gICAgcHJvdmlkZXJNZXRhZGF0YTogcGFydC50aG91Z2h0U2lnbmF0dXJlID8ge1xuICAgICAgW3Byb3ZpZGVyT3B0aW9uc05hbWVdOiB7XG4gICAgICAgIHRob3VnaHRTaWduYXR1cmU6IHBhcnQudGhvdWdodFNpZ25hdHVyZVxuICAgICAgfVxuICAgIH0gOiB2b2lkIDBcbiAgfSkpO1xufVxuZnVuY3Rpb24gZXh0cmFjdFNvdXJjZXMoe1xuICBncm91bmRpbmdNZXRhZGF0YSxcbiAgZ2VuZXJhdGVJZDogZ2VuZXJhdGVJZDNcbn0pIHtcbiAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZTtcbiAgaWYgKCEoZ3JvdW5kaW5nTWV0YWRhdGEgPT0gbnVsbCA/IHZvaWQgMCA6IGdyb3VuZGluZ01ldGFkYXRhLmdyb3VuZGluZ0NodW5rcykpIHtcbiAgICByZXR1cm4gdm9pZCAwO1xuICB9XG4gIGNvbnN0IHNvdXJjZXMgPSBbXTtcbiAgZm9yIChjb25zdCBjaHVuayBvZiBncm91bmRpbmdNZXRhZGF0YS5ncm91bmRpbmdDaHVua3MpIHtcbiAgICBpZiAoY2h1bmsud2ViICE9IG51bGwpIHtcbiAgICAgIHNvdXJjZXMucHVzaCh7XG4gICAgICAgIHR5cGU6IFwic291cmNlXCIsXG4gICAgICAgIHNvdXJjZVR5cGU6IFwidXJsXCIsXG4gICAgICAgIGlkOiBnZW5lcmF0ZUlkMygpLFxuICAgICAgICB1cmw6IGNodW5rLndlYi51cmksXG4gICAgICAgIHRpdGxlOiAoX2EgPSBjaHVuay53ZWIudGl0bGUpICE9IG51bGwgPyBfYSA6IHZvaWQgMFxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChjaHVuay5yZXRyaWV2ZWRDb250ZXh0ICE9IG51bGwpIHtcbiAgICAgIGNvbnN0IHVyaSA9IGNodW5rLnJldHJpZXZlZENvbnRleHQudXJpO1xuICAgICAgY29uc3QgZmlsZVNlYXJjaFN0b3JlID0gY2h1bmsucmV0cmlldmVkQ29udGV4dC5maWxlU2VhcmNoU3RvcmU7XG4gICAgICBpZiAodXJpICYmICh1cmkuc3RhcnRzV2l0aChcImh0dHA6Ly9cIikgfHwgdXJpLnN0YXJ0c1dpdGgoXCJodHRwczovL1wiKSkpIHtcbiAgICAgICAgc291cmNlcy5wdXNoKHtcbiAgICAgICAgICB0eXBlOiBcInNvdXJjZVwiLFxuICAgICAgICAgIHNvdXJjZVR5cGU6IFwidXJsXCIsXG4gICAgICAgICAgaWQ6IGdlbmVyYXRlSWQzKCksXG4gICAgICAgICAgdXJsOiB1cmksXG4gICAgICAgICAgdGl0bGU6IChfYiA9IGNodW5rLnJldHJpZXZlZENvbnRleHQudGl0bGUpICE9IG51bGwgPyBfYiA6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAodXJpKSB7XG4gICAgICAgIGNvbnN0IHRpdGxlID0gKF9jID0gY2h1bmsucmV0cmlldmVkQ29udGV4dC50aXRsZSkgIT0gbnVsbCA/IF9jIDogXCJVbmtub3duIERvY3VtZW50XCI7XG4gICAgICAgIGxldCBtZWRpYVR5cGUgPSBcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiO1xuICAgICAgICBsZXQgZmlsZW5hbWUgPSB2b2lkIDA7XG4gICAgICAgIGlmICh1cmkuZW5kc1dpdGgoXCIucGRmXCIpKSB7XG4gICAgICAgICAgbWVkaWFUeXBlID0gXCJhcHBsaWNhdGlvbi9wZGZcIjtcbiAgICAgICAgICBmaWxlbmFtZSA9IHVyaS5zcGxpdChcIi9cIikucG9wKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodXJpLmVuZHNXaXRoKFwiLnR4dFwiKSkge1xuICAgICAgICAgIG1lZGlhVHlwZSA9IFwidGV4dC9wbGFpblwiO1xuICAgICAgICAgIGZpbGVuYW1lID0gdXJpLnNwbGl0KFwiL1wiKS5wb3AoKTtcbiAgICAgICAgfSBlbHNlIGlmICh1cmkuZW5kc1dpdGgoXCIuZG9jeFwiKSkge1xuICAgICAgICAgIG1lZGlhVHlwZSA9IFwiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LndvcmRwcm9jZXNzaW5nbWwuZG9jdW1lbnRcIjtcbiAgICAgICAgICBmaWxlbmFtZSA9IHVyaS5zcGxpdChcIi9cIikucG9wKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodXJpLmVuZHNXaXRoKFwiLmRvY1wiKSkge1xuICAgICAgICAgIG1lZGlhVHlwZSA9IFwiYXBwbGljYXRpb24vbXN3b3JkXCI7XG4gICAgICAgICAgZmlsZW5hbWUgPSB1cmkuc3BsaXQoXCIvXCIpLnBvcCgpO1xuICAgICAgICB9IGVsc2UgaWYgKHVyaS5tYXRjaCgvXFwuKG1kfG1hcmtkb3duKSQvKSkge1xuICAgICAgICAgIG1lZGlhVHlwZSA9IFwidGV4dC9tYXJrZG93blwiO1xuICAgICAgICAgIGZpbGVuYW1lID0gdXJpLnNwbGl0KFwiL1wiKS5wb3AoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmaWxlbmFtZSA9IHVyaS5zcGxpdChcIi9cIikucG9wKCk7XG4gICAgICAgIH1cbiAgICAgICAgc291cmNlcy5wdXNoKHtcbiAgICAgICAgICB0eXBlOiBcInNvdXJjZVwiLFxuICAgICAgICAgIHNvdXJjZVR5cGU6IFwiZG9jdW1lbnRcIixcbiAgICAgICAgICBpZDogZ2VuZXJhdGVJZDMoKSxcbiAgICAgICAgICBtZWRpYVR5cGUsXG4gICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgZmlsZW5hbWVcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKGZpbGVTZWFyY2hTdG9yZSkge1xuICAgICAgICBjb25zdCB0aXRsZSA9IChfZCA9IGNodW5rLnJldHJpZXZlZENvbnRleHQudGl0bGUpICE9IG51bGwgPyBfZCA6IFwiVW5rbm93biBEb2N1bWVudFwiO1xuICAgICAgICBzb3VyY2VzLnB1c2goe1xuICAgICAgICAgIHR5cGU6IFwic291cmNlXCIsXG4gICAgICAgICAgc291cmNlVHlwZTogXCJkb2N1bWVudFwiLFxuICAgICAgICAgIGlkOiBnZW5lcmF0ZUlkMygpLFxuICAgICAgICAgIG1lZGlhVHlwZTogXCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW1cIixcbiAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICBmaWxlbmFtZTogZmlsZVNlYXJjaFN0b3JlLnNwbGl0KFwiL1wiKS5wb3AoKVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGNodW5rLm1hcHMgIT0gbnVsbCkge1xuICAgICAgaWYgKGNodW5rLm1hcHMudXJpKSB7XG4gICAgICAgIHNvdXJjZXMucHVzaCh7XG4gICAgICAgICAgdHlwZTogXCJzb3VyY2VcIixcbiAgICAgICAgICBzb3VyY2VUeXBlOiBcInVybFwiLFxuICAgICAgICAgIGlkOiBnZW5lcmF0ZUlkMygpLFxuICAgICAgICAgIHVybDogY2h1bmsubWFwcy51cmksXG4gICAgICAgICAgdGl0bGU6IChfZSA9IGNodW5rLm1hcHMudGl0bGUpICE9IG51bGwgPyBfZSA6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHNvdXJjZXMubGVuZ3RoID4gMCA/IHNvdXJjZXMgOiB2b2lkIDA7XG59XG52YXIgZ2V0R3JvdW5kaW5nTWV0YWRhdGFTY2hlbWEgPSAoKSA9PiB6NS5vYmplY3Qoe1xuICB3ZWJTZWFyY2hRdWVyaWVzOiB6NS5hcnJheSh6NS5zdHJpbmcoKSkubnVsbGlzaCgpLFxuICByZXRyaWV2YWxRdWVyaWVzOiB6NS5hcnJheSh6NS5zdHJpbmcoKSkubnVsbGlzaCgpLFxuICBzZWFyY2hFbnRyeVBvaW50OiB6NS5vYmplY3QoeyByZW5kZXJlZENvbnRlbnQ6IHo1LnN0cmluZygpIH0pLm51bGxpc2goKSxcbiAgZ3JvdW5kaW5nQ2h1bmtzOiB6NS5hcnJheShcbiAgICB6NS5vYmplY3Qoe1xuICAgICAgd2ViOiB6NS5vYmplY3QoeyB1cmk6IHo1LnN0cmluZygpLCB0aXRsZTogejUuc3RyaW5nKCkubnVsbGlzaCgpIH0pLm51bGxpc2goKSxcbiAgICAgIHJldHJpZXZlZENvbnRleHQ6IHo1Lm9iamVjdCh7XG4gICAgICAgIHVyaTogejUuc3RyaW5nKCkubnVsbGlzaCgpLFxuICAgICAgICB0aXRsZTogejUuc3RyaW5nKCkubnVsbGlzaCgpLFxuICAgICAgICB0ZXh0OiB6NS5zdHJpbmcoKS5udWxsaXNoKCksXG4gICAgICAgIGZpbGVTZWFyY2hTdG9yZTogejUuc3RyaW5nKCkubnVsbGlzaCgpXG4gICAgICB9KS5udWxsaXNoKCksXG4gICAgICBtYXBzOiB6NS5vYmplY3Qoe1xuICAgICAgICB1cmk6IHo1LnN0cmluZygpLm51bGxpc2goKSxcbiAgICAgICAgdGl0bGU6IHo1LnN0cmluZygpLm51bGxpc2goKSxcbiAgICAgICAgdGV4dDogejUuc3RyaW5nKCkubnVsbGlzaCgpLFxuICAgICAgICBwbGFjZUlkOiB6NS5zdHJpbmcoKS5udWxsaXNoKClcbiAgICAgIH0pLm51bGxpc2goKVxuICAgIH0pXG4gICkubnVsbGlzaCgpLFxuICBncm91bmRpbmdTdXBwb3J0czogejUuYXJyYXkoXG4gICAgejUub2JqZWN0KHtcbiAgICAgIHNlZ21lbnQ6IHo1Lm9iamVjdCh7XG4gICAgICAgIHN0YXJ0SW5kZXg6IHo1Lm51bWJlcigpLm51bGxpc2goKSxcbiAgICAgICAgZW5kSW5kZXg6IHo1Lm51bWJlcigpLm51bGxpc2goKSxcbiAgICAgICAgdGV4dDogejUuc3RyaW5nKCkubnVsbGlzaCgpXG4gICAgICB9KSxcbiAgICAgIHNlZ21lbnRfdGV4dDogejUuc3RyaW5nKCkubnVsbGlzaCgpLFxuICAgICAgZ3JvdW5kaW5nQ2h1bmtJbmRpY2VzOiB6NS5hcnJheSh6NS5udW1iZXIoKSkubnVsbGlzaCgpLFxuICAgICAgc3VwcG9ydENodW5rSW5kaWNlczogejUuYXJyYXkoejUubnVtYmVyKCkpLm51bGxpc2goKSxcbiAgICAgIGNvbmZpZGVuY2VTY29yZXM6IHo1LmFycmF5KHo1Lm51bWJlcigpKS5udWxsaXNoKCksXG4gICAgICBjb25maWRlbmNlU2NvcmU6IHo1LmFycmF5KHo1Lm51bWJlcigpKS5udWxsaXNoKClcbiAgICB9KVxuICApLm51bGxpc2goKSxcbiAgcmV0cmlldmFsTWV0YWRhdGE6IHo1LnVuaW9uKFtcbiAgICB6NS5vYmplY3Qoe1xuICAgICAgd2ViRHluYW1pY1JldHJpZXZhbFNjb3JlOiB6NS5udW1iZXIoKVxuICAgIH0pLFxuICAgIHo1Lm9iamVjdCh7fSlcbiAgXSkubnVsbGlzaCgpXG59KTtcbnZhciBnZXRDb250ZW50U2NoZW1hID0gKCkgPT4gejUub2JqZWN0KHtcbiAgcGFydHM6IHo1LmFycmF5KFxuICAgIHo1LnVuaW9uKFtcbiAgICAgIC8vIG5vdGU6IG9yZGVyIG1hdHRlcnMgc2luY2UgdGV4dCBjYW4gYmUgZnVsbHkgZW1wdHlcbiAgICAgIHo1Lm9iamVjdCh7XG4gICAgICAgIGZ1bmN0aW9uQ2FsbDogejUub2JqZWN0KHtcbiAgICAgICAgICBuYW1lOiB6NS5zdHJpbmcoKSxcbiAgICAgICAgICBhcmdzOiB6NS51bmtub3duKClcbiAgICAgICAgfSksXG4gICAgICAgIHRob3VnaHRTaWduYXR1cmU6IHo1LnN0cmluZygpLm51bGxpc2goKVxuICAgICAgfSksXG4gICAgICB6NS5vYmplY3Qoe1xuICAgICAgICBpbmxpbmVEYXRhOiB6NS5vYmplY3Qoe1xuICAgICAgICAgIG1pbWVUeXBlOiB6NS5zdHJpbmcoKSxcbiAgICAgICAgICBkYXRhOiB6NS5zdHJpbmcoKVxuICAgICAgICB9KSxcbiAgICAgICAgdGhvdWdodFNpZ25hdHVyZTogejUuc3RyaW5nKCkubnVsbGlzaCgpXG4gICAgICB9KSxcbiAgICAgIHo1Lm9iamVjdCh7XG4gICAgICAgIGV4ZWN1dGFibGVDb2RlOiB6NS5vYmplY3Qoe1xuICAgICAgICAgIGxhbmd1YWdlOiB6NS5zdHJpbmcoKSxcbiAgICAgICAgICBjb2RlOiB6NS5zdHJpbmcoKVxuICAgICAgICB9KS5udWxsaXNoKCksXG4gICAgICAgIGNvZGVFeGVjdXRpb25SZXN1bHQ6IHo1Lm9iamVjdCh7XG4gICAgICAgICAgb3V0Y29tZTogejUuc3RyaW5nKCksXG4gICAgICAgICAgb3V0cHV0OiB6NS5zdHJpbmcoKVxuICAgICAgICB9KS5udWxsaXNoKCksXG4gICAgICAgIHRleHQ6IHo1LnN0cmluZygpLm51bGxpc2goKSxcbiAgICAgICAgdGhvdWdodDogejUuYm9vbGVhbigpLm51bGxpc2goKSxcbiAgICAgICAgdGhvdWdodFNpZ25hdHVyZTogejUuc3RyaW5nKCkubnVsbGlzaCgpXG4gICAgICB9KVxuICAgIF0pXG4gICkubnVsbGlzaCgpXG59KTtcbnZhciBnZXRTYWZldHlSYXRpbmdTY2hlbWEgPSAoKSA9PiB6NS5vYmplY3Qoe1xuICBjYXRlZ29yeTogejUuc3RyaW5nKCkubnVsbGlzaCgpLFxuICBwcm9iYWJpbGl0eTogejUuc3RyaW5nKCkubnVsbGlzaCgpLFxuICBwcm9iYWJpbGl0eVNjb3JlOiB6NS5udW1iZXIoKS5udWxsaXNoKCksXG4gIHNldmVyaXR5OiB6NS5zdHJpbmcoKS5udWxsaXNoKCksXG4gIHNldmVyaXR5U2NvcmU6IHo1Lm51bWJlcigpLm51bGxpc2goKSxcbiAgYmxvY2tlZDogejUuYm9vbGVhbigpLm51bGxpc2goKVxufSk7XG52YXIgdXNhZ2VTY2hlbWEgPSB6NS5vYmplY3Qoe1xuICBjYWNoZWRDb250ZW50VG9rZW5Db3VudDogejUubnVtYmVyKCkubnVsbGlzaCgpLFxuICB0aG91Z2h0c1Rva2VuQ291bnQ6IHo1Lm51bWJlcigpLm51bGxpc2goKSxcbiAgcHJvbXB0VG9rZW5Db3VudDogejUubnVtYmVyKCkubnVsbGlzaCgpLFxuICBjYW5kaWRhdGVzVG9rZW5Db3VudDogejUubnVtYmVyKCkubnVsbGlzaCgpLFxuICB0b3RhbFRva2VuQ291bnQ6IHo1Lm51bWJlcigpLm51bGxpc2goKSxcbiAgLy8gaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL3ZlcnRleC1haS9nZW5lcmF0aXZlLWFpL2RvY3MvcmVmZXJlbmNlL3Jlc3QvdjEvR2VuZXJhdGVDb250ZW50UmVzcG9uc2UjVHJhZmZpY1R5cGVcbiAgdHJhZmZpY1R5cGU6IHo1LnN0cmluZygpLm51bGxpc2goKVxufSk7XG52YXIgZ2V0VXJsQ29udGV4dE1ldGFkYXRhU2NoZW1hID0gKCkgPT4gejUub2JqZWN0KHtcbiAgdXJsTWV0YWRhdGE6IHo1LmFycmF5KFxuICAgIHo1Lm9iamVjdCh7XG4gICAgICByZXRyaWV2ZWRVcmw6IHo1LnN0cmluZygpLFxuICAgICAgdXJsUmV0cmlldmFsU3RhdHVzOiB6NS5zdHJpbmcoKVxuICAgIH0pXG4gIClcbn0pO1xudmFyIHJlc3BvbnNlU2NoZW1hID0gbGF6eVNjaGVtYTUoXG4gICgpID0+IHpvZFNjaGVtYTUoXG4gICAgejUub2JqZWN0KHtcbiAgICAgIGNhbmRpZGF0ZXM6IHo1LmFycmF5KFxuICAgICAgICB6NS5vYmplY3Qoe1xuICAgICAgICAgIGNvbnRlbnQ6IGdldENvbnRlbnRTY2hlbWEoKS5udWxsaXNoKCkub3IoejUub2JqZWN0KHt9KS5zdHJpY3QoKSksXG4gICAgICAgICAgZmluaXNoUmVhc29uOiB6NS5zdHJpbmcoKS5udWxsaXNoKCksXG4gICAgICAgICAgc2FmZXR5UmF0aW5nczogejUuYXJyYXkoZ2V0U2FmZXR5UmF0aW5nU2NoZW1hKCkpLm51bGxpc2goKSxcbiAgICAgICAgICBncm91bmRpbmdNZXRhZGF0YTogZ2V0R3JvdW5kaW5nTWV0YWRhdGFTY2hlbWEoKS5udWxsaXNoKCksXG4gICAgICAgICAgdXJsQ29udGV4dE1ldGFkYXRhOiBnZXRVcmxDb250ZXh0TWV0YWRhdGFTY2hlbWEoKS5udWxsaXNoKClcbiAgICAgICAgfSlcbiAgICAgICksXG4gICAgICB1c2FnZU1ldGFkYXRhOiB1c2FnZVNjaGVtYS5udWxsaXNoKCksXG4gICAgICBwcm9tcHRGZWVkYmFjazogejUub2JqZWN0KHtcbiAgICAgICAgYmxvY2tSZWFzb246IHo1LnN0cmluZygpLm51bGxpc2goKSxcbiAgICAgICAgc2FmZXR5UmF0aW5nczogejUuYXJyYXkoZ2V0U2FmZXR5UmF0aW5nU2NoZW1hKCkpLm51bGxpc2goKVxuICAgICAgfSkubnVsbGlzaCgpXG4gICAgfSlcbiAgKVxuKTtcbnZhciBjaHVua1NjaGVtYSA9IGxhenlTY2hlbWE1KFxuICAoKSA9PiB6b2RTY2hlbWE1KFxuICAgIHo1Lm9iamVjdCh7XG4gICAgICBjYW5kaWRhdGVzOiB6NS5hcnJheShcbiAgICAgICAgejUub2JqZWN0KHtcbiAgICAgICAgICBjb250ZW50OiBnZXRDb250ZW50U2NoZW1hKCkubnVsbGlzaCgpLFxuICAgICAgICAgIGZpbmlzaFJlYXNvbjogejUuc3RyaW5nKCkubnVsbGlzaCgpLFxuICAgICAgICAgIHNhZmV0eVJhdGluZ3M6IHo1LmFycmF5KGdldFNhZmV0eVJhdGluZ1NjaGVtYSgpKS5udWxsaXNoKCksXG4gICAgICAgICAgZ3JvdW5kaW5nTWV0YWRhdGE6IGdldEdyb3VuZGluZ01ldGFkYXRhU2NoZW1hKCkubnVsbGlzaCgpLFxuICAgICAgICAgIHVybENvbnRleHRNZXRhZGF0YTogZ2V0VXJsQ29udGV4dE1ldGFkYXRhU2NoZW1hKCkubnVsbGlzaCgpXG4gICAgICAgIH0pXG4gICAgICApLm51bGxpc2goKSxcbiAgICAgIHVzYWdlTWV0YWRhdGE6IHVzYWdlU2NoZW1hLm51bGxpc2goKSxcbiAgICAgIHByb21wdEZlZWRiYWNrOiB6NS5vYmplY3Qoe1xuICAgICAgICBibG9ja1JlYXNvbjogejUuc3RyaW5nKCkubnVsbGlzaCgpLFxuICAgICAgICBzYWZldHlSYXRpbmdzOiB6NS5hcnJheShnZXRTYWZldHlSYXRpbmdTY2hlbWEoKSkubnVsbGlzaCgpXG4gICAgICB9KS5udWxsaXNoKClcbiAgICB9KVxuICApXG4pO1xuXG4vLyBzcmMvdG9vbC9jb2RlLWV4ZWN1dGlvbi50c1xuaW1wb3J0IHsgY3JlYXRlUHJvdmlkZXJUb29sRmFjdG9yeVdpdGhPdXRwdXRTY2hlbWEgfSBmcm9tIFwiQGFpLXNkay9wcm92aWRlci11dGlsc1wiO1xuaW1wb3J0IHsgeiBhcyB6NiB9IGZyb20gXCJ6b2QvdjRcIjtcbnZhciBjb2RlRXhlY3V0aW9uID0gY3JlYXRlUHJvdmlkZXJUb29sRmFjdG9yeVdpdGhPdXRwdXRTY2hlbWEoe1xuICBpZDogXCJnb29nbGUuY29kZV9leGVjdXRpb25cIixcbiAgaW5wdXRTY2hlbWE6IHo2Lm9iamVjdCh7XG4gICAgbGFuZ3VhZ2U6IHo2LnN0cmluZygpLmRlc2NyaWJlKFwiVGhlIHByb2dyYW1taW5nIGxhbmd1YWdlIG9mIHRoZSBjb2RlLlwiKSxcbiAgICBjb2RlOiB6Ni5zdHJpbmcoKS5kZXNjcmliZShcIlRoZSBjb2RlIHRvIGJlIGV4ZWN1dGVkLlwiKVxuICB9KSxcbiAgb3V0cHV0U2NoZW1hOiB6Ni5vYmplY3Qoe1xuICAgIG91dGNvbWU6IHo2LnN0cmluZygpLmRlc2NyaWJlKCdUaGUgb3V0Y29tZSBvZiB0aGUgZXhlY3V0aW9uIChlLmcuLCBcIk9VVENPTUVfT0tcIikuJyksXG4gICAgb3V0cHV0OiB6Ni5zdHJpbmcoKS5kZXNjcmliZShcIlRoZSBvdXRwdXQgZnJvbSB0aGUgY29kZSBleGVjdXRpb24uXCIpXG4gIH0pXG59KTtcblxuLy8gc3JjL3Rvb2wvZW50ZXJwcmlzZS13ZWItc2VhcmNoLnRzXG5pbXBvcnQge1xuICBjcmVhdGVQcm92aWRlclRvb2xGYWN0b3J5LFxuICBsYXp5U2NoZW1hIGFzIGxhenlTY2hlbWE2LFxuICB6b2RTY2hlbWEgYXMgem9kU2NoZW1hNlxufSBmcm9tIFwiQGFpLXNkay9wcm92aWRlci11dGlsc1wiO1xuaW1wb3J0IHsgeiBhcyB6NyB9IGZyb20gXCJ6b2QvdjRcIjtcbnZhciBlbnRlcnByaXNlV2ViU2VhcmNoID0gY3JlYXRlUHJvdmlkZXJUb29sRmFjdG9yeSh7XG4gIGlkOiBcImdvb2dsZS5lbnRlcnByaXNlX3dlYl9zZWFyY2hcIixcbiAgaW5wdXRTY2hlbWE6IGxhenlTY2hlbWE2KCgpID0+IHpvZFNjaGVtYTYoejcub2JqZWN0KHt9KSkpXG59KTtcblxuLy8gc3JjL3Rvb2wvZmlsZS1zZWFyY2gudHNcbmltcG9ydCB7XG4gIGNyZWF0ZVByb3ZpZGVyVG9vbEZhY3RvcnkgYXMgY3JlYXRlUHJvdmlkZXJUb29sRmFjdG9yeTIsXG4gIGxhenlTY2hlbWEgYXMgbGF6eVNjaGVtYTcsXG4gIHpvZFNjaGVtYSBhcyB6b2RTY2hlbWE3XG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG5pbXBvcnQgeyB6IGFzIHo4IH0gZnJvbSBcInpvZC92NFwiO1xudmFyIGZpbGVTZWFyY2hBcmdzQmFzZVNjaGVtYSA9IHo4Lm9iamVjdCh7XG4gIC8qKiBUaGUgbmFtZXMgb2YgdGhlIGZpbGVfc2VhcmNoX3N0b3JlcyB0byByZXRyaWV2ZSBmcm9tLlxuICAgKiAgRXhhbXBsZTogYGZpbGVTZWFyY2hTdG9yZXMvbXktZmlsZS1zZWFyY2gtc3RvcmUtMTIzYFxuICAgKi9cbiAgZmlsZVNlYXJjaFN0b3JlTmFtZXM6IHo4LmFycmF5KHo4LnN0cmluZygpKS5kZXNjcmliZShcbiAgICBcIlRoZSBuYW1lcyBvZiB0aGUgZmlsZV9zZWFyY2hfc3RvcmVzIHRvIHJldHJpZXZlIGZyb20uIEV4YW1wbGU6IGBmaWxlU2VhcmNoU3RvcmVzL215LWZpbGUtc2VhcmNoLXN0b3JlLTEyM2BcIlxuICApLFxuICAvKiogVGhlIG51bWJlciBvZiBmaWxlIHNlYXJjaCByZXRyaWV2YWwgY2h1bmtzIHRvIHJldHJpZXZlLiAqL1xuICB0b3BLOiB6OC5udW1iZXIoKS5pbnQoKS5wb3NpdGl2ZSgpLmRlc2NyaWJlKFwiVGhlIG51bWJlciBvZiBmaWxlIHNlYXJjaCByZXRyaWV2YWwgY2h1bmtzIHRvIHJldHJpZXZlLlwiKS5vcHRpb25hbCgpLFxuICAvKiogTWV0YWRhdGEgZmlsdGVyIHRvIGFwcGx5IHRvIHRoZSBmaWxlIHNlYXJjaCByZXRyaWV2YWwgZG9jdW1lbnRzLlxuICAgKiAgU2VlIGh0dHBzOi8vZ29vZ2xlLmFpcC5kZXYvMTYwIGZvciB0aGUgc3ludGF4IG9mIHRoZSBmaWx0ZXIgZXhwcmVzc2lvbi5cbiAgICovXG4gIG1ldGFkYXRhRmlsdGVyOiB6OC5zdHJpbmcoKS5kZXNjcmliZShcbiAgICBcIk1ldGFkYXRhIGZpbHRlciB0byBhcHBseSB0byB0aGUgZmlsZSBzZWFyY2ggcmV0cmlldmFsIGRvY3VtZW50cy4gU2VlIGh0dHBzOi8vZ29vZ2xlLmFpcC5kZXYvMTYwIGZvciB0aGUgc3ludGF4IG9mIHRoZSBmaWx0ZXIgZXhwcmVzc2lvbi5cIlxuICApLm9wdGlvbmFsKClcbn0pLnBhc3N0aHJvdWdoKCk7XG52YXIgZmlsZVNlYXJjaEFyZ3NTY2hlbWEgPSBsYXp5U2NoZW1hNyhcbiAgKCkgPT4gem9kU2NoZW1hNyhmaWxlU2VhcmNoQXJnc0Jhc2VTY2hlbWEpXG4pO1xudmFyIGZpbGVTZWFyY2ggPSBjcmVhdGVQcm92aWRlclRvb2xGYWN0b3J5Mih7XG4gIGlkOiBcImdvb2dsZS5maWxlX3NlYXJjaFwiLFxuICBpbnB1dFNjaGVtYTogZmlsZVNlYXJjaEFyZ3NTY2hlbWFcbn0pO1xuXG4vLyBzcmMvdG9vbC9nb29nbGUtbWFwcy50c1xuaW1wb3J0IHtcbiAgY3JlYXRlUHJvdmlkZXJUb29sRmFjdG9yeSBhcyBjcmVhdGVQcm92aWRlclRvb2xGYWN0b3J5MyxcbiAgbGF6eVNjaGVtYSBhcyBsYXp5U2NoZW1hOCxcbiAgem9kU2NoZW1hIGFzIHpvZFNjaGVtYThcbn0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXItdXRpbHNcIjtcbmltcG9ydCB7IHogYXMgejkgfSBmcm9tIFwiem9kL3Y0XCI7XG52YXIgZ29vZ2xlTWFwcyA9IGNyZWF0ZVByb3ZpZGVyVG9vbEZhY3RvcnkzKHtcbiAgaWQ6IFwiZ29vZ2xlLmdvb2dsZV9tYXBzXCIsXG4gIGlucHV0U2NoZW1hOiBsYXp5U2NoZW1hOCgoKSA9PiB6b2RTY2hlbWE4KHo5Lm9iamVjdCh7fSkpKVxufSk7XG5cbi8vIHNyYy90b29sL2dvb2dsZS1zZWFyY2gudHNcbmltcG9ydCB7XG4gIGNyZWF0ZVByb3ZpZGVyVG9vbEZhY3RvcnkgYXMgY3JlYXRlUHJvdmlkZXJUb29sRmFjdG9yeTQsXG4gIGxhenlTY2hlbWEgYXMgbGF6eVNjaGVtYTksXG4gIHpvZFNjaGVtYSBhcyB6b2RTY2hlbWE5XG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG5pbXBvcnQgeyB6IGFzIHoxMCB9IGZyb20gXCJ6b2QvdjRcIjtcbnZhciBnb29nbGVTZWFyY2ggPSBjcmVhdGVQcm92aWRlclRvb2xGYWN0b3J5NCh7XG4gIGlkOiBcImdvb2dsZS5nb29nbGVfc2VhcmNoXCIsXG4gIGlucHV0U2NoZW1hOiBsYXp5U2NoZW1hOShcbiAgICAoKSA9PiB6b2RTY2hlbWE5KFxuICAgICAgejEwLm9iamVjdCh7XG4gICAgICAgIG1vZGU6IHoxMC5lbnVtKFtcIk1PREVfRFlOQU1JQ1wiLCBcIk1PREVfVU5TUEVDSUZJRURcIl0pLmRlZmF1bHQoXCJNT0RFX1VOU1BFQ0lGSUVEXCIpLFxuICAgICAgICBkeW5hbWljVGhyZXNob2xkOiB6MTAubnVtYmVyKCkuZGVmYXVsdCgxKVxuICAgICAgfSlcbiAgICApXG4gIClcbn0pO1xuXG4vLyBzcmMvdG9vbC91cmwtY29udGV4dC50c1xuaW1wb3J0IHtcbiAgY3JlYXRlUHJvdmlkZXJUb29sRmFjdG9yeSBhcyBjcmVhdGVQcm92aWRlclRvb2xGYWN0b3J5NSxcbiAgbGF6eVNjaGVtYSBhcyBsYXp5U2NoZW1hMTAsXG4gIHpvZFNjaGVtYSBhcyB6b2RTY2hlbWExMFxufSBmcm9tIFwiQGFpLXNkay9wcm92aWRlci11dGlsc1wiO1xuaW1wb3J0IHsgeiBhcyB6MTEgfSBmcm9tIFwiem9kL3Y0XCI7XG52YXIgdXJsQ29udGV4dCA9IGNyZWF0ZVByb3ZpZGVyVG9vbEZhY3Rvcnk1KHtcbiAgaWQ6IFwiZ29vZ2xlLnVybF9jb250ZXh0XCIsXG4gIGlucHV0U2NoZW1hOiBsYXp5U2NoZW1hMTAoKCkgPT4gem9kU2NoZW1hMTAoejExLm9iamVjdCh7fSkpKVxufSk7XG5cbi8vIHNyYy90b29sL3ZlcnRleC1yYWctc3RvcmUudHNcbmltcG9ydCB7IGNyZWF0ZVByb3ZpZGVyVG9vbEZhY3RvcnkgYXMgY3JlYXRlUHJvdmlkZXJUb29sRmFjdG9yeTYgfSBmcm9tIFwiQGFpLXNkay9wcm92aWRlci11dGlsc1wiO1xuaW1wb3J0IHsgeiBhcyB6MTIgfSBmcm9tIFwiem9kL3Y0XCI7XG52YXIgdmVydGV4UmFnU3RvcmUgPSBjcmVhdGVQcm92aWRlclRvb2xGYWN0b3J5Nih7XG4gIGlkOiBcImdvb2dsZS52ZXJ0ZXhfcmFnX3N0b3JlXCIsXG4gIGlucHV0U2NoZW1hOiB6MTIub2JqZWN0KHtcbiAgICByYWdDb3JwdXM6IHoxMi5zdHJpbmcoKSxcbiAgICB0b3BLOiB6MTIubnVtYmVyKCkub3B0aW9uYWwoKVxuICB9KVxufSk7XG5cbi8vIHNyYy9nb29nbGUtdG9vbHMudHNcbnZhciBnb29nbGVUb29scyA9IHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBHb29nbGUgc2VhcmNoIHRvb2wgdGhhdCBnaXZlcyBHb29nbGUgZGlyZWN0IGFjY2VzcyB0byByZWFsLXRpbWUgd2ViIGNvbnRlbnQuXG4gICAqIE11c3QgaGF2ZSBuYW1lIFwiZ29vZ2xlX3NlYXJjaFwiLlxuICAgKi9cbiAgZ29vZ2xlU2VhcmNoLFxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBFbnRlcnByaXNlIFdlYiBTZWFyY2ggdG9vbCBmb3IgZ3JvdW5kaW5nIHJlc3BvbnNlcyB1c2luZyBhIGNvbXBsaWFuY2UtZm9jdXNlZCB3ZWIgaW5kZXguXG4gICAqIERlc2lnbmVkIGZvciBoaWdobHktcmVndWxhdGVkIGluZHVzdHJpZXMgKGZpbmFuY2UsIGhlYWx0aGNhcmUsIHB1YmxpYyBzZWN0b3IpLlxuICAgKiBEb2VzIG5vdCBsb2cgY3VzdG9tZXIgZGF0YSBhbmQgc3VwcG9ydHMgVlBDIHNlcnZpY2UgY29udHJvbHMuXG4gICAqIE11c3QgaGF2ZSBuYW1lIFwiZW50ZXJwcmlzZV93ZWJfc2VhcmNoXCIuXG4gICAqXG4gICAqIEBub3RlIE9ubHkgYXZhaWxhYmxlIG9uIFZlcnRleCBBSS4gUmVxdWlyZXMgR2VtaW5pIDIuMCBvciBuZXdlci5cbiAgICpcbiAgICogQHNlZSBodHRwczovL2Nsb3VkLmdvb2dsZS5jb20vdmVydGV4LWFpL2dlbmVyYXRpdmUtYWkvZG9jcy9ncm91bmRpbmcvd2ViLWdyb3VuZGluZy1lbnRlcnByaXNlXG4gICAqL1xuICBlbnRlcnByaXNlV2ViU2VhcmNoLFxuICAvKipcbiAgICogQ3JlYXRlcyBhIEdvb2dsZSBNYXBzIGdyb3VuZGluZyB0b29sIHRoYXQgZ2l2ZXMgdGhlIG1vZGVsIGFjY2VzcyB0byBHb29nbGUgTWFwcyBkYXRhLlxuICAgKiBNdXN0IGhhdmUgbmFtZSBcImdvb2dsZV9tYXBzXCIuXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly9haS5nb29nbGUuZGV2L2dlbWluaS1hcGkvZG9jcy9tYXBzLWdyb3VuZGluZ1xuICAgKiBAc2VlIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS92ZXJ0ZXgtYWkvZ2VuZXJhdGl2ZS1haS9kb2NzL2dyb3VuZGluZy9ncm91bmRpbmctd2l0aC1nb29nbGUtbWFwc1xuICAgKi9cbiAgZ29vZ2xlTWFwcyxcbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBVUkwgY29udGV4dCB0b29sIHRoYXQgZ2l2ZXMgR29vZ2xlIGRpcmVjdCBhY2Nlc3MgdG8gcmVhbC10aW1lIHdlYiBjb250ZW50LlxuICAgKiBNdXN0IGhhdmUgbmFtZSBcInVybF9jb250ZXh0XCIuXG4gICAqL1xuICB1cmxDb250ZXh0LFxuICAvKipcbiAgICogRW5hYmxlcyBSZXRyaWV2YWwgQXVnbWVudGVkIEdlbmVyYXRpb24gKFJBRykgdmlhIHRoZSBHZW1pbmkgRmlsZSBTZWFyY2ggdG9vbC5cbiAgICogTXVzdCBoYXZlIG5hbWUgXCJmaWxlX3NlYXJjaFwiLlxuICAgKlxuICAgKiBAcGFyYW0gZmlsZVNlYXJjaFN0b3JlTmFtZXMgLSBGdWxseS1xdWFsaWZpZWQgRmlsZSBTZWFyY2ggc3RvcmUgcmVzb3VyY2UgbmFtZXMuXG4gICAqIEBwYXJhbSBtZXRhZGF0YUZpbHRlciAtIE9wdGlvbmFsIGZpbHRlciBleHByZXNzaW9uIHRvIHJlc3RyaWN0IHRoZSBmaWxlcyB0aGF0IGNhbiBiZSByZXRyaWV2ZWQuXG4gICAqIEBwYXJhbSB0b3BLIC0gT3B0aW9uYWwgcmVzdWx0IGxpbWl0IGZvciB0aGUgbnVtYmVyIG9mIGNodW5rcyByZXR1cm5lZCBmcm9tIEZpbGUgU2VhcmNoLlxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vYWkuZ29vZ2xlLmRldi9nZW1pbmktYXBpL2RvY3MvZmlsZS1zZWFyY2hcbiAgICovXG4gIGZpbGVTZWFyY2gsXG4gIC8qKlxuICAgKiBBIHRvb2wgdGhhdCBlbmFibGVzIHRoZSBtb2RlbCB0byBnZW5lcmF0ZSBhbmQgcnVuIFB5dGhvbiBjb2RlLlxuICAgKiBNdXN0IGhhdmUgbmFtZSBcImNvZGVfZXhlY3V0aW9uXCIuXG4gICAqXG4gICAqIEBub3RlIEVuc3VyZSB0aGUgc2VsZWN0ZWQgbW9kZWwgc3VwcG9ydHMgQ29kZSBFeGVjdXRpb24uXG4gICAqIE11bHRpLXRvb2wgdXNhZ2Ugd2l0aCB0aGUgY29kZSBleGVjdXRpb24gdG9vbCBpcyB0eXBpY2FsbHkgY29tcGF0aWJsZSB3aXRoIEdlbWluaSA+PTIgbW9kZWxzLlxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vYWkuZ29vZ2xlLmRldi9nZW1pbmktYXBpL2RvY3MvY29kZS1leGVjdXRpb24gKEdvb2dsZSBBSSlcbiAgICogQHNlZSBodHRwczovL2Nsb3VkLmdvb2dsZS5jb20vdmVydGV4LWFpL2dlbmVyYXRpdmUtYWkvZG9jcy9tb2RlbC1yZWZlcmVuY2UvY29kZS1leGVjdXRpb24tYXBpIChWZXJ0ZXggQUkpXG4gICAqL1xuICBjb2RlRXhlY3V0aW9uLFxuICAvKipcbiAgICogQ3JlYXRlcyBhIFZlcnRleCBSQUcgU3RvcmUgdG9vbCB0aGF0IGVuYWJsZXMgdGhlIG1vZGVsIHRvIHBlcmZvcm0gUkFHIHNlYXJjaGVzIGFnYWluc3QgYSBWZXJ0ZXggUkFHIFN0b3JlLlxuICAgKiBNdXN0IGhhdmUgbmFtZSBcInZlcnRleF9yYWdfc3RvcmVcIi5cbiAgICovXG4gIHZlcnRleFJhZ1N0b3JlXG59O1xuXG4vLyBzcmMvZ29vZ2xlLWdlbmVyYXRpdmUtYWktaW1hZ2UtbW9kZWwudHNcbmltcG9ydCB7XG4gIGNvbWJpbmVIZWFkZXJzIGFzIGNvbWJpbmVIZWFkZXJzMyxcbiAgY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlciBhcyBjcmVhdGVKc29uUmVzcG9uc2VIYW5kbGVyMyxcbiAgbGF6eVNjaGVtYSBhcyBsYXp5U2NoZW1hMTEsXG4gIHBhcnNlUHJvdmlkZXJPcHRpb25zIGFzIHBhcnNlUHJvdmlkZXJPcHRpb25zMyxcbiAgcG9zdEpzb25Ub0FwaSBhcyBwb3N0SnNvblRvQXBpMyxcbiAgcmVzb2x2ZSBhcyByZXNvbHZlMyxcbiAgem9kU2NoZW1hIGFzIHpvZFNjaGVtYTExXG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG5pbXBvcnQgeyB6IGFzIHoxMyB9IGZyb20gXCJ6b2QvdjRcIjtcbnZhciBHb29nbGVHZW5lcmF0aXZlQUlJbWFnZU1vZGVsID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihtb2RlbElkLCBzZXR0aW5ncywgY29uZmlnKSB7XG4gICAgdGhpcy5tb2RlbElkID0gbW9kZWxJZDtcbiAgICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5zcGVjaWZpY2F0aW9uVmVyc2lvbiA9IFwidjNcIjtcbiAgfVxuICBnZXQgbWF4SW1hZ2VzUGVyQ2FsbCgpIHtcbiAgICB2YXIgX2E7XG4gICAgcmV0dXJuIChfYSA9IHRoaXMuc2V0dGluZ3MubWF4SW1hZ2VzUGVyQ2FsbCkgIT0gbnVsbCA/IF9hIDogNDtcbiAgfVxuICBnZXQgcHJvdmlkZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnLnByb3ZpZGVyO1xuICB9XG4gIGFzeW5jIGRvR2VuZXJhdGUob3B0aW9ucykge1xuICAgIHZhciBfYSwgX2IsIF9jO1xuICAgIGNvbnN0IHtcbiAgICAgIHByb21wdCxcbiAgICAgIG4gPSAxLFxuICAgICAgc2l6ZSxcbiAgICAgIGFzcGVjdFJhdGlvID0gXCIxOjFcIixcbiAgICAgIHNlZWQsXG4gICAgICBwcm92aWRlck9wdGlvbnMsXG4gICAgICBoZWFkZXJzLFxuICAgICAgYWJvcnRTaWduYWwsXG4gICAgICBmaWxlcyxcbiAgICAgIG1hc2tcbiAgICB9ID0gb3B0aW9ucztcbiAgICBjb25zdCB3YXJuaW5ncyA9IFtdO1xuICAgIGlmIChmaWxlcyAhPSBudWxsICYmIGZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgXCJHb29nbGUgR2VuZXJhdGl2ZSBBSSBkb2VzIG5vdCBzdXBwb3J0IGltYWdlIGVkaXRpbmcuIFVzZSBHb29nbGUgVmVydGV4IEFJIChAYWktc2RrL2dvb2dsZS12ZXJ0ZXgpIGZvciBpbWFnZSBlZGl0aW5nIGNhcGFiaWxpdGllcy5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKG1hc2sgIT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIkdvb2dsZSBHZW5lcmF0aXZlIEFJIGRvZXMgbm90IHN1cHBvcnQgaW1hZ2UgZWRpdGluZyB3aXRoIG1hc2tzLiBVc2UgR29vZ2xlIFZlcnRleCBBSSAoQGFpLXNkay9nb29nbGUtdmVydGV4KSBmb3IgaW1hZ2UgZWRpdGluZyBjYXBhYmlsaXRpZXMuXCJcbiAgICAgICk7XG4gICAgfVxuICAgIGlmIChzaXplICE9IG51bGwpIHtcbiAgICAgIHdhcm5pbmdzLnB1c2goe1xuICAgICAgICB0eXBlOiBcInVuc3VwcG9ydGVkXCIsXG4gICAgICAgIGZlYXR1cmU6IFwic2l6ZVwiLFxuICAgICAgICBkZXRhaWxzOiBcIlRoaXMgbW9kZWwgZG9lcyBub3Qgc3VwcG9ydCB0aGUgYHNpemVgIG9wdGlvbi4gVXNlIGBhc3BlY3RSYXRpb2AgaW5zdGVhZC5cIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChzZWVkICE9IG51bGwpIHtcbiAgICAgIHdhcm5pbmdzLnB1c2goe1xuICAgICAgICB0eXBlOiBcInVuc3VwcG9ydGVkXCIsXG4gICAgICAgIGZlYXR1cmU6IFwic2VlZFwiLFxuICAgICAgICBkZXRhaWxzOiBcIlRoaXMgbW9kZWwgZG9lcyBub3Qgc3VwcG9ydCB0aGUgYHNlZWRgIG9wdGlvbiB0aHJvdWdoIHRoaXMgcHJvdmlkZXIuXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBnb29nbGVPcHRpb25zID0gYXdhaXQgcGFyc2VQcm92aWRlck9wdGlvbnMzKHtcbiAgICAgIHByb3ZpZGVyOiBcImdvb2dsZVwiLFxuICAgICAgcHJvdmlkZXJPcHRpb25zLFxuICAgICAgc2NoZW1hOiBnb29nbGVJbWFnZVByb3ZpZGVyT3B0aW9uc1NjaGVtYVxuICAgIH0pO1xuICAgIGNvbnN0IGN1cnJlbnREYXRlID0gKF9jID0gKF9iID0gKF9hID0gdGhpcy5jb25maWcuX2ludGVybmFsKSA9PSBudWxsID8gdm9pZCAwIDogX2EuY3VycmVudERhdGUpID09IG51bGwgPyB2b2lkIDAgOiBfYi5jYWxsKF9hKSkgIT0gbnVsbCA/IF9jIDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCk7XG4gICAgY29uc3QgcGFyYW1ldGVycyA9IHtcbiAgICAgIHNhbXBsZUNvdW50OiBuXG4gICAgfTtcbiAgICBpZiAoYXNwZWN0UmF0aW8gIT0gbnVsbCkge1xuICAgICAgcGFyYW1ldGVycy5hc3BlY3RSYXRpbyA9IGFzcGVjdFJhdGlvO1xuICAgIH1cbiAgICBpZiAoZ29vZ2xlT3B0aW9ucykge1xuICAgICAgT2JqZWN0LmFzc2lnbihwYXJhbWV0ZXJzLCBnb29nbGVPcHRpb25zKTtcbiAgICB9XG4gICAgY29uc3QgYm9keSA9IHtcbiAgICAgIGluc3RhbmNlczogW3sgcHJvbXB0IH1dLFxuICAgICAgcGFyYW1ldGVyc1xuICAgIH07XG4gICAgY29uc3QgeyByZXNwb25zZUhlYWRlcnMsIHZhbHVlOiByZXNwb25zZSB9ID0gYXdhaXQgcG9zdEpzb25Ub0FwaTMoe1xuICAgICAgdXJsOiBgJHt0aGlzLmNvbmZpZy5iYXNlVVJMfS9tb2RlbHMvJHt0aGlzLm1vZGVsSWR9OnByZWRpY3RgLFxuICAgICAgaGVhZGVyczogY29tYmluZUhlYWRlcnMzKGF3YWl0IHJlc29sdmUzKHRoaXMuY29uZmlnLmhlYWRlcnMpLCBoZWFkZXJzKSxcbiAgICAgIGJvZHksXG4gICAgICBmYWlsZWRSZXNwb25zZUhhbmRsZXI6IGdvb2dsZUZhaWxlZFJlc3BvbnNlSGFuZGxlcixcbiAgICAgIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXI6IGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIzKFxuICAgICAgICBnb29nbGVJbWFnZVJlc3BvbnNlU2NoZW1hXG4gICAgICApLFxuICAgICAgYWJvcnRTaWduYWwsXG4gICAgICBmZXRjaDogdGhpcy5jb25maWcuZmV0Y2hcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgaW1hZ2VzOiByZXNwb25zZS5wcmVkaWN0aW9ucy5tYXAoXG4gICAgICAgIChwKSA9PiBwLmJ5dGVzQmFzZTY0RW5jb2RlZFxuICAgICAgKSxcbiAgICAgIHdhcm5pbmdzOiB3YXJuaW5ncyAhPSBudWxsID8gd2FybmluZ3MgOiBbXSxcbiAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IHtcbiAgICAgICAgZ29vZ2xlOiB7XG4gICAgICAgICAgaW1hZ2VzOiByZXNwb25zZS5wcmVkaWN0aW9ucy5tYXAoKHByZWRpY3Rpb24pID0+ICh7XG4gICAgICAgICAgICAvLyBBZGQgYW55IHByZWRpY3Rpb24tc3BlY2lmaWMgbWV0YWRhdGEgaGVyZVxuICAgICAgICAgIH0pKVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgcmVzcG9uc2U6IHtcbiAgICAgICAgdGltZXN0YW1wOiBjdXJyZW50RGF0ZSxcbiAgICAgICAgbW9kZWxJZDogdGhpcy5tb2RlbElkLFxuICAgICAgICBoZWFkZXJzOiByZXNwb25zZUhlYWRlcnNcbiAgICAgIH1cbiAgICB9O1xuICB9XG59O1xudmFyIGdvb2dsZUltYWdlUmVzcG9uc2VTY2hlbWEgPSBsYXp5U2NoZW1hMTEoXG4gICgpID0+IHpvZFNjaGVtYTExKFxuICAgIHoxMy5vYmplY3Qoe1xuICAgICAgcHJlZGljdGlvbnM6IHoxMy5hcnJheSh6MTMub2JqZWN0KHsgYnl0ZXNCYXNlNjRFbmNvZGVkOiB6MTMuc3RyaW5nKCkgfSkpLmRlZmF1bHQoW10pXG4gICAgfSlcbiAgKVxuKTtcbnZhciBnb29nbGVJbWFnZVByb3ZpZGVyT3B0aW9uc1NjaGVtYSA9IGxhenlTY2hlbWExMShcbiAgKCkgPT4gem9kU2NoZW1hMTEoXG4gICAgejEzLm9iamVjdCh7XG4gICAgICBwZXJzb25HZW5lcmF0aW9uOiB6MTMuZW51bShbXCJkb250X2FsbG93XCIsIFwiYWxsb3dfYWR1bHRcIiwgXCJhbGxvd19hbGxcIl0pLm51bGxpc2goKSxcbiAgICAgIGFzcGVjdFJhdGlvOiB6MTMuZW51bShbXCIxOjFcIiwgXCIzOjRcIiwgXCI0OjNcIiwgXCI5OjE2XCIsIFwiMTY6OVwiXSkubnVsbGlzaCgpXG4gICAgfSlcbiAgKVxuKTtcblxuLy8gc3JjL2dvb2dsZS1wcm92aWRlci50c1xuZnVuY3Rpb24gY3JlYXRlR29vZ2xlR2VuZXJhdGl2ZUFJKG9wdGlvbnMgPSB7fSkge1xuICB2YXIgX2EsIF9iO1xuICBjb25zdCBiYXNlVVJMID0gKF9hID0gd2l0aG91dFRyYWlsaW5nU2xhc2gob3B0aW9ucy5iYXNlVVJMKSkgIT0gbnVsbCA/IF9hIDogXCJodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGFcIjtcbiAgY29uc3QgcHJvdmlkZXJOYW1lID0gKF9iID0gb3B0aW9ucy5uYW1lKSAhPSBudWxsID8gX2IgOiBcImdvb2dsZS5nZW5lcmF0aXZlLWFpXCI7XG4gIGNvbnN0IGdldEhlYWRlcnMgPSAoKSA9PiB3aXRoVXNlckFnZW50U3VmZml4KFxuICAgIHtcbiAgICAgIFwieC1nb29nLWFwaS1rZXlcIjogbG9hZEFwaUtleSh7XG4gICAgICAgIGFwaUtleTogb3B0aW9ucy5hcGlLZXksXG4gICAgICAgIGVudmlyb25tZW50VmFyaWFibGVOYW1lOiBcIkdPT0dMRV9HRU5FUkFUSVZFX0FJX0FQSV9LRVlcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwiR29vZ2xlIEdlbmVyYXRpdmUgQUlcIlxuICAgICAgfSksXG4gICAgICAuLi5vcHRpb25zLmhlYWRlcnNcbiAgICB9LFxuICAgIGBhaS1zZGsvZ29vZ2xlLyR7VkVSU0lPTn1gXG4gICk7XG4gIGNvbnN0IGNyZWF0ZUNoYXRNb2RlbCA9IChtb2RlbElkKSA9PiB7XG4gICAgdmFyIF9hMjtcbiAgICByZXR1cm4gbmV3IEdvb2dsZUdlbmVyYXRpdmVBSUxhbmd1YWdlTW9kZWwobW9kZWxJZCwge1xuICAgICAgcHJvdmlkZXI6IHByb3ZpZGVyTmFtZSxcbiAgICAgIGJhc2VVUkwsXG4gICAgICBoZWFkZXJzOiBnZXRIZWFkZXJzLFxuICAgICAgZ2VuZXJhdGVJZDogKF9hMiA9IG9wdGlvbnMuZ2VuZXJhdGVJZCkgIT0gbnVsbCA/IF9hMiA6IGdlbmVyYXRlSWQyLFxuICAgICAgc3VwcG9ydGVkVXJsczogKCkgPT4gKHtcbiAgICAgICAgXCIqXCI6IFtcbiAgICAgICAgICAvLyBHb29nbGUgR2VuZXJhdGl2ZSBMYW5ndWFnZSBcImZpbGVzXCIgZW5kcG9pbnRcbiAgICAgICAgICAvLyBlLmcuIGh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YS9maWxlcy8uLi5cbiAgICAgICAgICBuZXcgUmVnRXhwKGBeJHtiYXNlVVJMfS9maWxlcy8uKiRgKSxcbiAgICAgICAgICAvLyBZb3VUdWJlIFVSTHMgKHB1YmxpYyBvciB1bmxpc3RlZCB2aWRlb3MpXG4gICAgICAgICAgbmV3IFJlZ0V4cChcbiAgICAgICAgICAgIGBeaHR0cHM6Ly8oPzp3d3dcXFxcLik/eW91dHViZVxcXFwuY29tL3dhdGNoXFxcXD92PVtcXFxcdy1dKyg/OiZbXFxcXHc9Ji4tXSopPyRgXG4gICAgICAgICAgKSxcbiAgICAgICAgICBuZXcgUmVnRXhwKGBeaHR0cHM6Ly95b3V0dVxcXFwuYmUvW1xcXFx3LV0rKD86XFxcXD9bXFxcXHc9Ji4tXSopPyRgKVxuICAgICAgICBdXG4gICAgICB9KSxcbiAgICAgIGZldGNoOiBvcHRpb25zLmZldGNoXG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IGNyZWF0ZUVtYmVkZGluZ01vZGVsID0gKG1vZGVsSWQpID0+IG5ldyBHb29nbGVHZW5lcmF0aXZlQUlFbWJlZGRpbmdNb2RlbChtb2RlbElkLCB7XG4gICAgcHJvdmlkZXI6IHByb3ZpZGVyTmFtZSxcbiAgICBiYXNlVVJMLFxuICAgIGhlYWRlcnM6IGdldEhlYWRlcnMsXG4gICAgZmV0Y2g6IG9wdGlvbnMuZmV0Y2hcbiAgfSk7XG4gIGNvbnN0IGNyZWF0ZUltYWdlTW9kZWwgPSAobW9kZWxJZCwgc2V0dGluZ3MgPSB7fSkgPT4gbmV3IEdvb2dsZUdlbmVyYXRpdmVBSUltYWdlTW9kZWwobW9kZWxJZCwgc2V0dGluZ3MsIHtcbiAgICBwcm92aWRlcjogcHJvdmlkZXJOYW1lLFxuICAgIGJhc2VVUkwsXG4gICAgaGVhZGVyczogZ2V0SGVhZGVycyxcbiAgICBmZXRjaDogb3B0aW9ucy5mZXRjaFxuICB9KTtcbiAgY29uc3QgcHJvdmlkZXIgPSBmdW5jdGlvbihtb2RlbElkKSB7XG4gICAgaWYgKG5ldy50YXJnZXQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgXCJUaGUgR29vZ2xlIEdlbmVyYXRpdmUgQUkgbW9kZWwgZnVuY3Rpb24gY2Fubm90IGJlIGNhbGxlZCB3aXRoIHRoZSBuZXcga2V5d29yZC5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIGNyZWF0ZUNoYXRNb2RlbChtb2RlbElkKTtcbiAgfTtcbiAgcHJvdmlkZXIuc3BlY2lmaWNhdGlvblZlcnNpb24gPSBcInYzXCI7XG4gIHByb3ZpZGVyLmxhbmd1YWdlTW9kZWwgPSBjcmVhdGVDaGF0TW9kZWw7XG4gIHByb3ZpZGVyLmNoYXQgPSBjcmVhdGVDaGF0TW9kZWw7XG4gIHByb3ZpZGVyLmdlbmVyYXRpdmVBSSA9IGNyZWF0ZUNoYXRNb2RlbDtcbiAgcHJvdmlkZXIuZW1iZWRkaW5nID0gY3JlYXRlRW1iZWRkaW5nTW9kZWw7XG4gIHByb3ZpZGVyLmVtYmVkZGluZ01vZGVsID0gY3JlYXRlRW1iZWRkaW5nTW9kZWw7XG4gIHByb3ZpZGVyLnRleHRFbWJlZGRpbmcgPSBjcmVhdGVFbWJlZGRpbmdNb2RlbDtcbiAgcHJvdmlkZXIudGV4dEVtYmVkZGluZ01vZGVsID0gY3JlYXRlRW1iZWRkaW5nTW9kZWw7XG4gIHByb3ZpZGVyLmltYWdlID0gY3JlYXRlSW1hZ2VNb2RlbDtcbiAgcHJvdmlkZXIuaW1hZ2VNb2RlbCA9IGNyZWF0ZUltYWdlTW9kZWw7XG4gIHByb3ZpZGVyLnRvb2xzID0gZ29vZ2xlVG9vbHM7XG4gIHJldHVybiBwcm92aWRlcjtcbn1cbnZhciBnb29nbGUgPSBjcmVhdGVHb29nbGVHZW5lcmF0aXZlQUkoKTtcbmV4cG9ydCB7XG4gIFZFUlNJT04sXG4gIGNyZWF0ZUdvb2dsZUdlbmVyYXRpdmVBSSxcbiAgZ29vZ2xlXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/@ai-sdk+google@3.0.10_zod@3.25.76/node_modules/@ai-sdk/google/dist/index.mjs\n");

/***/ })

};
;